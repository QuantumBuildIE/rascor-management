/*
 * Author       : quantumbuild1
 * Generated on : 09-Jan-2026 11:53:32
 * Version      : 1.0
 */
 application "RASCOR Stock Management"
 {
 	date format = "dd-MMM-yyyy"
 	time zone = "Europe/Dublin"
 	time format = "24-hr"
 	forms
	{
		form Assign_Bay_Form
		{
			success message = "Data Added Successfully!"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Order_ID
			(
				type = number
				displayname = "Order ID"
				private = true
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Bay_Locations
			(
				type = picklist	
				displayname = "Bay Locations"
				values  = Bay_Locations.ID
    			displayformat = [Bay_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Assign_Bay_Form1
		{
			displayname = "Assign_Bay_Form"
			success message = "Data Added Successfully!"
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Bay_Locations
		{
			displayname = "Bay Locations"
			success message = "Bay Location Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Bay_Name
			(
    			type = text
				displayname = "Bay Name"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Stock_Locations
			(
				type = picklist	
				displayname = "Stock Locations"
				values  = Stock_Locations.ID
    			displayformat = [Location_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Capacity
			(
				type = number
	 			row = 1
	 			column = 1   
				width = medium
			)
			Active
			(
    			type = checkbox
				initial value = false
	 			row = 1
	 			column = 1   
				width = medium
			)
			Notes
			(
    			type = textarea
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Companies
		{
			displayname = "Company"
			success message = "Company Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			must have unique Company_Name
			(
    			type = text
				displayname = "Company Name"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Company_Type
			(
				type = picklist
				displayname = "Company Type"
				maxchar = 100
				values = {"Contractor","Developer","Consultant","Other"}
	 			row = 1
	 			column = 1   
				width = medium
			)
			Address
			(
    			type = address
     			capture_coordinates = true
     			adjust_using_map = false
     			address_line_1
     			(
	     			  type = address_line_1
	     			  displayname = "Address Line 1"
     			) 
     			address_line_2
     			(
	     			  type = address_line_2
	     			  displayname = "Address Line 2"
     			) 
     			district_city
     			(
	     			  type = district_city
	     			  displayname = "City / District"
     			) 
     			state_province
     			(
	     			  type = state_province
	     			  displayname = "State / Province"
     			) 
     			postal_Code
     			(
	     			  type = postal_Code
	     			  displayname = "Postal Code"
     			) 
     			country
     			(
	     			  type = country
	     			  displayname = "Country"
     			) 
     			latitude
     			(
	     			  type = latitude
	     			  displayname = "latitude"
	     			 visibility = false
     			) 
     			longitude
     			(
	     			  type = longitude
	     			  displayname = "longitude"
	     			 visibility = false
     			) 
	 			row = 1
	 			column = 1   
				width = medium
				personal data = true
			)
			Google_Maps_Link
			(
    			type = url
				displayname = "Google Maps Link"
				enable  linkname
	 			row = 1
	 			column = 1   
				width = medium
			)
			Phone_Number
			(
    			type = phonenumber
				displayname = "Phone"
	 			row = 1
	 			column = 1   
				width = medium
				personal data = true
			)
			Email
			(
    			type = email
				maxchar = 80
	 			row = 1
	 			column = 1   
				width = medium
				personal data = true
			)
			Website
			(
    			type = url
				enable  linkname
	 			row = 1
	 			column = 1   
				width = medium
			)
			Active
			(
    			type = checkbox
				initial value = true
	 			row = 1
	 			column = 1   
				width = medium
			)
			Notes
			(
    			type = textarea
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Company_Contacts
		{
			displayname = "Company Contact"
			success message = "Company Contact Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			must have Companies
			(
				type = picklist	
				values  = Companies.ID
    			displayformat = [Company_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			First_Name
			(
    			type = text
				displayname = "First Name"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Last_Name
			(
    			type = text
				displayname = "Last Name"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Full_Name
			(
    			type = formula
				displayname = "Full Name"
				value =  input.First_Name + " " + input.Last_Name
				visibility = false
				display type = text
				format = plaintext
	 			row = 1
	 			column = 1   
				width = medium
			)
			Job_Title
			(
    			type = text
				displayname = "Job Title"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Phone_Number
			(
    			type = phonenumber
				displayname = "Phone"
	 			row = 1
	 			column = 1   
				width = medium
				personal data = true
			)
			Mobile_Number
			(
    			type = phonenumber
				displayname = "Mobile Number"
	 			row = 1
	 			column = 1   
				width = medium
				personal data = true
			)
			Email
			(
    			type = email
				maxchar = 80
	 			row = 1
	 			column = 1   
				width = medium
				personal data = true
			)
			Is_Primary_Contact
			(
    			type = checkbox
				displayname = "Is Primary Contact"
				initial value = false
	 			row = 1
	 			column = 1   
				width = medium
			)
			Active
			(
    			type = checkbox
				initial value = true
	 			row = 1
	 			column = 1   
				width = medium
			)
			Notes
			(
    			type = textarea
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Goods_Receipt
		{
			displayname = "Goods Receipt"
			success message = "Data Added Successfully!"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			unique GRN_Number
			(
    			type = text
				displayname = "GRN Number"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Purchase_Order
			(
				type = picklist	
				displayname = "Purchase Order"
				values  = Purchase_Orders.ID
    			displayformat = [PO_Number]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Link to Purchase Order (optional for non-PO receipts)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Suppliers
			(
				type = picklist	
				displayname = "Product Supplier"
				values  = Suppliers.ID
    			displayformat = [Supplier_Name]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Supplier delivering goods"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Receipt_Date
			(
    			type = datetime
				displayname = "Receipt Date"
				initial value = "${zoho.currenttime}"
				timedisplayoptions = "hh:mm:ss"
				alloweddays = 0,1,2,3,4,5,6
    			description
    			[
    				type = tooltip
    			 	message = "When goods were received"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Receiving_Location
			(
				type = picklist	
				displayname = "Receiving Location"
				values  = Stock_Locations.ID
    			displayformat = [Location_Name]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Warehouse location receiving the goods"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Delivery_Note_Ref
			(
    			type = text
				displayname = "Delivery Note Ref"
    			description
    			[
    				type = tooltip
    			 	message = "Supplier's delivery note number"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have GRN_Status
			(
				type = picklist
				displayname = "GRN Status"
				maxchar = 100
				values = {"Draft","Confirmed","Cancelled"}
				initial value = "Draft"
    			description
    			[
    				type = tooltip
    			 	message = "Confirm to update stock levels"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Received_By
			(
    			type = text
				displayname = "Received By"
    			description
    			[
    				type = tooltip
    			 	message = "Person who received the goods"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Notes
			(
    			type = textarea
				height = 100px
    			description
    			[
    				type = tooltip
    			 	message = "Condition notes, discrepancies, etc."
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Stock_Updated
			(
    			type = checkbox
				displayname = "Stock Updated"
				initial value = false
    			description
    			[
    				type = tooltip
    			 	message = "System field - tracks if stock has been updated"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			GRN_Lines
			(
				type = grid
				displayname = "GRN Lines"
				values  = GRN_Line_Items.ID
	 			row = 2
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form GRN_Line_Items
		{
			displayname = "GRN Line Items"
			success message = "Data Added Successfully!"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Goods_Receipt
			(
				type = picklist	
				displayname = "Goods Receipt"
				values  = Goods_Receipt.ID
    			displayformat = [GRN_Number]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Parent GRN"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			PO_Line
			(
				type = picklist	
				values  = PO_Line_Items.ID
    			displayformat = [Line_Description]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Link to PO line item (for PO-based receipts)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Product
			(
				type = picklist	
				values  = Product_Master.ID
    			displayformat = [Product_Name]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Product being received"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Bay_Locations
			(
				type = picklist	
				displayname = "Bay Locations"
				values  = Bay_Locations.ID
    			displayformat = [Bay_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Quantity_Expected
			(
				type = decimal
				displayname = "Quantity Expected"
    			description
    			[
    				type = tooltip
    			 	message = "Expected quantity from PO (for reference)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Quantity_Received
			(
				type = decimal
				displayname = "Quantity Received"
    			description
    			[
    				type = tooltip
    			 	message = "Actual quantity received"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Quantity_Rejected
			(
				type = decimal
				displayname = "Quantity Rejected"
    			description
    			[
    				type = tooltip
    			 	message = "Quantity rejected (damaged, wrong, etc.)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Rejection_Reason
			(
				type = picklist
				displayname = "Rejection Reason"
				maxchar = 100
				values = {"Damaged","Wrong Item","Expired","Quality Issue","Other"}
    			description
    			[
    				type = tooltip
    			 	message = "Reason for rejection (if applicable)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Batch_Number
			(
    			type = text
				displayname = "Batch Number"
    			description
    			[
    				type = tooltip
    			 	message = "Supplier batch/lot number (optional)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Expiry_Date
			(
    			type = date
				displayname = "Expiry Date"
				alloweddays = 0,1,2,3,4,5,6
    			description
    			[
    				type = tooltip
    			 	message = "Expiry date for perishable items (optional)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Kit_Products
		{
			displayname = "Kit Item"
			success message = "Kit Product Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Kit
			(
				type = picklist	
				values  = Product_Kits.ID
    			displayformat = [Kit_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Product
			(
				type = picklist	
				values  = Product_Master.ID
    			displayformat = [Product_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Default_Quantity
			(
				type = decimal
				displayname = "Default Quantity"
				maxchar = 8
				initial value = 0
	 			row = 1
	 			column = 1   
				width = medium
			)
			Sort_Order
			(
				type = number
				displayname = "Sort Order"
				maxchar = 4
				initial value = 100
	 			row = 1
	 			column = 1   
				width = medium
			)
			Notes
			(
    			type = text
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Order_Line_Items
		{
			displayname = "Order Line Items"
			success message = "Data Added Successfully!"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Order
			(
				type = picklist	
				values  = Stock_Ordering.ID
    			bidirectional = Order
    			displayformat = [Order_Number]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Product
			(
				type = picklist	
				values  = Product_Master.ID
    			displayformat = [Product_Name + " - " + Product_Number]
				advanced field search = true
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = 600px
			)
			Quantity
			(
				type = number
				displayname = "Qty"
				initial value = 0
	 			row = 1
	 			column = 1   
				width = 50px
			)
			Unit_Type
			(
    			type = formula
				displayname = "Unit Type"
				value =  input.Product.Unit_Type
				visibility = true
				display type = text
				format = plaintext
	 			row = 1
	 			column = 1   
				width = 100px
			)
			Product_Number
			(
    			type = formula
				displayname = "Product Number"
				value =  input.Product.Product_Number
				visibility = false
	 			row = 1
	 			column = 1   
				width = 60px
			)
			Quantity_Issued
			(
				type = decimal
				displayname = "Quantity Issued"
    			description
    			[
    				type = tooltip
    			 	message = "Actual quantity issued (may differ from ordered)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Quantity_Available
			(
				type = decimal
				displayname = "Quantity Available"
    			description
    			[
    				type = tooltip
    			 	message = "Current available stock for this product (auto-filled)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Stock_Warning
			(
    			type = formula
				displayname = "Stock Warning"
				value =  if(Quantity > Quantity_Available,"Insufficient Stock","")
				visibility = true
				display type = text
				format = plaintext
	 			row = 1
	 			column = 1   
				width = medium
			)
			Line_Notes
			(
    			type = text
				displayname = "Line Notes"
				private = true
	 			row = 1
	 			column = 1   
				width = 30px
			)
			Is_Ancillary
			(
    			type = checkbox
				displayname = "Is Ancillary"
				initial value = false
				private = true
	 			row = 1
	 			column = 1   
				width = medium
			)
			Is_Site_Product
			(
    			type = checkbox
				displayname = "Is Site Product"
				initial value = false
    			description
    			[
    				type = tooltip
    			 	message = "System field - true if product is from Site Catalog"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Line_Status
			(
				type = picklist
				displayname = "Line Status"
				maxchar = 100
				values = {"Pending","Picked","Out of Stock"}
				initial value = "Pending"
				private = true
	 			row = 1
	 			column = 1   
				width = 60px
			)
			Line_Total_Stored
			(
				displayname = "Line Total Stored"
				type = EUR
				format = dotcomma
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Parameters
		{
			success message = "Parameter Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Parameter_Name
			(
    			type = text
				displayname = "Parameter Name"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Current_Proposal_ID
			(
				type = number
				displayname = "Current Proposal ID"
				maxchar = 19
	 			row = 1
	 			column = 1   
				width = medium
			)
			Debug_Log
			(
    			type = textarea
				displayname = "Debug Log"
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
			Workflow_Debug
			(
    			type = textarea
				displayname = "Workflow Debug"
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
			Proposal_Order_Comparison_Report
			(
    			type = richtext
				displayname = "Proposal Order Comparison Report"
				height = 200px
				toolbar = enable
				[
					style, font-color, background-color, link, bullets-and-numbering, 
					font-size : {1, 2, 3, 4, 5, 6, 7}
				]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Dynamic_Stock_Report
			(
    			type = richtext
				displayname = "Dynamic Stock Report"
				height = 200px
				toolbar = enable
				[
					style, font-color, background-color, link, bullets-and-numbering, 
					font-size : {1, 2, 3, 4, 5, 6, 7}
				]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Dynamic_Order_Report
			(
    			type = richtext
				displayname = "Dynamic Order Report"
				height = 200px
				toolbar = enable
				[
					style, font-color, background-color, link, bullets-and-numbering, 
					font-size : {1, 2, 3, 4, 5, 6, 7}
				]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Product_Trends_Report
			(
    			type = richtext
				displayname = "Product Trends Report"
				height = 200px
				toolbar = enable
				[
					style, font-color, background-color, link, bullets-and-numbering, 
					font-size : {1, 2, 3, 4, 5, 6, 7}
				]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Products_By_Month_Chart
			(
    			type = richtext
				displayname = "Products By Month Chart"
				height = 200px
				toolbar = enable
				[
					style, font-color, background-color, link, bullets-and-numbering, 
					font-size : {1, 2, 3, 4, 5, 6, 7}
				]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Products_By_Site_Chart
			(
    			type = richtext
				displayname = "Products By Site Chart"
				height = 200px
				toolbar = enable
				[
					style, font-color, background-color, link, bullets-and-numbering, 
					font-size : {1, 2, 3, 4, 5, 6, 7}
				]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Products_By_Week_Chart
			(
    			type = richtext
				displayname = "Products By Week Chart"
				height = 200px
				toolbar = enable
				[
					style, font-color, background-color, link, bullets-and-numbering, 
					font-size : {1, 2, 3, 4, 5, 6, 7}
				]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Bay_Assignment_Order_ID
			(
				type = number
				displayname = "Bay Assignment Order ID "
				maxchar = 19
	 			row = 1
	 			column = 1   
				width = medium
			)
			Bay_Assignment_Mode
			(
    			type = text
				displayname = "Bay Assignment Mode "
	 			row = 1
	 			column = 1   
				width = medium
			)
			Current_Stock_Take_ID
			(
				type = number
				displayname = "Current Stock Take ID"
				maxchar = 19
	 			row = 1
	 			column = 1   
				width = medium
			)
			Current_Stock_Take_Line_ID
			(
    			type = text
				displayname = "Current Stock Take Line ID"
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form PO_Line_Items
		{
			displayname = "PO Line Items"
			success message = "Data Added Successfully!"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Purchase_Order
			(
				type = picklist	
				displayname = "Purchase Order"
				values  = Purchase_Orders.ID
    			displayformat = [PO_Number]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Parent Purchase Order"
    			]
	 			row = 1
	 			column = 1   
				width = 150px
			)
			must have Product
			(
				type = picklist	
				values  = Product_Master.ID
    			displayformat = [Product_Name]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Select product to order"
    			]
	 			row = 1
	 			column = 1   
				width = 200px
			)
			must have Quantity_Ordered
			(
				type = decimal
				displayname = "Quantity Ordered"
				initial value = 1
    			description
    			[
    				type = tooltip
    			 	message = "Quantity to order from supplier"
    			]
	 			row = 1
	 			column = 1   
				width = 150px
			)
			Quantity_Received
			(
				type = decimal
				displayname = "Quantity Received"
				initial value = 0
    			description
    			[
    				type = tooltip
    			 	message = "Quantity received to date (updated by GRN)"
    			]
	 			row = 1
	 			column = 1   
				width = 150px
			)
			Quantity_Outstanding
			(
    			type = formula
				displayname = "Quantity Outstanding"
				value =  input.Quantity_Ordered - input.Quantity_Received
				visibility = false
	 			row = 1
	 			column = 1   
				width = 150px
			)
			must have Unit_Price
			(
				type = decimal
				displayname = "Unit Price"
    			description
    			[
    				type = tooltip
    			 	message = "Price per unit"
    			]
	 			row = 1
	 			column = 1   
				width = 100px
			)
			Line_Total
			(
    			type = formula
				displayname = "Line Total"
				value =  input.Quantity_Ordered * input.Unit_Price
				visibility = false
	 			row = 1
	 			column = 1   
				width = 100px
			)
			must have Line_Status
			(
				type = picklist
				displayname = "Line Status"
				maxchar = 100
				values = {"Open","Partial","Complete","Cancelled"}
				initial value = "Open"
				others option = true
    			description
    			[
    				type = tooltip
    			 	message = "Receiving status for this line"
    			]
	 			row = 1
	 			column = 1   
				width = 120px
			)
			Line_Description
			(
    			type = formula
				displayname = "Line Description"
				value =  input.Product.Product_Name + " - Qty: " + input.Quantity_Ordered
				visibility = true
				display type = text
				format = plaintext
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Procore_Settings
		{
			success message = "Data Added Successfully!"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Environment
			(
				type = picklist
				maxchar = 100
				values = {"Sandbox","Production"}
	 			row = 1
	 			column = 1   
				width = medium
			)
			Client_ID
			(
    			type = text
				displayname = "Client ID"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Client_Secret
			(
    			type = text
				displayname = "Client Secret"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Company_ID
			(
    			type = text
				displayname = "Company ID"
	 			row = 1
	 			column = 1   
				width = medium
			)
			API_Base_URL
			(
    			type = text
				displayname = "API Base URL"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Auth_URL
			(
    			type = text
				displayname = "Auth URL"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Is_Active
			(
    			type = checkbox
				displayname = "Is Active"
				initial value = false
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Product_Categories
		{
			displayname = "Product Category"
			success message = "Product Category Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Category_Number
			(
    			type = autonumber
				displayname = "Category Number"
				start index = 1
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have unique Category_Name
			(
    			type = text
				displayname = "Category Name"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Parent_Category
			(
				type = picklist	
				displayname = "Parent Category"
				values  = Product_Categories.ID
    			displayformat = [Category_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Is_Active
			(
    			type = checkbox
				displayname = "Is Active"
				initial value = false
	 			row = 1
	 			column = 1   
				width = medium
			)
			Sort_Order
			(
				type = number
				displayname = "Sort Order"
				initial value = 100
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Product_Kits
		{
			displayname = "Product Kit"
			success message = "Product Kit Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Product_Categories
			(
				type = picklist	
				displayname = "Product Categories"
				values  = Product_Categories.ID
    			displayformat = [Category_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Kit_Name
			(
    			type = text
				displayname = "Kit Name"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Kit_Description
			(
    			type = textarea
				displayname = "Kit Description"
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
			Notes
			(
    			type = textarea
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
			Active
			(
    			type = checkbox
				initial value = true
	 			row = 1
	 			column = 1   
				width = medium
			)
			Kit_Total
			(
				type = decimal
				displayname = "Kit Total"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Kit_Items
			(
				type = grid
				displayname = "Kit Product Items"
				values  = Kit_Products.ID
	 			row = 2
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Product_Master
		{
			displayname = "Product Master"
			success message = "Product Master Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Product_Number
			(
    			type = autonumber
				displayname = "Product Number"
				start index = 1
	 			row = 1
	 			column = 1   
				width = medium
			)
			Product_Name
			(
    			type = text
				displayname = "Product Name"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Description
			(
    			type = textarea
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
			Supplier
			(
				type = picklist	
				values  = Suppliers.ID
    			displayformat = [Supplier_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Category
			(
				type = picklist	
				values  = Product_Categories.ID
    			displayformat = [Category_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Product_Type
			(
				type = picklist
				displayname = "Product Type"
				maxchar = 100
				values = {"Main Product","Ancillary Product","Tool","Consumable"}
				initial value = "Main Product"
				others option = true
	 			row = 1
	 			column = 1   
				width = medium
			)
			Bay_Location
			(
    			type = text
				displayname = "Bay Location"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Unit_Type
			(
				type = picklist
				displayname = "Unit Type"
				maxchar = 100
				values = {"Each","Pallet","Kg","Liter","Meter","Set","Box","Bag","Drum","Roll","Tube"}
				initial value = "Each"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Base_Rate
			(
				type = decimal
				displayname = "Base Rate"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Cost_Price
			(
				type = decimal
				displayname = "Cost Price"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Sell_Price
			(
				type = decimal
				displayname = "Sell Price"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Margin_Amount
			(
    			type = formula
				displayname = "Margin Amount"
				value =  ifnull(input.Sell_Price,0) - ifnull(input.Cost_Price,0)
				visibility = true
				display type = text
				format = plaintext
	 			row = 1
	 			column = 1   
				width = medium
			)
			Margin_Percent
			(
    			type = formula
				displayname = "Margin Percent"
				value =  if(ifnull(input.Sell_Price,0) > 0,(ifnull(input.Sell_Price,0) - ifnull(input.Cost_Price,0)) / input.Sell_Price * 100,0)
				visibility = true
				display type = text
				format = plaintext
	 			row = 1
	 			column = 1   
				width = medium
			)
			SKU
			(
    			type = text
	 			row = 1
	 			column = 1   
				width = medium
			)
			QR_Code
			(
				type = qrcode
				displayname = "QR Code"
				value = "${Product_Number}|${Product_Name}|${Supplier}|${Category}"
	 			row = 1
	 			column = 1   
				width = medium
			)
			External_Barcode
			(
    			type = text
				displayname = "External Barcode"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Reorder_Level
			(
				type = number
				displayname = "Reorder Level"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Reorder_Quantity
			(
				type = number
				displayname = "Reorder Quantity"
    			description
    			[
    				type = tooltip
    			 	message = "Suggested quantity when creating Purchase Orders"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Max_Stock_Level
			(
				type = number
				displayname = "Max Stock Level"
    			description
    			[
    				type = tooltip
    			 	message = "Maximum stock to hold (for overstock warnings)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Lead_Time_Days
			(
				type = number
				displayname = "Lead Time Days"
				maxchar = 3
    			description
    			[
    				type = tooltip
    			 	message = "Typical supplier lead time in days for this product"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Total_Stock_On_Hand
			(
				type = decimal
				displayname = "Total Stock On Hand"
    			description
    			[
    				type = tooltip
    			 	message = "Total physical stock across all locations"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Total_Available
			(
				type = decimal
				displayname = "Total Available"
    			description
    			[
    				type = tooltip
    			 	message = "Total available stock across all locations"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Product_Image
			(
    			type = image
				displayname = "Product Image"
				source  = file
				aspect ratio = original
				camera = primary
				show gallery = true
				switch camera = true
	 			row = 1
	 			column = 1   
				width = medium
			)
			Associated_Products
			(
				type = list	
				displayname = "Associated Products"
				values  = Product_Master.ID
    			displayformat = [Product_Name]
				sortorder = ascending
				height = 60px
	 			row = 1
	 			column = 1   
				width = medium
			)
			Is_Active
			(
    			type = checkbox
				displayname = "Is Active"
				initial value = false
	 			row = 1
	 			column = 1   
				width = medium
			)
			Is_Stocked
			(
				type = checkboxes	
				displayname = "Is Stocked"
				values = {"Stocked"}
	 			row = 1
	 			column = 1   
				width = medium
			)
			Notes
			(
    			type = textarea
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Suppliers
		{
			displayname = "Product Supplier"
			success message = "Supplier Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Supplier_Number
			(
    			type = autonumber
				displayname = "Supplier Number"
				start index = 1
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have unique Supplier_Name
			(
    			type = text
				displayname = "Supplier Name"
	 			row = 1
	 			column = 1   
				width = medium
			)
			unique Supplier_Code
			(
    			type = text
				displayname = "Supplier Code"
				maxchar = 30
    			description
    			[
    				type = tooltip
    			 	message = "Short unique code for this supplier"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Supplier_Type
			(
				type = picklist
				displayname = "Supplier Type"
				maxchar = 100
				values = {"Materials","Equipment","Consumables","Services","Other"}
    			description
    			[
    				type = tooltip
    			 	message = "Category of products/services from this supplier"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Contact_Person
			(
    			type = text
				displayname = "Contact Person"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Email
			(
    			type = email
				maxchar = 80
	 			row = 1
	 			column = 1   
				width = medium
				personal data = true
			)
			Phone_Number
			(
    			type = phonenumber
				displayname = "Phone"
	 			row = 1
	 			column = 1   
				width = medium
				personal data = true
			)
			Address
			(
    			type = textarea
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
			Payment_Terms
			(
    			type = text
				displayname = "Payment Terms"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Lead_Time_Days
			(
				type = number
				displayname = "Lead Time Days"
				maxchar = 3
				initial value = 7
    			description
    			[
    				type = tooltip
    			 	message = "Typical delivery lead time in days from this supplier"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Account_Number
			(
    			type = text
				displayname = "Account Number"
				maxchar = 50
    			description
    			[
    				type = tooltip
    			 	message = "Your account/customer number with this supplier"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Is_Active
			(
    			type = checkbox
				displayname = "Is Active"
				initial value = false
	 			row = 1
	 			column = 1   
				width = medium
			)
			Notes
			(
    			type = textarea
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Project_Proposals
		{
			displayname = "Project Proposals"
			success message = "Project Proposal Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Auto_Number
			(
    			type = autonumber
				displayname = "Auto Number"
				start index = 1000
	 			row = 1
	 			column = 1   
				width = medium
			)
			Proposal_Number
			(
    			type = text
				displayname = "Proposal Number"
    			description
    			[
    				type = tooltip
    			 	message = "Auto generated number"
    			]
				private = true
	 			row = 1
	 			column = 1   
				width = medium
			)
			Procore_Project_ID
			(
    			type = text
				displayname = "Procore Project ID"
    			description
    			[
    				type = tooltip
    			 	message = "Auto generated by Procore"
    			]
				private = true
	 			row = 1
	 			column = 1   
				width = medium
			)
			Project_Name
			(
    			type = text
				displayname = "Project Name"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Address
			(
    			type = address
     			capture_coordinates = true
     			adjust_using_map = false
     			address_line_1
     			(
	     			  type = address_line_1
	     			  displayname = "Address Line 1"
     			) 
     			address_line_2
     			(
	     			  type = address_line_2
	     			  displayname = "Address Line 2"
     			) 
     			district_city
     			(
	     			  type = district_city
	     			  displayname = "City / District"
     			) 
     			state_province
     			(
	     			  type = state_province
	     			  displayname = "State / Province"
     			) 
     			postal_Code
     			(
	     			  type = postal_Code
	     			  displayname = "Postal Code"
     			) 
     			country
     			(
	     			  type = country
	     			  displayname = "Country"
     			) 
     			latitude
     			(
	     			  type = latitude
	     			  displayname = "latitude"
	     			 visibility = false
     			) 
     			longitude
     			(
	     			  type = longitude
	     			  displayname = "longitude"
	     			 visibility = false
     			) 
	 			row = 1
	 			column = 1   
				width = medium
				personal data = true
			)
			Google_Maps_Link
			(
    			type = url
				displayname = "Google Maps Link"
				enable  linkname
	 			row = 1
	 			column = 1   
				width = medium
			)
			Estimated_Start
			(
    			type = date
				displayname = "Estimated Start"
				alloweddays = 0,1,2,3,4,5,6
	 			row = 1
	 			column = 1   
				width = medium
			)
			Estimated_Start_Date
			(
    			type = text
				displayname = "Estimated Start Date"
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Companies
			(
				type = picklist	
				values  = Companies.ID
    			displayformat = [Company_Name]
				allow new entries
				[
					displayname = "Add New"
				]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Company_Contacts
			(
				type = picklist	
				displayname = "Company Contacts"
				values  = Company_Contacts.ID
    			displayformat = [Full_Name]
				allow new entries
				[
					displayname = "Add New"
				]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Proposal_Currency
			(
				type = picklist
				displayname = "Proposal Currency"
				maxchar = 100
				values = {"EUR","GBP","AUS"}
	 			row = 1
	 			column = 1   
				width = medium
			)
			Agreed_Price
			(
				displayname = "Agreed Price"
				type = EUR
				format = commadotindian
	 			row = 1
	 			column = 1   
				width = medium
			)
			Proposal_Status
			(
				type = picklist
				displayname = "Proposal Status"
				maxchar = 100
				values = {"Draft","Approved","Rejected","Won","Lost"}
				initial value = "Draft"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Category
			(
    			type = text
	 			row = 1
	 			column = 1   
				width = medium
			)
			Sub_Category
			(
    			type = text
				displayname = "Sub Category"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Drawing_Attachment
			(
    			type = image
				displayname = "Drawing Attachment"
				compression = true
				source  = file
				aspect ratio = original
				camera = primary
				show gallery = true
				switch camera = true
	 			row = 1
	 			column = 1   
				width = medium
			)
			Submitted_Date
			(
    			type = datetime
				displayname = "Submitted Date"
				initial value = "${zoho.currenttime}"
				timedisplayoptions = "hh:mm:ss"
				alloweddays = 0,1,2,3,4,5,6
	 			row = 1
	 			column = 1   
				width = medium
			)
			Approved_By
			(
    			type = text
				displayname = "Approved By"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Approved_Date
			(
    			type = datetime
				displayname = "Approved Date"
				timedisplayoptions = "hh:mm:ss"
				alloweddays = 0,1,2,3,4,5,6
	 			row = 1
	 			column = 1   
				width = medium
			)
			Notes
			(
    			type = textarea
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
			Proposal_Date
			(
    			type = date
				displayname = "Proposal Date"
				initial value = "${zoho.currentdate}"
				alloweddays = 0,1,2,3,4,5,6
	 			row = 1
	 			column = 1   
				width = medium
			)
			Source_Kits
			(
				type = picklist	
				displayname = "Source Kits"
				values  = Product_Kits.ID
    			displayformat = [Kit_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Clear_All_Items
			(
    			type = checkbox
				displayname = "Clear All Items"
				initial value = false
	 			row = 1
	 			column = 1   
				width = medium
			)
			Project_Contacts
			(
				type = grid
				displayname = "Project Contacts"
				values  = Proposal_Contacts.ID
    			bidirectional = Proposal
	 			row = 2
	 			column = 1   
				width = medium
			)
			Work_Packages
			(
				type = grid
				displayname = "Work Packages"
				values  = Proposal_Work_Packages.ID
    			bidirectional = Proposal
	 			row = 3
	 			column = 1   
				width = medium
			)
			Proposal_Line_Items
			(
				type = grid
				displayname = "Proposal Line Items"
				values  = Proposal_Line_Items.ID
    			bidirectional = Proposal
	 			row = 4
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		print template
			{
				Sales_Won_Form
				{
							content = {"pageNumberOption":null,"orientation":"null","images":[{"fileName":"","imageId":"","imageType":"","fileId":""},{"fileName":"1764016384124_Rascor-Logo.png","imageId":"img_46456459999996424","imageType":"upload","fileId":"5647446000000023086"},{"fileName":"1764016384124_Rascor-Logo.png","imageId":"img_19659013999999762","imageType":"upload","fileId":"5647446000000023086"},{"fileName":"1764016384124_Rascor-Logo.png","imageId":"img_16006979999999702","imageType":"upload","fileId":"5647446000000023086"}],"imageId":"","isFooterEnabled":false,"containerStyle":"","templateStyle":"text-align: left; width: 793.7px; background-image: none; padding: 15px","version":"2","layout":"1","mainLayout":[{"elements":[{"type":"columns","element":{"split":"100,36","id":"u_elem_46072609999996424","elemStyle":"","collayouts":[{"colElements":[{"type":"image","element":{"imageId":"img_46456459999996424","size":"M","src":"https://creator.zoho.eu/appbuilder/quantumbuild1/rascor-stock-management/downLoadImage?imgFileId=5647446000000023086&imgFileName=1764016384124_Rascor-Logo.png","captionMargin":"0px auto","alt":"","caption":"","selectFormCompId":"","id":"u_elem_4607257999999523","align":"right","elemStyle":"border: 0px solid rgb(169, 169, 169); margin-right: 10px; width: 300px","formCompId":""}},{"type":"spacer","element":{"id":"u_elem_7249370999999642","height":"35"}},{"type":"text","element":{"id":"u_elem_7459915999999642","fields":[],"content":"<div style=\"background: rgba(0, 0, 0, 0); padding: 0px\">\n   <h1 style=\"text-align: center; color: rgb(0, 0, 0); font-style: normal\"><b>SALES WON FORM<\/b><\/h1>\n  <\/div>"}},{"type":"columns","element":{"split":"100","id":"u_elem_11998198999999762","elemStyle":"","collayouts":[{"colElements":[{"id":"u_elem_15925985570871428","type":"fields","element":{"valueStyle":"width: 50%; border-width: 1px 1px 0px; border-style: solid; border-color: rgb(51, 51, 51)","valueTextStyle":"","fieldLayoutType":"2","labelText":"Proposal Number","wrapperStyle":"","labelStyle":"width: 50%; border-width: 1px 0px 0px 1px; border-style: solid; border-color: rgb(0, 0, 0)","Label_Name":"Proposal_Number","labelTextStyle":""}}]}]}},{"id":"u_elem_15925985570889688","type":"fields","element":{"valueStyle":"width: 50%; border-width: 1px 1px 0px; border-style: solid; border-color: rgb(51, 51, 51)","valueTextStyle":"","fieldLayoutType":"2","labelText":"Project Name","wrapperStyle":"","labelStyle":"width: 50%; border-width: 1px 0px 0px 1px; border-style: solid; border-color: rgb(0, 0, 0)","Label_Name":"Project_Name","labelTextStyle":""}},{"id":"u_elem_15925985570895008","type":"fields","element":{"valueStyle":"width: 50%; border-width: 1px 1px 0px; border-style: solid; border-color: rgb(51, 51, 51)","valueTextStyle":"","fieldLayoutType":"2","labelText":"Address","wrapperStyle":"","labelStyle":"width: 50%; border-width: 1px 0px 0px 1px; border-style: solid; border-color: rgb(0, 0, 0)","Label_Name":"Address","labelTextStyle":"","compFields":["address_line_1","address_line_2","district_city","state_province","postal_Code","country"]}},{"id":"u_elem_15925985570899428","type":"fields","element":{"valueStyle":"width: 50%; border-width: 1px 1px 0px; border-style: solid; border-color: rgb(51, 51, 51)","valueTextStyle":"","fieldLayoutType":"2","labelText":"Google Maps Link","wrapperStyle":"","labelStyle":"width: 50%; border-width: 1px 0px 0px 1px; border-style: solid; border-color: rgb(0, 0, 0)","Label_Name":"Google_Maps_Link","labelTextStyle":""}},{"id":"u_elem_15925985570904078","type":"fields","element":{"valueStyle":"width: 50%; border-width: 1px 1px 0px; border-style: solid; border-color: rgb(51, 51, 51)","valueTextStyle":"","fieldLayoutType":"2","labelText":"Estimated Start Date","wrapperStyle":"","labelStyle":"width: 50%; border-width: 1px 0px 0px 1px; border-style: solid; border-color: rgb(0, 0, 0)","Label_Name":"Estimated_Start_Date","labelTextStyle":""}},{"id":"u_elem_15925985570910038","type":"lookupfields","element":{"valueStyle":"width: 50%; border-width: 1px 1px 0px; border-style: solid; border-color: rgb(51, 51, 51)","valueTextStyle":"","fieldLayoutType":"2","related_Form":"Companies","labelText":"Contractor","wrapperStyle":"","labelStyle":"width: 50%; border-width: 1px 0px 0px 1px; border-style: solid; border-color: rgb(0, 0, 0)","Label_Name":"Companies","refFields":[{"valueStyle":"                                          ","fieldLayoutType":"2","labelText":"Company Name","labelStyle":"                                          ","Label_Name":"Company_Name"}],"labelTextStyle":""}},{"id":"u_elem_15925985570923428","type":"lookupfields","element":{"valueStyle":"width: 50%; border-width: 1px 1px 0px; border-style: solid; border-color: rgb(51, 51, 51)","valueTextStyle":"","fieldLayoutType":"2","related_Form":"Company_Contacts","labelText":"Contractor Sales Contact","wrapperStyle":"","labelStyle":"width: 50%; border-width: 1px 0px 0px 1px; border-style: solid; border-color: rgb(0, 0, 0)","Label_Name":"Company_Contacts","refFields":[{"valueStyle":"                                          ","fieldLayoutType":"2","labelText":"Full Name","labelStyle":"                                          ","Label_Name":"Full_Name"}],"labelTextStyle":""}},{"id":"u_elem_15925985570932418","type":"fields","element":{"valueStyle":"width: 50%; border-width: 1px; border-style: solid; border-color: rgb(51, 51, 51)","valueTextStyle":"","fieldLayoutType":"2","labelText":"Agreed Price","wrapperStyle":"","labelStyle":"width: 50%; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(0, 0, 0)","Label_Name":"Agreed_Price","labelTextStyle":""}},{"type":"text","element":{"id":"u_elem_17220072999999523","fields":[],"content":"<div\n    style=\"background: rgb(231, 231, 231); padding: 0px; border-width: 0px 1px 1px; border-style: solid; border-color: rgb(68, 68, 68)\">\n   <h1\n      style=\"text-align: center; color: rgb(0, 0, 0); font-style: normal\"><font\n        style=\"font-size: 28px\"><b style=\"\">Project Contacts<\/b><\/font><\/h1>\n  <\/div>"}},{"id":"u_elem_15925985570939828","type":"lookupfields","element":{"valueStyle":"width: 50%","valueTextStyle":"","fieldLayoutType":"1","related_Form":"Proposal_Contacts","labelText":"Project Contacts","wrapperStyle":"","labelStyle":"width: 50%; display: none","Label_Name":"Project_Contacts","refFields":[{"valueStyle":"                  ","fieldLayoutType":"2","labelText":"Role","labelStyle":"                  ","Label_Name":"Role"},{"valueStyle":"                  ","fieldLayoutType":"2","labelText":"Contact Name","labelStyle":"                  ","Label_Name":"Contact_Name"},{"valueStyle":"                  ","fieldLayoutType":"2","labelText":"Email","labelStyle":"                  ","Label_Name":"Email"},{"valueStyle":"                  ","fieldLayoutType":"2","labelText":"Phone","labelStyle":"                  ","Label_Name":"Phone_Number"}],"labelTextStyle":""}}]},{"colElements":[{"type":"spacer","element":{"id":"u_elem_4696005","height":"50"}}]}]}},{"type":"columns","element":{"split":"100","id":"u_elem_1964496","elemStyle":"","collayouts":[{"colElements":[{"type":"image","element":{"imageId":"img_19659013999999762","size":"M","src":"https://creator.zoho.eu/appbuilder/quantumbuild1/rascor-stock-management/downLoadImage?imgFileId=5647446000000023086&imgFileName=1764016384124_Rascor-Logo.png","captionMargin":"0px auto","alt":"","caption":"","selectFormCompId":"","id":"u_elem_1964496","align":"right","elemStyle":"border: 0px solid rgb(169, 169, 169); margin-right: 10px; width: 300px","formCompId":""}}]}]}},{"type":"columns","element":{"split":"100","id":"u_elem_20446340999999642","elemStyle":"","collayouts":[{"colElements":[{"id":"u_elem_15925985570980318","type":"fields","element":{"valueStyle":"width: 50%; text-align: center; border-width: 0px; border-style: solid; border-color: rgb(51, 51, 51)","valueTextStyle":"font-size: 28px; font-weight: bold","fieldLayoutType":"1","labelText":"Project Name","wrapperStyle":"","labelStyle":"width: 50%; display: none","Label_Name":"Project_Name","labelTextStyle":""}},{"type":"spacer","element":{"id":"u_elem_8707808999999762","height":"35"}}]}]}},{"type":"columns","element":{"split":"50,50","id":"u_elem_21131557999999523","elemStyle":"","collayouts":[{"colElements":[{"id":"u_elem_15925985570989718","type":"fields","element":{"valueStyle":"width: 50%; border-width: 1px 0px 0px; border-style: solid; border-color: rgb(51, 51, 51)","valueTextStyle":"font-size: 12px","fieldLayoutType":"2","labelText":"Project Name","wrapperStyle":"","labelStyle":"width: 50%; border-width: 1px 0px 0px 1px; border-style: solid; border-color: rgb(0, 0, 0)","Label_Name":"Project_Name","labelTextStyle":"font-size: 12px"}}]},{"colElements":[{"id":"u_elem_15925985570995868","type":"fields","element":{"valueStyle":"width: 50%; border-width: 1px 1px 0px 0px; border-style: solid; border-color: rgb(51, 51, 51)","valueTextStyle":"font-size: 12px","fieldLayoutType":"2","labelText":"Category","wrapperStyle":"","labelStyle":"width: 50%; border-width: 1px 0px 0px 1px; border-style: solid; border-color: rgb(0, 0, 0)","Label_Name":"Category","labelTextStyle":"font-size: 12px"}}]}]}},{"type":"columns","element":{"split":"50,50","id":"u_elem_6164668000000119","elemStyle":"","collayouts":[{"colElements":[{"id":"u_elem_15925985571004478","type":"fields","element":{"valueStyle":"width: 50%; border-width: 1px 0px; border-style: solid; border-color: rgb(51, 51, 51)","valueTextStyle":"font-size: 12px","fieldLayoutType":"2","labelText":"Proposal Date","wrapperStyle":"","labelStyle":"width: 50%; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(0, 0, 0)","Label_Name":"Proposal_Date","labelTextStyle":"font-size: 12px"}}]},{"colElements":[{"id":"u_elem_15925985571010718","type":"fields","element":{"valueStyle":"width: 50%; border-width: 1px 1px 1px 0px; border-style: solid; border-color: rgb(51, 51, 51)","valueTextStyle":"font-size: 12px","fieldLayoutType":"2","labelText":"Sub Category","wrapperStyle":"","labelStyle":"width: 50%; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(0, 0, 0)","Label_Name":"Sub_Category","labelTextStyle":"font-size: 12px"}}]}]}},{"type":"columns","element":{"split":"100","id":"u_elem_5773749699999988","elemStyle":"","collayouts":[{"colElements":[{"type":"spacer","element":{"id":"u_elem_57737495","height":"25"}}]}]}},{"type":"columns","element":{"split":"50,50","id":"u_elem_5785724599999964","elemStyle":"","collayouts":[{"colElements":[{"type":"spacer","element":{"id":"u_elem_5789978599999964","height":"38"}}]},{"colElements":[{"type":"text","element":{"id":"u_elem_57857245","fields":[],"content":"<div style=\"background: rgb(231, 231, 231); padding: 0px\">\n   <h1\n      style=\"text-align: center; color: rgb(0, 0, 0); font-weight: 400; font-style: normal\"><font style=\"font-size: 16px\">RASCOR<\/font><\/h1>\n  <\/div>"}}]}]}},{"type":"columns","element":{"split":"100","id":"u_elem_62864200000047684","elemStyle":"","collayouts":[{"colElements":[{"id":"u_elem_15925985571033268","type":"lookupfields","element":{"valueStyle":"width: 50%","valueTextStyle":"","fieldLayoutType":"1","related_Form":"Proposal_Line_Items","labelText":"Proposal Line Items","wrapperStyle":"","labelStyle":"width: 50%; display: none","Label_Name":"Proposal_Line_Items","refFields":[{"valueStyle":"      ","fieldLayoutType":"2","labelText":"Product","labelStyle":"      ","Label_Name":"Product"},{"valueStyle":"      ","fieldLayoutType":"2","labelText":"Quantity","labelStyle":"      ","Label_Name":"Quantity"},{"valueStyle":"      ","fieldLayoutType":"2","labelText":"Unit","labelStyle":"      ","Label_Name":"Unit"},{"valueStyle":"      ","fieldLayoutType":"2","labelText":"Rate","labelStyle":"      ","Label_Name":"Rate"},{"valueStyle":"      ","fieldLayoutType":"2","labelText":"Line Total","labelStyle":"      ","Label_Name":"Line_Total"}],"labelTextStyle":""}}]}]}},{"type":"columns","element":{"split":"50,50","id":"u_elem_148315","elemStyle":"","collayouts":[{"colElements":[{"type":"spacer","element":{"id":"u_elem_1483145","height":"50"}},{"type":"spacer","element":{"id":"u_elem_6069159999996424","height":"50"}}]},{"colElements":[{"id":"u_elem_15925985571067098","type":"fields","element":{"valueStyle":"width: 50%","valueTextStyle":"","fieldLayoutType":"2","labelText":"Agreed Price","wrapperStyle":"","labelStyle":"width: 50%","Label_Name":"Agreed_Price","labelTextStyle":""}}]}]}},{"type":"columns","element":{"split":"100","id":"u_elem_1566383999999985","elemStyle":"","collayouts":[{"colElements":[{"type":"image","element":{"imageId":"img_16006979999999702","size":"M","src":"https://creator.zoho.eu/appbuilder/quantumbuild1/rascor-stock-management/downLoadImage?imgFileId=5647446000000023086&imgFileName=1764016384124_Rascor-Logo.png","captionMargin":"0px auto","alt":"","caption":"","selectFormCompId":"","id":"u_elem_15663829999999702","align":"right","elemStyle":"border: 0px solid rgb(169, 169, 169); margin-right: 10px; width: 300px","formCompId":""}}]}]}},{"type":"columns","element":{"split":"100","id":"u_elem_2397019999999553","elemStyle":"","collayouts":[{"colElements":[{"id":"u_elem_15925985571087479","type":"fields","element":{"valueStyle":"width: 50%","valueTextStyle":"","fieldLayoutType":"1","labelText":"Drawing Attachment","wrapperStyle":"","labelStyle":"width: 50%; display: none","Label_Name":"Drawing_Attachment","labelTextStyle":""}}]}]}}],"id":1}],"resize":"a4","themeFont":"lato","isHeaderEnabled":false}
				}
			}
		}
		form Proposal_Contacts
		{
			displayname = "Proposal Contacts"
			success message = "Proposal Contact Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Proposal
			(
				type = picklist	
				values  = Project_Proposals.ID
    			bidirectional = Project_Contacts
    			displayformat = [Proposal_Number]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Role
			(
				type = picklist
				maxchar = 100
				values = {"Quantity Surveyor","Site Manager","Contracts Manager","Safety Officer","Other"}
	 			row = 1
	 			column = 1   
				width = medium
			)
			Contact_Name
			(
    			type = text
				displayname = "Contact Name"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Phone_Number
			(
    			type = phonenumber
				displayname = "Phone"
	 			row = 1
	 			column = 1   
				width = medium
				personal data = true
			)
			Email
			(
    			type = email
				maxchar = 80
	 			row = 1
	 			column = 1   
				width = medium
				personal data = true
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Proposal_Line_Items
		{
			displayname = "Proposal Line Items"
			success message = "Proposal Line Item Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Work_Package
			(
				type = picklist	
				displayname = "Work Package"
				values  = Proposal_Work_Packages.ID
    			displayformat = [Package_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Product
			(
				type = picklist	
				values  = Product_Master.ID
    			displayformat = [Product_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Description
			(
    			type = text
	 			row = 1
	 			column = 1   
				width = medium
			)
			Unit
			(
    			type = text
	 			row = 1
	 			column = 1   
				width = medium
			)
			Rate
			(
				type = EUR
				format = commadotwestern
	 			row = 1
	 			column = 1   
				width = medium
			)
			Quantity
			(
				type = decimal
	 			row = 1
	 			column = 1   
				width = medium
			)
			Line_Total
			(
				displayname = "Line Total"
				type = EUR
				format = commadotindian
	 			row = 1
	 			column = 1   
				width = medium
			)
			Comment
			(
    			type = text
	 			row = 1
	 			column = 1   
				width = medium
			)
			Proposal
			(
				type = picklist	
				values  = Project_Proposals.ID
    			bidirectional = Proposal_Line_Items
    			displayformat = [ID]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Sort_Order
			(
				type = number
				displayname = "Sort Order"
				maxchar = 4
				initial value = 100
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Proposal_Pricing
		{
			displayname = "Proposal Pricing"
			success message = "Data Added Successfully!"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Package
			(
				type = picklist	
				values  = Product_Kits.ID
    			displayformat = [Kit_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Product
			(
				type = picklist	
				values  = Product_Master.ID
    			displayformat = [Product_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Description
			(
    			type = text
	 			row = 1
	 			column = 1   
				width = medium
			)
			Quantity
			(
				type = decimal
	 			row = 1
	 			column = 1   
				width = medium
			)
			Unit
			(
    			type = text
	 			row = 1
	 			column = 1   
				width = medium
			)
			Rate
			(
				type = decimal
	 			row = 1
	 			column = 1   
				width = medium
			)
			Line_Total
			(
				type = decimal
				displayname = "Line Total"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Comment
			(
    			type = text
	 			row = 1
	 			column = 1   
				width = medium
			)
			Sort_Order
			(
				type = number
				displayname = "Sort Order"
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Proposal_Work_Packages
		{
			displayname = "Proposal Work Packages"
			success message = "Proposal Work Package Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Proposal
			(
				type = picklist	
				values  = Project_Proposals.ID
    			bidirectional = Work_Packages
    			displayformat = [Proposal_Number]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Source_Kit
			(
				type = picklist	
				displayname = "Source Kit"
				values  = Product_Kits.ID
    			displayformat = [Kit_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Formula
			(
    			type = formula
				value =  Source_Kit == null
				visibility = true
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Package_Name
			(
    			type = text
				displayname = "Package Name"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Sort_Order
			(
				type = number
				displayname = "Sort Order"
				maxchar = 4
				initial value = 100
	 			row = 1
	 			column = 1   
				width = medium
			)
			Package_Total
			(
				displayname = "Package Total"
				type = EUR
				format = commadotindian
	 			row = 1
	 			column = 1   
				width = medium
			)
			Estimated_Total
			(
    			type = formula
				displayname = "Estimated Total"
				value =  input.Source_Kit.Kit_Total
				visibility = true
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Purchase_Orders
		{
			displayname = "Purchase Orders"
			success message = "Purchase Order Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			PO_ID
			(
    			type = autonumber
				displayname = "PO ID"
				start index = 1
	 			row = 1
	 			column = 1   
				width = medium
			)
			unique PO_Number
			(
    			type = text
				displayname = "PO Number"
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Supplier
			(
				type = picklist	
				values  = Suppliers.ID
    			displayformat = [Supplier_Name]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Select supplier for this order"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Order_Date
			(
    			type = date
				displayname = "Order Date"
				initial value = "${zoho.currentdate}"
				alloweddays = 0,1,2,3,4,5,6
    			description
    			[
    				type = tooltip
    			 	message = "Date PO raised"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Expected_Delivery
			(
    			type = date
				displayname = "Expected Delivery"
				initial value = "${zoho.currentdate}"
				alloweddays = 0,1,2,3,4,5,6
    			description
    			[
    				type = tooltip
    			 	message = "Anticipated delivery date"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Delivery_Location
			(
				type = picklist	
				displayname = "Delivery Location"
				values  = Stock_Locations.ID
    			displayformat = [Location_Name]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Warehouse to receive goods"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have PO_Status
			(
				type = picklist
				displayname = "PO Status"
				maxchar = 100
				values = {"Draft","Confirmed","Partially Received","Fully Received","Cancelled"}
				initial value = "Draft"
    			description
    			[
    				type = tooltip
    			 	message = "Current status of purchase order"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Total_Value
			(
				displayname = "Total Value"
				type = EUR
				format = commadotwestern
    			description
    			[
    				type = tooltip
    			 	message = "Sum of all line item totals"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Raised_By
			(
    			type = text
				displayname = "Raised By"
				initial value = "${zoho.loginuserid}"
    			description
    			[
    				type = tooltip
    			 	message = "Person who created this PO"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Notes
			(
    			type = textarea
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
			PO_Lines
			(
				type = grid
				displayname = "PO Lines"
				values  = PO_Line_Items.ID
				auto width = false
	 			row = 2
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Quick_Count_Redirect
		{
			success message = "Data Added Successfully!"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Line_ID
			(
    			type = text
				displayname = "Line ID"
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Site_Product_Catalog
		{
			displayname = "Site Product Catalog"
			success message = "Data Added Successfully!"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Catalog_Number
			(
    			type = autonumber
				displayname = "Catalog Number"
				start index = 1
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Site
			(
				type = picklist	
				values  = rascor_site_attendance.Sites_Reference.ID
    			displayformat = [Site_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Product
			(
				type = picklist	
				values  = Product_Master.ID
    			displayformat = [Product_Name]
				advanced field search = true
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Is_Standard
			(
				type = checkboxes	
				displayname = "Is Standard"
				values = {"Is Standard"}
	 			row = 1
	 			column = 1   
				width = medium
			)
			Active
			(
				type = checkboxes	
				values = {"Active"}
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Stock_Levels
		{
			displayname = "Stock Levels"
			success message = "Stock Level Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			must have Product
			(
				type = picklist	
				values  = Product_Master.ID
    			displayformat = [Product_Name]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Select the product"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Location
			(
				type = picklist	
				values  = Stock_Locations.ID
    			displayformat = [Location_Name]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Stock location for this inventory record"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Bay_Location
			(
				type = picklist	
				displayname = "Bay Location"
				values  = Bay_Locations[Stock_Locations.ID == input.Location.ID].ID
    			displayformat = [Bay_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Quantity_On_Hand
			(
				type = decimal
				displayname = "Quantity On Hand"
				initial value = 0
    			description
    			[
    				type = tooltip
    			 	message = "Current physical stock quantity"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Quantity_Reserved
			(
				type = decimal
				displayname = "Quantity Reserved"
				initial value = 0
    			description
    			[
    				type = tooltip
    			 	message = "Quantity allocated to approved orders (not yet collected)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Quantity_Available
			(
    			type = formula
				displayname = "Quantity Available"
				value =  input.Quantity_On_Hand - input.Quantity_Reserved
				visibility = false
	 			row = 1
	 			column = 1   
				width = medium
			)
			Quantity_On_Order
			(
				type = decimal
				displayname = "Quantity On Order"
				initial value = 0
    			description
    			[
    				type = tooltip
    			 	message = "Quantity pending from Purchase Orders (not yet received)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Last_Count_Date
			(
    			type = date
				displayname = "Last Count Date"
				alloweddays = 0,1,2,3,4,5,6
    			description
    			[
    				type = tooltip
    			 	message = "Date of last physical stock count"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Last_Movement_Date
			(
    			type = datetime
				displayname = "Last Movement Date"
				timedisplayoptions = "hh:mm:ss"
				alloweddays = 0,1,2,3,4,5,6
    			description
    			[
    				type = tooltip
    			 	message = "Date/time of last stock transaction"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Is_Low_Stock
			(
    			type = formula
				displayname = "Is Low Stock"
				value =  if(ifnull(input.Quantity_On_Hand,0) - ifnull(input.Quantity_Reserved,0) < ifnull(input.Product.Reorder_Level,0),1,0)
				visibility = false
	 			row = 1
	 			column = 1   
				width = medium
			)
			Stock_Value
			(
    			type = formula
				displayname = "Stock Value"
				value =  ifnull(input.Quantity_On_Hand,0) * ifnull(input.Product.Base_Rate,0)
				visibility = false
				display type = text
				format = plaintext
	 			row = 1
	 			column = 1   
				width = medium
			)
			Stock_Value_Stored
			(
				displayname = "Stock Value Stored"
				type = EUR
				format = dotcomma
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Stock_Locations
		{
			displayname = "Stock Locations"
			success message = "Stock Location Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			must have unique Location_Code
			(
    			type = text
				displayname = "Location Code"
				maxchar = 20
    			description
    			[
    				type = tooltip
    			 	message = "Unique short code (e.g., WH-MAIN, WH-SITE01, VAN-JM)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Location_Name
			(
    			type = text
				displayname = "Location Name"
				maxchar = 100
    			description
    			[
    				type = tooltip
    			 	message = "Descriptive name for this location"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Location_Type
			(
				type = picklist
				displayname = "Location Type"
				maxchar = 100
				values = {"Warehouse","Site Store","Van Stock","Transit"}
				initial value = "Warehouse"
    			description
    			[
    				type = tooltip
    			 	message = "Type of storage location"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Sites_Reference
			(
				type = picklist	
				displayname = "Sites Reference"
				values  = rascor_site_attendance.Sites_Reference.ID
    			displayformat = [Site_Name]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Link to site (for Site Store locations)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Address
			(
    			type = address
     			capture_coordinates = true
     			adjust_using_map = false
     			address_line_1
     			(
	     			  type = address_line_1
	     			  displayname = "Address Line 1"
     			) 
     			address_line_2
     			(
	     			  type = address_line_2
	     			  displayname = "Address Line 2"
     			) 
     			district_city
     			(
	     			  type = district_city
	     			  displayname = "City / District"
     			) 
     			state_province
     			(
	     			  type = state_province
	     			  displayname = "State / Province"
     			) 
     			postal_Code
     			(
	     			  type = postal_Code
	     			  displayname = "Postal Code"
     			) 
     			country
     			(
	     			  type = country
	     			  displayname = "Country"
     			) 
     			latitude
     			(
	     			  type = latitude
	     			  displayname = "latitude"
	     			 visibility = false
     			) 
     			longitude
     			(
	     			  type = longitude
	     			  displayname = "longitude"
	     			 visibility = false
     			) 
    			description
    			[
    				type = tooltip
    			 	message = "Physical address of this location"
    			]
	 			row = 1
	 			column = 1   
				width = medium
				personal data = true
			)
			Is_Default
			(
    			type = checkbox
				displayname = " Is Default"
				initial value = false
    			description
    			[
    				type = tooltip
    			 	message = "Check if this is the main receiving warehouse"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Is_Active
			(
    			type = checkbox
				displayname = "Is Active"
				initial value = true
    			description
    			[
    				type = tooltip
    			 	message = "Uncheck to deactivate this location"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Notes
			(
    			type = textarea
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Stock_Ordering
		{
			displayname = "Stock Ordering"
			success message = "Stock Order Added Successfully"
			Ordering_Instructions
			(
				type = section
				displayname = "Quick Order Instructions"
				visibility = true
	 			row = 1
	 			column = 0   
				width = medium
			)
			plain
			(
    			type = plaintext
				value = "<div><span><span class=\"highlight\" style=\"background-color: rgb(255, 255, 255)\"><span class=\"colour\" style=\"color: rgb(102, 102, 255)\"><b>1. Select your site</b></span></span></span><span class=\"highlight\" style=\"background-color: rgb(255, 255, 255)\"><span class=\"colour\" style=\"color: rgb(102, 102, 255)\"><b><br /></b></span></span></div><div><span><span class=\"highlight\" style=\"background-color: rgb(255, 255, 255)\"><span class=\"colour\" style=\"color: rgb(102, 102, 255)\"><b>2. Select or Enter your name</b></span></span></span><span class=\"highlight\" style=\"background-color: rgb(255, 255, 255)\"><span class=\"colour\" style=\"color: rgb(102, 102, 255)\"><b><br /></b></span></span></div><div><span><span class=\"highlight\" style=\"background-color: rgb(255, 255, 255)\"><span class=\"colour\" style=\"color: rgb(102, 102, 255)\"><b>3. Set Qty of required products</b></span></span></span><span class=\"highlight\" style=\"background-color: rgb(255, 255, 255)\"><span class=\"colour\" style=\"color: rgb(102, 102, 255)\"><b><br /></b></span></span></div><div><span><span class=\"highlight\" style=\"background-color: rgb(255, 255, 255)\"><span class=\"colour\" style=\"color: rgb(102, 102, 255)\"><b>4. Submit</b></span></span></span> <br /></div>"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Section
			(
				type = section
	 			row = 2
	 			column = 0   
				width = medium
			)
			Order_Number_Auto
			(
    			type = autonumber
				displayname = "Order Number Auto"
				start index = 1
	 			row = 2
	 			column = 1   
				width = medium
			)
			Order_Number
			(
    			type = formula
				displayname = "Order Number"
				value =  "ORD-" + input.Order_Number_Auto
				visibility = false
				display type = text
				format = plaintext
	 			row = 2
	 			column = 1   
				width = medium
			)
			must have Sites_Reference
			(
				type = picklist	
				displayname = "Site / Project"
				values  = rascor_site_attendance.Sites_Reference.ID
    			displayformat = [Site_Name]
				allow new entries
				[
					displayname = "Add New"
				]
				sortorder = ascending
	 			row = 2
	 			column = 1   
				width = medium
			)
			Site_Name_Stored
			(
    			type = text
				displayname = "Site Name Stored"
	 			row = 2
	 			column = 1   
				width = medium
			)
			Ordered_by_Employee
			(
				type = picklist	
				displayname = "Ordered By (Employee)"
				values  = rascor_site_attendance.Employees_Reference.ID
    			displayformat = [Employee_Display_Name]
				allow new entries
				[
					displayname = "Add New"
				]
				sortorder = ascending
	 			row = 2
	 			column = 1   
				width = medium
			)
			Ordered_by_Other
			(
    			type = text
				displayname = "Or Enter Name"
	 			row = 2
	 			column = 1   
				width = medium
			)
			Additional_Notes
			(
    			type = textarea
				displayname = "Additional Notes"
				height = 100px
	 			row = 2
	 			column = 1   
				width = medium
			)
			must have Source_Location
			(
				type = picklist	
				displayname = "Source Location"
				values  = Stock_Locations.ID
    			displayformat = [Location_Name]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Warehouse location to pick stock from"
    			]
	 			row = 2
	 			column = 1   
				width = medium
			)
			must have Collection_Date
			(
    			type = date
				displayname = "Collection Date"
				initial value = "${zoho.currentdate}"
				alloweddays = 0,1,2,3,4,5,6
	 			row = 2
	 			column = 1   
				width = medium
			)
			Collection_Status
			(
    			type = textarea
				displayname = "Collection Status"
				height = 100px
	 			row = 2
	 			column = 1   
				width = medium
			)
			Order_Date
			(
    			type = datetime
				displayname = "Order Date"
				initial value = "${zoho.currentdate}"
				timedisplayoptions = "hh:mm:ss"
				alloweddays = 0,1,2,3,4,5,6
	 			row = 2
	 			column = 1   
				width = medium
			)
			Order_Status
			(
				type = picklist
				displayname = "Order Status"
				maxchar = 100
				values = {"Draft","Pending Approval","Awaiting Pick","Awaiting Collection","Collected","Rejected","Cancelled"}
				initial value = "Draft"
	 			row = 2
	 			column = 1   
				width = medium
			)
			Picking_Stage
			(
				type = picklist
				displayname = "Picking Stage"
				maxchar = 100
				values = {"Pending Approval","Awaiting Pick","Awaiting Collection"}
	 			row = 2
	 			column = 1   
				width = medium
			)
			Collection_Stage
			(
				type = picklist
				displayname = "Collection Stage"
				maxchar = 100
				values = {"Awaiting Collection","Collected"}
	 			row = 2
	 			column = 1   
				width = medium
			)
			Ordered_by_Display
			(
    			type = formula
				displayname = "Ordered by Display"
				value =  if(Ordered_by_Employee != null,input.Ordered_by_Employee,input.Ordered_by_Other)
				visibility = false
				display type = text
				format = plaintext
	 			row = 2
	 			column = 1   
				width = medium
			)
			Stock_Reserved
			(
    			type = checkbox
				displayname = "Stock Reserved"
				initial value = false
    			description
    			[
    				type = tooltip
    			 	message = "System field - stock has been reserved"
    			]
	 			row = 2
	 			column = 1   
				width = medium
			)
			Stock_Issued
			(
    			type = checkbox
				displayname = "Stock Issued"
				initial value = false
    			description
    			[
    				type = tooltip
    			 	message = "System field - stock has been issued"
    			]
	 			row = 2
	 			column = 1   
				width = medium
			)
			Submitted_Date
			(
    			type = datetime
				displayname = "Submitted Date"
				initial value = "${zoho.currenttime}"
				timedisplayoptions = "hh:mm:ss"
				alloweddays = 0,1,2,3,4,5,6
				private = true
	 			row = 2
	 			column = 1   
				width = medium
			)
			Needs_Approval
			(
    			type = checkbox
				displayname = "Needs Approval"
				initial value = false
	 			row = 2
	 			column = 1   
				width = medium
			)
			Approved_By
			(
				type = picklist
				displayname = "Approved By"
				maxchar = 100
				values = {"Carl","Other"}
				private = true
	 			row = 2
	 			column = 1   
				width = medium
			)
			Approved_Date
			(
    			type = datetime
				displayname = "Approved Date"
				initial value = "${zoho.currenttime}"
				timedisplayoptions = "hh:mm:ss"
				alloweddays = 0,1,2,3,4,5,6
				private = true
	 			row = 2
	 			column = 1   
				width = medium
			)
			Approval_Notes
			(
    			type = textarea
				displayname = "Approval Notes"
				height = 100px
    			description
    			[
    				type = tooltip
    			 	message = "Notes from approver (reason for approval/rejection)"
    			]
	 			row = 2
	 			column = 1   
				width = medium
			)
			Collection_Bay
			(
				type = picklist	
				displayname = "Collection Bay"
				values  = Bay_Locations.ID
    			displayformat = [Bay_Name]
				sortorder = ascending
	 			row = 2
	 			column = 1   
				width = medium
			)
			Collected_DateTime
			(
    			type = datetime
				displayname = "Collected DateTime"
				timedisplayoptions = "hh:mm:ss"
				alloweddays = 0,1,2,3,4,5,6
	 			row = 2
	 			column = 1   
				width = medium
			)
			Collected_By
			(
    			type = text
				displayname = "Collected By"
	 			row = 2
	 			column = 1   
				width = medium
			)
			Edit_Mode
			(
    			type = text
				displayname = "Edit Mode"
	 			row = 2
	 			column = 1   
				width = medium
			)
			Order_Month
			(
    			type = formula
				displayname = "Order Month"
				value =  input.Order_Date.toString("MMM yyyy")
				visibility = false
				display type = text
				format = plaintext
	 			row = 2
	 			column = 1   
				width = medium
			)
			Order_Total_Stored
			(
				displayname = "Order Total Stored"
				type = EUR
				format = dotcomma
	 			row = 2
	 			column = 1   
				width = medium
			)
			Docket_Generated
			(
    			type = checkbox
				displayname = "Docket Generated"
				initial value = false
				private = true
	 			row = 2
	 			column = 1   
				width = medium
			)
			Docket_PDF
			(
    			type = upload file
				browse = local_drive
				private = true
	 			row = 2
	 			column = 1   
				width = medium
			)
			Excel_Synced
			(
    			type = checkbox
				displayname = "Excel Synced"
				initial value = false
				private = true
	 			row = 2
	 			column = 1   
				width = medium
			)
			Order
			(
				type = grid
				displayname = "Products to Order"
				values  = Order_Line_Items.ID
    			bidirectional = Order
				maxrow = 100
				auto width = false
	 			row = 3
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		print template
			{
				Order_Docket
				{
							content = {"pageNumberOption":null,"orientation":"null","images":[{"fileName":"","imageId":"","imageType":"","fileId":""}],"imageId":"","isFooterEnabled":false,"containerStyle":"","templateStyle":"text-align: left; width: 793.7px; background-image: none; border: 0px solid rgb(68, 68, 68)","version":"2","layout":"1","mainLayout":[{"elements":[{"type":"columns","element":{"split":"100","id":"u_elem_16572660999999996","elemStyle":"","collayouts":[{"colElements":[{"type":"text","element":{"id":"u_elem_16093115999999996","fields":[],"content":"<div style=\"background: rgba(0, 0, 0, 0); padding: 0px 15px\">\n   <h1\n      style=\"color: rgb(0, 0, 0); font-style: normal; text-align: left\"><font\n    style=\"font-size: 28px\"><b><br /><\/b><\/font><\/h1>\n   <h1\n      style=\"color: rgb(0, 0, 0); font-style: normal; text-align: left\"><font style=\"font-size: 28px\"><b>RASCOR Ireland<\/b><\/font><\/h1>\n  <\/div>"}}]}]}},{"type":"columns","element":{"split":"100","id":"u_elem_16841470999999996","elemStyle":"","collayouts":[{"colElements":[{"type":"text","element":{"id":"u_elem_1657266","fields":[],"content":"<div style=\"background: rgba(0, 0, 0, 0); padding: 0px 15px\">\n   <h1\n      style=\"color: rgb(0, 0, 0); font-weight: 400; font-style: normal; text-align: left\"><font\n        style=\"font-size: 18px\"><font style=\"\">Stock Order Docket<\/font><\/font><\/h1>\n  <\/div>"}}]}]}},{"type":"columns","element":{"split":"100","id":"u_elem_1722135","elemStyle":"","collayouts":[{"colElements":[{"type":"spacer","element":{"id":"u_elem_17221348999999985","height":"35"}}]}]}},{"type":"columns","element":{"split":"5,90,5","id":"u_elem_20591978999999985","elemStyle":"","collayouts":[{"colElements":[{"type":"spacer","element":{"id":"u_elem_21336023999999985","height":"36"}}]},{"colElements":[{"id":"u_elem_15923080780658349","type":"fields","element":{"valueStyle":"width: 50%","valueTextStyle":"font-size: 12px","fieldLayoutType":"2","labelText":"Order Number","wrapperStyle":"","labelStyle":"width: 50%; text-align: left; background-color: rgba(0, 0, 0, 0)","Label_Name":"Order_Number","labelTextStyle":"font-size: 12px; font-weight: bold"}}]},{"colElements":[{"type":"spacer","element":{"id":"u_elem_2139251","height":"36"}}]}]}},{"type":"columns","element":{"split":"5,90,5","id":"u_elem_20674108999999985","elemStyle":"","collayouts":[{"colElements":[{"type":"spacer","element":{"id":"u_elem_2144827","height":"36"}}]},{"colElements":[{"id":"u_elem_15923080780683949","type":"fields","element":{"valueStyle":"width: 50%","valueTextStyle":"font-size: 12px","fieldLayoutType":"2","labelText":"Order Date","wrapperStyle":"","labelStyle":"width: 50%; background-color: rgba(0, 0, 0, 0)","Label_Name":"Order_Date","labelTextStyle":"font-size: 12px; font-weight: bold"}}]},{"colElements":[{"type":"spacer","element":{"id":"u_elem_21498565","height":"36"}}]}]}},{"type":"columns","element":{"split":"5,90,5","id":"u_elem_20981771999999993","elemStyle":"","collayouts":[{"colElements":[{"type":"spacer","element":{"id":"u_elem_21529640999999996","height":"54"}}]},{"colElements":[{"id":"u_elem_15923080780700679","type":"lookupfields","element":{"valueStyle":"width: 50%; border-width: 0px; border-style: solid; border-color: rgb(51, 51, 51)","valueTextStyle":"font-size: 12px; color: rgb(51, 51, 51)","fieldLayoutType":"2","related_Form":"Sites_Reference","labelText":"Site / Project","wrapperStyle":"","labelStyle":"width: 50%; padding-top: 2px; padding-bottom: 2px; background-color: rgba(0, 0, 0, 0)","Label_Name":"Sites_Reference","refFields":[{"valueStyle":"                ","fieldLayoutType":"2","labelText":"Site_Name","labelStyle":"                ","Label_Name":"Site_Name"}],"labelTextStyle":"font-size: 12px; font-weight: bold"}}]},{"colElements":[{"type":"spacer","element":{"id":"u_elem_21575148999999985","height":"54"}}]}]}},{"type":"columns","element":{"split":"5,90,5","id":"u_elem_289214299999997","elemStyle":"","collayouts":[{"colElements":[{"type":"spacer","element":{"id":"u_elem_314032299999997","height":"54"}}]},{"colElements":[{"id":"u_elem_15923080780731959","type":"lookupfields","element":{"valueStyle":"width: 50%; border-width: 0px; border-style: solid; border-color: rgb(51, 51, 51)","valueTextStyle":"font-size: 12px","fieldLayoutType":"2","related_Form":"Employees_Reference","labelText":"Ordered By (Employee)","wrapperStyle":"","labelStyle":"width: 50%; border-width: 0px; border-style: solid; border-color: rgb(0, 0, 0); background-color: rgba(0, 0, 0, 0)","Label_Name":"Ordered_by_Employee","refFields":[{"valueStyle":"        ","fieldLayoutType":"2","labelText":"Employee_Display_Name","labelStyle":"    text-align: left    ","Label_Name":"Employee_Display_Name"}],"labelTextStyle":"font-size: 12px; font-weight: bold"}}]},{"colElements":[{"type":"spacer","element":{"id":"u_elem_32093560000000894","height":"54"}}]}]}},{"type":"columns","element":{"split":"100","id":"u_elem_25540210999999978","elemStyle":"","collayouts":[{"colElements":[{"type":"spacer","element":{"id":"u_elem_25540208000000007","height":"35"}}]}]}},{"type":"columns","element":{"split":"5,90,5","id":"u_elem_39484710999999978","elemStyle":"","collayouts":[{"colElements":[{"type":"spacer","element":{"id":"u_elem_1088340699999988","height":"90"}}]},{"colElements":[{"id":"u_elem_15923080780760199","type":"lookupfields","element":{"valueStyle":"width: 50%; border-width: 1px; border-style: dotted; border-color: rgb(51, 51, 51); padding: 5px","valueTextStyle":"font-weight: bold; font-size: 14px","fieldLayoutType":"3","related_Form":"Order_Line_Items","labelText":"Products to Order","wrapperStyle":"","labelStyle":"width: 50%; border-width: 0px; border-style: solid; border-color: rgb(0, 0, 0)","Label_Name":"Order","refFields":[{"valueStyle":"            ","fieldLayoutType":"2","labelText":"ID","labelStyle":"            ","Label_Name":"ID"},{"valueStyle":"            ","fieldLayoutType":"2","labelText":"Product","labelStyle":"            ","Label_Name":"Product"},{"valueStyle":"            ","fieldLayoutType":"2","labelText":"Qty","labelStyle":"            ","Label_Name":"Quantity"},{"valueStyle":"            ","fieldLayoutType":"2","labelText":"Unit Type","labelStyle":"            ","Label_Name":"Unit_Type"}],"labelTextStyle":"font-weight: bold"}}]},{"colElements":[{"type":"spacer","element":{"id":"u_elem_3948471","height":"35"}}]}]}},{"type":"columns","element":{"split":"5,90,5","id":"u_elem_39572595999999978","elemStyle":"","collayouts":[{"colElements":[{"type":"spacer","element":{"id":"u_elem_6377145999999642","height":"89"}}]},{"colElements":[{"type":"spacer","element":{"id":"u_elem_12693185","height":"35"}}]},{"colElements":[{"type":"spacer","element":{"id":"u_elem_6427853000000119","height":"89"}}]}]}},{"type":"columns","element":{"split":"5,90,5","id":"u_elem_4324426","elemStyle":"","collayouts":[{"colElements":[{"type":"spacer","element":{"id":"u_elem_1321579799999997","height":"71"}}]},{"colElements":[{"id":"u_elem_15923080780794899","type":"fields","element":{"valueStyle":"width: 50%","valueTextStyle":"","fieldLayoutType":"3","labelText":"Additional Notes","wrapperStyle":"","labelStyle":"width: 50%","Label_Name":"Additional_Notes","labelTextStyle":"font-weight: bold"}},{"type":"spacer","element":{"id":"u_elem_4324425800000001","height":"35"}}]},{"colElements":[{"type":"spacer","element":{"id":"u_elem_1326175399999991","height":"71"}}]}]}},{"type":"columns","element":{"split":"5,90,5","id":"u_elem_4388196300000001","elemStyle":"","collayouts":[{"colElements":[{"type":"spacer","element":{"id":"u_elem_1111175","height":"49"}}]},{"colElements":[{"id":"u_elem_15923080780812749","type":"fields","element":{"valueStyle":"width: 50%","valueTextStyle":"","fieldLayoutType":"3","labelText":"Collection Status","wrapperStyle":"","labelStyle":"width: 50%","Label_Name":"Collection_Status","labelTextStyle":"font-weight: bold"}}]},{"colElements":[{"type":"spacer","element":{"id":"u_elem_1358722299999997","height":"36"}}]}]}},{"type":"columns","element":{"split":"100","id":"u_elem_44541203999999985","elemStyle":"","collayouts":[{"colElements":[{"type":"spacer","element":{"id":"u_elem_4454120300000001","height":"45"}}]}]}},{"type":"columns","element":{"split":"5,45,45,5","id":"u_elem_4471262800000001","elemStyle":"","collayouts":[{"colElements":[{"type":"spacer","element":{"id":"u_elem_46010309999999404","height":"26"}}]},{"colElements":[{"type":"text","element":{"id":"u_elem_36389359999999404","fields":[],"content":"<div style=\"background: rgba(0, 0, 0, 0); padding: 0px\">\n   <p\n      style=\"color: rgb(0, 0, 0); font-weight: 400; font-style: normal; text-align: left\"><font\n    style=\"font-size: 16px\"><br /><\/font><\/p>\n   <p\n      style=\"color: rgb(0, 0, 0); font-weight: 400; font-style: normal; text-align: left\"><font\n    style=\"font-size: 16px\">--------------------------------------------<\/font><\/p>\n   <p\n      style=\"color: rgb(0, 0, 0); font-style: normal; text-align: left\"><span style=\"font-size: 16px; background-color: rgba(0, 0, 0, 0); letter-spacing: 0px\"><b>Warehouse Signature<\/b><\/span><\/p>\n  <\/div>"}}]},{"colElements":[{"type":"text","element":{"id":"u_elem_40569840000000596","fields":[],"content":"<div style=\"background: rgba(0, 0, 0, 0); padding: 0px\">\n   <p\n      style=\"color: rgb(0, 0, 0); font-weight: 400; font-style: normal; text-align: left\"><font\n    style=\"font-size: 16px\"><br /><\/font><\/p>\n   <p\n      style=\"color: rgb(0, 0, 0); font-weight: 400; font-style: normal; text-align: left\"><font\n    style=\"font-size: 16px\"><span> <span>--------------------------------------------<\/span> <\/span><br /><\/font><\/p>\n   <p\n      style=\"color: rgb(0, 0, 0); font-style: normal; text-align: left\"><font style=\"font-size: 16px\"><b>Date/Time Collected<\/b><\/font><\/p>\n  <\/div>"}}]},{"colElements":[{"type":"spacer","element":{"id":"u_elem_454876200000003","height":"26"}}]}]}}],"id":1}],"resize":"a4","themeFont":"lato","isHeaderEnabled":false}
				}
			}
		}
		form Stock_Takes
		{
			displayname = "Stock Take"
			success message = "Data Added Successfully!"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Stock_Take_Number
			(
    			type = text
				displayname = "Stock Take Number"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Stock_Take_Date
			(
    			type = date
				displayname = "Stock Take Date"
				initial value = "${zoho.currentdate}"
				alloweddays = 0,1,2,3,4,5,6
	 			row = 1
	 			column = 1   
				width = medium
			)
			Location
			(
				type = picklist	
				values  = Stock_Locations.ID
    			displayformat = [Location_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Status
			(
				type = picklist
				maxchar = 100
				values = {"Draft","In Progress","Pending Approval","Approved","Completed"}
				initial value = "Draft"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Created_By
			(
    			type = text
				displayname = "Created By"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Approved_By
			(
    			type = text
				displayname = "Approved By"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Approved_Date
			(
    			type = datetime
				displayname = "Approved Date"
				timedisplayoptions = "hh:mm:ss"
				alloweddays = 0,1,2,3,4,5,6
	 			row = 1
	 			column = 1   
				width = medium
			)
			Notes
			(
    			type = textarea
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
			Previous_Status
			(
    			type = text
				displayname = "Previous Status"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Stock_Take_Lines
			(
				type = grid
				displayname = "Stock Take Lines"
				values  = Stock_Take_Lines.ID
    			bidirectional = Stock_Take
	 			row = 2
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Stock_Take_Lines
		{
			displayname = "Stock Take Lines"
			success message = "Data Added Successfully!"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Stock_Take
			(
				type = picklist	
				values  = Stock_Takes.ID
    			bidirectional = Stock_Take_Lines
    			displayformat = [Stock_Take_Number]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Product
			(
				type = picklist	
				values  = Product_Master.ID
    			displayformat = [Product_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Bay_Location
			(
				type = picklist	
				displayname = "Bay Location"
				values  = Bay_Locations.ID
    			displayformat = [Bay_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
			Expected_Quantity
			(
				type = decimal
				displayname = "Expected Quantity"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Counted_Quantity
			(
				type = decimal
				displayname = "Counted Quantity"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Variance
			(
    			type = formula
				value =  input.Counted_Quantity - input.Expected_Quantity
				visibility = false
	 			row = 1
	 			column = 1   
				width = medium
			)
			Variance_Reason
			(
				type = picklist
				displayname = "Variance Reason"
				maxchar = 100
				values = {"Damaged","Missing","Found","Data Entry Error","Theft","Other"}
	 			row = 1
	 			column = 1   
				width = medium
			)
			Notes
			(
    			type = textarea
				height = 100px
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Stock_Transactions
		{
			displayname = "Stock Transactions"
			success message = "Stock Transaction Added Successfully"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Transaction_ID
			(
    			type = autonumber
				displayname = "Transaction ID"
				start index = 1
	 			row = 1
	 			column = 1   
				width = medium
			)
			Transaction_Number
			(
    			type = formula
				displayname = "Transaction Number "
				value =  "TXN-" + leftpad(toString(input.Transaction_ID),6).replaceAll(" ","0")
				visibility = false
				display type = text
				format = plaintext
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Transaction_Date
			(
    			type = datetime
				displayname = "Transaction Date"
				initial value = "${zoho.currenttime}"
				timedisplayoptions = "hh:mm:ss"
				alloweddays = 0,1,2,3,4,5,6
    			description
    			[
    				type = tooltip
    			 	message = "When this transaction occurred"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Transaction_Type
			(
				type = picklist
				displayname = "Transaction Type"
				maxchar = 100
				values = {"GRN_Receipt","Order_Issue","Adjustment_In","Adjustment_Out","Transfer_In","Transfer_Out","Return"}
    			description
    			[
    				type = tooltip
    			 	message = "Type of stock movement"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Product
			(
				type = picklist	
				values  = Product_Master.ID
    			displayformat = [Product_Name]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Product involved in this transaction"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Location
			(
				type = picklist	
				values  = Stock_Locations.ID
    			displayformat = [Location_Name]
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Stock location for this transaction"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			must have Quantity
			(
				type = decimal
    			description
    			[
    				type = tooltip
    			 	message = "Movement quantity (positive for IN, negative for OUT)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Balance_After
			(
				type = decimal
				displayname = "Balance After"
    			description
    			[
    				type = tooltip
    			 	message = "Stock level after this transaction"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Reference_Type
			(
				type = picklist
				displayname = "Reference Type"
				maxchar = 100
				values = {"GRN","Stock Order","Adjustment","Transfer"}
				sortorder = ascending
    			description
    			[
    				type = tooltip
    			 	message = "Type of source document"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Reference_ID
			(
				type = number
				displayname = "Reference ID"
    			description
    			[
    				type = tooltip
    			 	message = "ID of source record (GRN ID, Order ID, etc.)"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
			Notes
			(
    			type = textarea
				height = 100px
    			description
    			[
    				type = tooltip
    			 	message = "Additional comments or details"
    			]
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Stock_Adjustments
		{
			success message = "Data Added Successfully!"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Adjustment_Number
			(
    			type = text
				displayname = "Adjustment Number"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Adjustment_Date
			(
    			type = datetime
				displayname = "Adjustment Date"
				initial value = "${zoho.currenttime}"
				timedisplayoptions = "hh:mm:ss"
				alloweddays = 0,1,2,3,4,5,6
	 			row = 1
	 			column = 1   
				width = medium
			)
			Stock_Locations
			(
				type = picklist	
				displayname = "Stock Locations"
				values  = Stock_Locations.ID
    			displayformat = [Location_Name]
				sortorder = ascending
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
		form Update_Stock_Count
		{
			success message = "Data Added Successfully!"
			Section
			(
				type = section
	 			row = 1
	 			column = 0   
				width = medium
			)
			Line_ID
			(
    			type = text
				displayname = "Line ID"
	 			row = 1
	 			column = 1   
				width = medium
			)
			Counted
			(
    			type = text
	 			row = 1
	 			column = 1   
				width = medium
			)
	
			actions
			{
				on add
				{
					submit
					(
   						type = submit
   						displayname = "Submit"
					)
				}
				on edit
				{
					update
					(
   						type = submit
   						displayname = "Update"
					)
					cancel
					(
   						type = cancel
   						displayname = "Cancel"
					)
				}
			}
		}
	}
	reports
	{
		default list All_Suppliers
		{
			displayName = "All Product Suppliers"
			show all rows from Suppliers    
			(
				Supplier_Number as "Supplier Number"
				Supplier_Name as "Supplier Name"
				Contact_Person as "Contact Person"
				Email
				Phone_Number as "Phone"
				(
					displayformat = plainnumber 
					linktodial = enable
				)
				Address
				Payment_Terms as "Payment Terms"
				Notes
				Is_Active as "Is Active"
				Supplier_Code as "Supplier Code"
				Lead_Time_Days as "Lead Time Days"
				Account_Number as "Account Number"
				Supplier_Type as "Supplier Type"
			)
		}
		default list All_Product_Categories
		{
			displayName = "All Product Categories"
			show all rows from Product_Categories    
			(
				Category_Number as "Category Number"
				Category_Name as "Category Name"
				Parent_Category as "Parent Category"
				Is_Active as "Is Active"
				Sort_Order as "Sort Order"
			)
		}
		default list All_Product_Masters
		{
			displayName = "All Product Masters"
			show all rows from Product_Master    
			(
				Product_Number as "Product Number"
				Product_Name as "Product Name"
				Supplier
				Category
				Product_Type as "Product Type"
				Unit_Type as "Unit Type"
				Description
				SKU
				Is_Stocked as "Is Stocked"
				Reorder_Level as "Reorder Level"
				Associated_Products as "Associated Products"
				Product_Image as "Product Image"
				Notes
				External_Barcode as "External Barcode"
				QR_Code as "QR Code"
				Is_Active as "Is Active"
				Base_Rate as "Base Rate"
				Reorder_Quantity as "Reorder Quantity"
				Max_Stock_Level as "Max Stock Level"
				Lead_Time_Days as "Lead Time Days"
				Total_Stock_On_Hand as "Total Stock On Hand"
				Total_Available as "Total Available"
				Cost_Price as "Cost Price"
				Sell_Price as "Sell Price"
				Margin_Amount as "Margin Amount"
				Margin_Percent as "Margin Percent"
				Bay_Location as "Bay Location"
			)
		}
		default list All_Stock_Orders
		{
			displayName = "All Stock Orders"
			print template = Order_Docket
			show all rows from Stock_Ordering    
			(
				Order_Number_Auto as "Order Number Auto"
				Order_Number as "Order Number"
				Order_Date as "Order Date"
				(
					displayformat = dateonly
				)
				Sites_Reference as "Site / Project"
				Ordered_by_Employee as "Ordered By (Employee)"
				Ordered_by_Other as "Non Employee Name"
				Ordered_by_Display as "Ordered by Display"
				Collection_Date as "Collection Date"
				Collection_Status as "Collection Status"
				Additional_Notes as "Additional Notes"
				Order_Status as "Order Status"
				Submitted_Date as "Submitted Date"
				Approved_By as "Approved By"
				Approved_Date as "Approved Date"
				Docket_Generated as "Docket Generated"
				Docket_PDF
				Excel_Synced as "Excel Synced"
				Source_Location as "Source Location"
				Stock_Reserved as "Stock Reserved"
				(
						displaytrue = "Yes"
						displayfalse = "No"
				)
				Stock_Issued as "Stock Issued"
				Needs_Approval as "Needs Approval"
				Approval_Notes as "Approval Notes"
				Collection_Bay as "Collection Bay"
				Collected_DateTime as "Collected DateTime"
				Collected_By as "Collected By"
				Picking_Stage as "Picking Stage"
				Collection_Stage as "Collection Stage"
				Edit_Mode as "Edit Mode"
				Order_Month as "Order Month"
				Order_Total_Stored as "Order Total Stored"
				Site_Name_Stored as "Site Name Stored"
			)
			filters
			(
				Order_Status
				Sites_Reference
				Order_Date
			)
		}
		default list Order_Line_Items_Report
		{
			displayName = "All Order Line Items"
			show all rows from Order_Line_Items    
			(
				Product
				Product_Number as "Product Number"
				Unit_Type as "Unit Type"
				Line_Notes as "Line Notes"
				Is_Ancillary as "Is Ancillary"
				Line_Status as "Line Status"
				Quantity as "Qty"
				Order
				Quantity_Issued as "Quantity Issued"
				Quantity_Available as "Quantity Available"
				Stock_Warning as "Stock Warning"
				Is_Site_Product as "Is Site Product"
				Line_Total_Stored as "Line Total Stored"
			)
		}
		default list Site_Product_Catalog_Report
		{
			displayName = "All Site Product Catalogs"
			show all rows from Site_Product_Catalog    
			(
				Catalog_Number as "Catalog Number"
				Site
				Product
				Is_Standard as "Is Standard"
				Active
			)
		}
		default list All_Companies
		{
			displayName = "All Companies"
			show all rows from Companies    
			(
				Company_Name as "Company Name"
				Company_Type as "Company Type"
				Address 
	 			(
	      			displayformat = [address_line_1+""+address_line_2+""+district_city+""+state_province+""+postal_Code+""+country]
	      			enable = Link_to_Map,Show_As_Text
	 			)
				Google_Maps_Link as "Google Maps Link"
				Phone_Number as "Phone"
				(
					displayformat = plainnumber 
					linktodial = enable
				)
				Email
				Website
				Active
				Notes
			)
		}
		default list All_Company_Contacts
		{
			displayName = "All Company Contacts"
			show all rows from Company_Contacts    
			(
				Companies
				First_Name as "First Name"
				Last_Name as "Last Name"
				Full_Name as "Full Name"
				Job_Title as "Job Title"
				Phone_Number as "Phone"
				(
					displayformat = plainnumber 
					linktodial = enable
				)
				Mobile_Number as "Mobile Number"
				(
					displayformat = plainnumber 
					linktodial = enable
				)
				Email
				Is_Primary_Contact as "Is Primary Contact"
				Active
				Notes
			)
		}
		default list All_Product_Kits
		{
			displayName = "All Product Kits"
			show all rows from Product_Kits    
			(
				Kit_Name as "Kit Name"
				Kit_Description as "Kit Description"
				Product_Categories as "Product Categories"
				Active
				Notes
				Kit_Total as "Kit Total"
			)
		}
		default list All_Kit_Products
		{
			displayName = "All Kit Items"
			show all rows from Kit_Products    
			(
				Kit
				Product
				Default_Quantity as "Default Quantity"
				Sort_Order as "Sort Order"
				Notes
			)
		}
		default list All_Project_Proposals
		{
			displayName = "All Project Proposals"
			print template = Sales_Won_Form
			show all rows from Project_Proposals    
			(
				Project_Name as "Project Name"
				Address 
	 			(
	      			displayformat = [address_line_1+""+address_line_2+""+district_city+""+state_province+""+postal_Code+""+country]
	      			enable = Link_to_Map,Show_As_Text
	 			)
				Google_Maps_Link as "Google Maps Link"
				Estimated_Start_Date as "Estimated Start Date"
				Companies
				Company_Contacts as "Company Contacts"
				Proposal_Status as "Proposal Status"
				Category
				Sub_Category as "Sub Category"
				Submitted_Date as "Submitted Date"
				Approved_By as "Approved By"
				Approved_Date as "Approved Date"
				Notes
				Proposal_Number as "Proposal Number"
				Agreed_Price as "Agreed Price"
				Proposal_Date as "Proposal Date"
				Proposal_Currency as "Proposal Currency"
				Drawing_Attachment as "Drawing Attachment"
				Auto_Number as "Auto Number"
				Estimated_Start as "Estimated Start"
				custom action "View Proposal"
				(
	  			workflow = Open_Proposal_Preview
				show action in edit record menu = true
				column header = "View Proposal"
				)
				Procore_Project_ID as "Procore Project ID"
				Source_Kits as "Source Kits"
				Clear_All_Items as "Clear All Items"
			)
			filters
			(
				Proposal_Date
				Proposal_Status
				Companies
			)
			conditional formatting
			(
				"Draft"
				{
				condition = (Proposal_Status == "Draft")
				fields = [Proposal_Status]
				format = "font-weight:bold;background-color:#f3f3f3;"
				}
				"Approved"
				{
				condition = (Proposal_Status == "Approved")
				fields = [Proposal_Status]
				format = "font-weight:bold;background-color:#5dc35a;"
				}
				"Rejected"
				{
				condition = (Proposal_Status == "Rejected")
				fields = [Proposal_Status]
				format = "font-weight:bold;color:#ffffff;background-color:#ef1616;"
				}
				"Won"
				{
				condition = (Proposal_Status == "Won")
				fields = [Proposal_Status]
				format = "font-weight:bold;color:#ffffff;background-color:#337131;"
				}
				"Lost"
				{
				condition = (Proposal_Status == "Lost")
				fields = [Proposal_Status]
				format = "font-weight:bold;color:#ffffff;background-color:#ef8216;"
				}
			)
		}
		default list All_Proposal_Contacts
		{
			displayName = "All Proposal Contacts"
			show all rows from Proposal_Contacts    
			(
				Role
				Contact_Name as "Contact Name"
				Phone_Number as "Phone"
				(
					displayformat = plainnumber 
					linktodial = enable
				)
				Email
				Proposal
			)
		}
		default list All_Proposal_Work_Packages
		{
			displayName = "All Proposal Work Packages"
			show all rows from Proposal_Work_Packages    
			(
				Source_Kit as "Source Kit"
				Package_Name as "Package Name"
				Sort_Order as "Sort Order"
				Package_Total as "Package Total"
				Proposal
				Estimated_Total as "Estimated Total"
				Formula
			)
		}
		default list All_Proposal_Line_Items
		{
			displayName = "All Proposal Line Items"
			show all rows from Proposal_Line_Items    
			(
				Product
				Description
				Quantity
				Unit
				Rate
				Comment
				Sort_Order as "Sort Order"
				Line_Total as "Line Total"
				Work_Package as "Work Package"
				Proposal
			)
		}
		default list Proposal_Pricing_Report
		{
			displayName = "Proposal Pricing Report"
			show all rows from Proposal_Pricing    
			(
				Product
				Description
				Quantity
				Unit
				Rate
				Line_Total as "Line Total"
				Comment
				Sort_Order as "Sort Order"
				Package
			)
		}
		default list All_Parameters
		{
			displayName = "All Parameters"
			show all rows from Parameters    
			(
				Parameter_Name as "Parameter Name"
				Current_Proposal_ID as "Current Proposal ID"
				Debug_Log as "Debug Log"
				Workflow_Debug as "Workflow Debug"
				Bay_Assignment_Order_ID as "Bay Assignment Order ID "
				Bay_Assignment_Mode as "Bay Assignment Mode "
				Proposal_Order_Comparison_Report as "Proposal Order Comparison Report"
				Dynamic_Stock_Report as "Dynamic Stock Report"
				Dynamic_Order_Report as "Dynamic Order Report"
				Product_Trends_Report as "Product Trends Report"
				Products_By_Month_Chart as "Products By Month Chart"
				Products_By_Site_Chart as "Products By Site Chart"
				Products_By_Week_Chart as "Products By Week Chart"
				Current_Stock_Take_ID as "Current Stock Take ID"
				Current_Stock_Take_Line_ID as "Current Stock Take Line ID"
			)
		}
		default list All_Stock_Locations
		{
			displayName = "All Stock Locations"
			show all rows from Stock_Locations    
			(
				Location_Code as "Location Code"
				Location_Name as "Location Name"
				Location_Type as "Location Type"
				Sites_Reference as "Sites Reference"
				Address 
	 			(
	      			displayformat = [address_line_1+""+address_line_2+""+district_city+""+state_province+""+postal_Code+""+country]
	      			enable = Link_to_Map,Show_As_Text
	 			)
				Is_Default as " Is Default"
				Is_Active as "Is Active"
				Notes
			)
		}
		default list All_Stock_Levels
		{
			displayName = "All Stock Levels"
			show all rows from Stock_Levels    
			(
				Product
				Location
				Quantity_On_Hand as "Quantity On Hand"
				Quantity_Reserved as "Quantity Reserved"
				Quantity_Available as "Quantity Available"
				Quantity_On_Order as "Quantity On Order"
				Last_Count_Date as "Last Count Date"
				Last_Movement_Date as "Last Movement Date"
				Is_Low_Stock as "Is Low Stock"
				Stock_Value as "Stock Value"
				Stock_Value_Stored as "Stock Value Stored"
				Bay_Location as "Bay Location"
			)
		}
		default list All_Stock_Transactions
		{
			displayName = "All Stock Transactions"
			show all rows from Stock_Transactions    
			(
				Transaction_ID as "Transaction ID"
				Transaction_Number as "Transaction Number "
				Transaction_Date as "Transaction Date"
				Transaction_Type as "Transaction Type"
				Product
				Location
				Quantity
				Balance_After as "Balance After"
				Reference_Type as "Reference Type"
				Reference_ID as "Reference ID"
				Notes
			)
		}
		default list All_Purchase_Orders
		{
			displayName = "All Purchase Orders"
			show all rows from Purchase_Orders    
			(
				PO_ID as "PO ID"
				PO_Number as "PO Number"
				Supplier
				Order_Date as "Order Date"
				Expected_Delivery as "Expected Delivery"
				Delivery_Location as "Delivery Location"
				PO_Status as "PO Status"
				Total_Value as "Total Value"
				Raised_By as "Raised By"
				Notes
			)
		}
		default list PO_Line_Items_Report
		{
			displayName = "PO Line Items Report"
			show all rows from PO_Line_Items    
			(
				Purchase_Order as "Purchase Order"
				Product
				Quantity_Ordered as "Quantity Ordered"
				Quantity_Received as "Quantity Received"
				Quantity_Outstanding as "Quantity Outstanding"
				Unit_Price as "Unit Price"
				Line_Total as "Line Total"
				Line_Status as "Line Status"
				Line_Description as "Line Description"
			)
		}
		default list Goods_Receipt_Report
		{
			displayName = "Goods Receipt Report"
			show all rows from Goods_Receipt    
			(
				Purchase_Order as "Purchase Order"
				Suppliers as "Product Supplier"
				Receipt_Date as "Receipt Date"
				Receiving_Location as "Receiving Location"
				Delivery_Note_Ref as "Delivery Note Ref"
				GRN_Status as "GRN Status"
				Received_By as "Received By"
				Notes
				Stock_Updated as "Stock Updated"
				GRN_Number as "GRN Number"
			)
		}
		default list GRN_Line_Items_Report
		{
			displayName = "GRN Line Items Report"
			show all rows from GRN_Line_Items    
			(
				Goods_Receipt as "Goods Receipt"
				PO_Line
				Product
				Quantity_Expected as "Quantity Expected"
				Quantity_Received as "Quantity Received"
				Quantity_Rejected as "Quantity Rejected"
				Rejection_Reason as "Rejection Reason"
				Batch_Number as "Batch Number"
				Expiry_Date as "Expiry Date"
				Bay_Locations as "Bay Locations"
			)
		}
		list Orders_Pending_Approval
		{
			displayName = "Orders Pending Approval"
			show all rows from Stock_Ordering  [Order_Status == "Pending Approval"]  
			(
				Order_Number_Auto as "Order Number Auto"
				Order_Number as "Order Number"
				Sites_Reference as "Site / Project"
				Ordered_by_Employee as "Ordered By (Employee)"
				Ordered_by_Other as "Or Enter Name"
				Additional_Notes as "Additional Notes"
				Source_Location as "Source Location"
				Collection_Date as "Collection Date"
				Collection_Status as "Collection Status"
				Order_Date as "Order Date"
				Ordered_by_Display as "Ordered by Display"
				Order_Status as "Order Status"
				Stock_Reserved as "Stock Reserved"
				Stock_Issued as "Stock Issued"
				Submitted_Date as "Submitted Date"
				Needs_Approval as "Needs Approval"
				Approved_By as "Approved By"
				Approved_Date as "Approved Date"
				Approval_Notes as "Approval Notes"
				Docket_Generated as "Docket Generated"
				Docket_PDF
				Excel_Synced as "Excel Synced"
			)
		}
		list Stock_Levels_Report
		{
			displayName = "Stock Levels Report"
			show all rows from Stock_Levels    
			(
				Product
				Location
				Quantity_On_Hand as "Quantity On Hand"
				Quantity_Reserved as "Quantity Reserved"
				Quantity_Available as "Quantity Available"
				Quantity_On_Order as "Quantity On Order"
				Last_Count_Date as "Last Count Date"
				Last_Movement_Date as "Last Movement Date"
			)
		}
		list Low_Stock_Alert
		{
			displayName = "Low Stock Alert"
			show all rows from Stock_Levels  [Is_Low_Stock == 1]  
			(
				Product
				Location
				Quantity_On_Hand as "Quantity On Hand"
				Quantity_Reserved as "Quantity Reserved"
				Quantity_Available as "Quantity Available"
				Quantity_On_Order as "Quantity On Order"
				Last_Count_Date as "Last Count Date"
				Last_Movement_Date as "Last Movement Date"
				Product.Reorder_Level as "Reorder Level"
			)
		}
		list Stock_Transactions_Report
		{
			displayName = "Stock Transactions Report"
			show all rows from Stock_Transactions    
			(
				Transaction_ID as "Transaction ID"
				Transaction_Number as "Transaction Number "
				Transaction_Date as "Transaction Date"
				Transaction_Type as "Transaction Type"
				Product
				Location
				Quantity
				Balance_After as "Balance After"
				Reference_Type as "Reference Type"
				Reference_ID as "Reference ID"
				Notes
			)
			sort by
			(
				Transaction_Date descending
			)
		}
		list PO_Outstanding_Items
		{
			displayName = "PO Outstanding Items"
			show all rows from PO_Line_Items  [Line_Status == "Open" || Line_Status == "Partial"]  
			(
				Purchase_Order as "Purchase Order"
				Product
				Quantity_Ordered as "Quantity Ordered"
				Quantity_Received as "Quantity Received"
				Quantity_Outstanding as "Quantity Outstanding"
				Unit_Price as "Unit Price"
				Line_Total as "Line Total"
				Line_Status as "Line Status"
				Line_Description as "Line Description"
			)
		}
		list All_Purchase_Orders1
		{
			displayName = "All Purchase Orders"
			show all rows from Purchase_Orders    
			(
				PO_ID as "PO ID"
				PO_Number as "PO Number"
				Supplier
				Order_Date as "Order Date"
				Expected_Delivery as "Expected Delivery"
				Delivery_Location as "Delivery Location"
				PO_Status as "PO Status"
				Total_Value as "Total Value"
				Raised_By as "Raised By"
				Notes
			)
			sort by
			(
				Order_Date descending
			)
		}
		list All_Goods_Receipts
		{
			displayName = "All Goods Receipts"
			show all rows from Goods_Receipt    
			(
				GRN_Number as "GRN Number"
				Purchase_Order as "Purchase Order"
				Suppliers as "Product Supplier"
				Receipt_Date as "Receipt Date"
				Receiving_Location as "Receiving Location"
				Delivery_Note_Ref as "Delivery Note Ref"
				GRN_Status as "GRN Status"
				Received_By as "Received By"
				Notes
				Stock_Updated as "Stock Updated"
			)
			sort by
			(
				Receipt_Date descending
			)
		}
		list Stock_Valuation
		{
			displayName = "Stock Valuation"
			show all rows from Stock_Levels    
			(
				Product
				Location
				Quantity_On_Hand as "Quantity On Hand"
				Quantity_Reserved as "Quantity Reserved"
				Quantity_Available as "Quantity Available"
				Quantity_On_Order as "Quantity On Order"
				Last_Count_Date as "Last Count Date"
				Last_Movement_Date as "Last Movement Date"
				Is_Low_Stock as "Is Low Stock"
				Stock_Value as "Stock Value"
			)
		}
		list Orders_Pending_Approval1
		{
			displayName = "Orders Pending Approval"
			show all rows from Stock_Ordering  [Order_Status == "Pending Approval"]  
			(
				Order_Number_Auto as "Order Number Auto"
				Order_Number as "Order Number"
				Sites_Reference as "Site / Project"
				Ordered_by_Employee as "Ordered By (Employee)"
				Ordered_by_Other as "Or Enter Name"
				Additional_Notes as "Additional Notes"
				Source_Location as "Source Location"
				Collection_Date as "Collection Date"
				Collection_Status as "Collection Status"
				Order_Date as "Order Date"
				Order_Status as "Order Status"
				Ordered_by_Display as "Ordered by Display"
				Stock_Reserved as "Stock Reserved"
				Stock_Issued as "Stock Issued"
				Submitted_Date as "Submitted Date"
				Needs_Approval as "Needs Approval"
				Approved_By as "Approved By"
				Approved_Date as "Approved Date"
				Approval_Notes as "Approval Notes"
				Docket_Generated as "Docket Generated"
				Docket_PDF
				Excel_Synced as "Excel Synced"
			)
			sort by
			(
				Submitted_Date ascending
			)
		}
		kanban Kanban
		{
			displayName = "Warehouse Picking Board"
			show all rows from Stock_Ordering  [Order_Status == "Pending Approval" || Order_Status == "Awaiting Pick" || Order_Status == "Awaiting Collection"]  
			(
				Order_Number_Auto as "Order Number Auto"
				Order_Number as "Order Number"
				Sites_Reference as "Site / Project"
				Ordered_by_Employee as "Ordered By (Employee)"
				Ordered_by_Other as "Or Enter Name"
				Additional_Notes as "Additional Notes"
				Source_Location as "Source Location"
				Collection_Date as "Collection Date"
				Collection_Status as "Collection Status"
				Order_Date as "Order Date"
				Order_Status as "Order Status"
				Ordered_by_Display as "Ordered by Display"
				Stock_Reserved as "Stock Reserved"
				Stock_Issued as "Stock Issued"
				Submitted_Date as "Submitted Date"
				Needs_Approval as "Needs Approval"
				Approved_By as "Approved By"
				Approved_Date as "Approved Date"
				Approval_Notes as "Approval Notes"
				Docket_Generated as "Docket Generated"
				Docket_PDF
				Excel_Synced as "Excel Synced"
				Ordered_by_Employee.Phone_Number
				(
					displayformat = plainnumber 
					linktodial = enable
				)
				Ordered_by_Employee.System_Email_Address as "System Email Address"
				Ordered_by_Employee.G_Mail as "G-Mail"
			)
			options
			(
	 			display field = Order_Status
	 		)
		}
		default list All_Bay_Locations
		{
			displayName = "All Bay Locations"
			show all rows from Bay_Locations    
			(
				Bay_Name as "Bay Name"
				Stock_Locations as "Stock Locations"
				Capacity
				Active
				Notes
			)
		}
		kanban Warehouse_Picking_Board
		{
			displayName = "Warehouse Picking Board"
			show all rows from Stock_Ordering  [Picking_Stage is not null]  
			(
				Order_Number_Auto as "Order Number Auto"
				Order_Number as "Order Number"
				Sites_Reference as "Site / Project"
				Ordered_by_Employee as "Ordered By (Employee)"
				Ordered_by_Other as "Or Enter Name"
				Additional_Notes as "Additional Notes"
				Source_Location as "Source Location"
				Collection_Date as "Collection Date"
				Collection_Status as "Collection Status"
				Order_Date as "Order Date"
				Order_Status as "Order Status"
				Picking_Stage as "Picking Stage"
				Collection_Stage as "Collection Stage"
				Ordered_by_Display as "Ordered by Display"
				Stock_Reserved as "Stock Reserved"
				Stock_Issued as "Stock Issued"
				Submitted_Date as "Submitted Date"
				Needs_Approval as "Needs Approval"
				Approved_By as "Approved By"
				Approved_Date as "Approved Date"
				Approval_Notes as "Approval Notes"
				Collection_Bay as "Collection Bay"
				Collected_DateTime as "Collected DateTime"
				Collected_By as "Collected By"
				Docket_Generated as "Docket Generated"
				Docket_PDF
				Excel_Synced as "Excel Synced"
				Ordered_by_Employee.Added_Time as "Added Time"
				Sites_Reference.Site_Name
			)
			options
			(
	 			display field = Picking_Stage
	 			othercolumn = "Deleted & Others"
	 		)
		}
		kanban Order_Collection_Board
		{
			displayName = "Order Collection Board"
			show all rows from Stock_Ordering  [Collection_Stage is not null]  
			(
				Order_Number_Auto as "Order Number Auto"
				Order_Number as "Order Number"
				Sites_Reference as "Site / Project"
				Ordered_by_Employee as "Ordered By (Employee)"
				Ordered_by_Other as "Or Enter Name"
				Additional_Notes as "Additional Notes"
				Source_Location as "Source Location"
				Collection_Date as "Collection Date"
				Collection_Status as "Collection Status"
				Order_Date as "Order Date"
				Order_Status as "Order Status"
				Picking_Stage as "Picking Stage"
				Collection_Stage as "Collection Stage"
				Ordered_by_Display as "Ordered by Display"
				Stock_Reserved as "Stock Reserved"
				Stock_Issued as "Stock Issued"
				Submitted_Date as "Submitted Date"
				Needs_Approval as "Needs Approval"
				Approved_By as "Approved By"
				Approved_Date as "Approved Date"
				Approval_Notes as "Approval Notes"
				Collection_Bay as "Collection Bay"
				Collected_DateTime as "Collected DateTime"
				Collected_By as "Collected By"
				Docket_Generated as "Docket Generated"
				Docket_PDF
				Excel_Synced as "Excel Synced"
				Sites_Reference.Site_Name
				Collection_Bay.Bay_Name as "Bay Name"
			)
			options
			(
	 			display field = Collection_Stage
				record count  = enable
	 		)
		}
		default list Assign_Bay_Form_Report
		{
			displayName = "Assign_Bay_Form Report"
			show all rows from Assign_Bay_Form    
			(
				Order_ID as "Order ID"
				Bay_Locations as "Bay Locations"
			)
		}
		default list Assign_Bay_Form1_Report
		{
			displayName = "Assign_Bay_Form Report"
			show all rows from Assign_Bay_Form1    
		}
		default list Stock_Adjustments_Report
		{
			displayName = "Stock_Adjustments Report"
			show all rows from Stock_Adjustments    
			(
				Adjustment_Number as "Adjustment Number"
				Adjustment_Date as "Adjustment Date"
				Stock_Locations as "Stock Locations"
			)
		}
		default list Procore_Settings_Report
		{
			displayName = "Procore_Settings Report"
			show all rows from Procore_Settings    
			(
				Environment
				Client_ID as "Client ID"
				Client_Secret as "Client Secret"
				Company_ID as "Company ID"
				API_Base_URL as "API Base URL"
				Auth_URL as "Auth URL"
				Is_Active as "Is Active"
			)
		}
		default list Stock_Takes_Report
		{
			displayName = "Stock Take Report"
			show all rows from Stock_Takes    
			(
				Stock_Take_Number as "Stock Take Number"
				Stock_Take_Date as "Stock Take Date"
				Location
				Status
				Created_By as "Created By"
				Approved_By as "Approved By"
				Approved_Date as "Approved Date"
				Notes
				Previous_Status as "Previous Status"
			)
			custom actions
			(
				"Print Count Sheet"
				(
	  			workflow = Print_Count_Sheet
				show action in view header = true
				show action in edit record menu = true
				)
			)
		}
		default list Stock_Take_Lines_Report
		{
			displayName = "Stock Take Lines Report"
			show all rows from Stock_Take_Lines    
			(
				Product
				Expected_Quantity as "Expected Quantity"
				Counted_Quantity as "Counted Quantity"
				Variance
				Variance_Reason as "Variance Reason"
				Notes
				Stock_Take
				ID
				Bay_Location as "Bay Location"
			)
		}
		list Stock_Takes_List
		{
			displayName = "Stock_Takes_List"
			show all rows from Stock_Takes    
			(
				Stock_Take_Number as "Stock Take Number"
				Stock_Take_Date as "Stock Take Date"
				Location
				Status
				Created_By as "Created By"
				Approved_By as "Approved By"
				Approved_Date as "Approved Date"
				Notes
				Previous_Status as "Previous Status"
			)
		}
		default list Update_Stock_Count_Report
		{
			displayName = "Update_Stock_Count Report"
			show all rows from Update_Stock_Count    
			(
				Line_ID as "Line ID"
				Counted
			)
		}
		default list Quick_Count_Redirect_Report
		{
			displayName = "Quick_Count_Redirect Report"
			show all rows from Quick_Count_Redirect    
			(
				Line_ID as "Line ID"
			)
		}
		kanban Proposal_Status
		{
			displayName = "Proposal Status"
			show all rows from Project_Proposals    
			(
				Auto_Number as "Auto Number"
				Proposal_Number as "Proposal Number"
				Procore_Project_ID as "Procore Project ID"
				Project_Name as "Project Name"
				Address 
	 			(
	      			displayformat = [address_line_1+""+address_line_2+""+district_city+""+state_province+""+postal_Code+""+country]
	      			enable = Link_to_Map,Show_As_Text
	 			)
				Google_Maps_Link as "Google Maps Link"
				Estimated_Start as "Estimated Start"
				Estimated_Start_Date as "Estimated Start Date"
				Companies
				Company_Contacts as "Company Contacts"
				Proposal_Currency as "Proposal Currency"
				Agreed_Price as "Agreed Price"
				Proposal_Status as "Proposal Status"
				Category
				Sub_Category as "Sub Category"
				Drawing_Attachment as "Drawing Attachment"
				Submitted_Date as "Submitted Date"
				Approved_By as "Approved By"
				Approved_Date as "Approved Date"
				Notes
				Proposal_Date as "Proposal Date"
				Source_Kits as "Source Kits"
				Clear_All_Items as "Clear All Items"
			)
			options
			(
	 			display field = Proposal_Status
	 		)
		}
	}
	pages
	{
		page Ordering_Dashboard
		{
			displayname = "Ordering Dashboard"
			Content="<zml    \t\t\n\t\t\n\t\t\n\t\t\n\t\t\n>\n\t<layout>\n\t<row>\n\t<column\n   \t\t width='25%'\n   \t>\n\t<panel elementName='New Order'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n\t\tvAlign = 'middle'\n>\n\t<button \n\t\tmargin = '0px'\n\tpaddingTop = '10px'\n\tpaddingLeft = '20px'\n\tpaddingRight = '20px'\n\tpaddingBottom = '10px'\n\n    action = 'OpenForm'\n\t\tcomponentLinkName = 'Stock_Ordering'\n\t\ttarget = 'popup'\n\t\tpopupWidth = '1000px'\n\t  \tpopupHeight = '700px'\n\tcolor = '#FFFFFF'\n\tsize = '16px'\n    borderColor = '#FFFFFF'\n    borderWidth = '0px'\n\ttext ='Create New Order'\n\t\tbgColor = 'theme'\n\t\tcornerRadius = '10px' \n\/>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='15%'\n   \t>\n\t<panel elementName='Draft'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n>\n\t<pr \n\t\t\twidth='fill'\n\t\theight='50px'\n>\n\t<pc \n\t\tpadding = '0px'\n\tbgColor = '#BCE0C2'\n\n    borderColor = '#444444'\n    borderWidth = '0px'\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n    \tcornerRadius = '5px'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmarginLeft = '20px'\n\tmarginRight = '20px' \n\tmarginBottom = '0px'\n\tmarginTop = '0px'\n\tpadding = '0px'\n\tcolor = '#2D2D2D'\n\tsize = '16px'\n\ttype = 'Text'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '5px'\n\n\n\n\n\n    borderColor = '#2D2D2D'\n    borderWidth = '0px'\n\n\t  value = 'Draft'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr><pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmargin = '0px'\n\tpadding = '0px'\n\tcolor = '#FF4C2F'\n\tsize = '36px'\n\tbold = 'true' \n\ttype = 'Form Data'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\tdisplayType = 'actual'\n\tthousandsSeperator = 'LOCALE'\n\tdecimalSeperator = 'DOT'\n\tnumberScale = 'none'\n\n\n\n    borderColor = '#FF4C2F'\n    borderWidth = '0px'\n\n\t\tcriteria = 'Order_Status == &quot;Draft&quot;'\n\t  value = 'thisapp.Stock_Ordering.ID.count'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='15%'\n   \t>\n\t<panel elementName='Submitted'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n>\n\t<pr \n\t\t\twidth='fill'\n\t\theight='50px'\n>\n\t<pc \n\t\tpadding = '0px'\n\tbgColor = '#A0D6AA'\n\n    borderColor = '#444444'\n    borderWidth = '0px'\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n    \tcornerRadius = '0px'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmarginLeft = '20px'\n\tmarginRight = '20px' \n\tmarginBottom = '0px'\n\tmarginTop = '0px'\n\tpadding = '0px'\n\tcolor = '#2D2D2D'\n\tsize = '16px'\n\ttype = 'Text'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '5px'\n\n\n\n\n\n    borderColor = '#2D2D2D'\n    borderWidth = '0px'\n\n\t  value = 'Submitted'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr><pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmargin = '0px'\n\tpadding = '0px'\n\tcolor = '#FF4C2F'\n\tsize = '36px'\n\tbold = 'true' \n\ttype = 'Form Data'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '5px'\n\n\n\tdisplayType = 'actual'\n\tthousandsSeperator = 'LOCALE'\n\tdecimalSeperator = 'DOT'\n\tnumberScale = 'none'\n\n\n\n    borderColor = '#FF4C2F'\n    borderWidth = '0px'\n\n\t\tcriteria = 'Order_Status == &quot;Submitted&quot;'\n\t  value = 'thisapp.Stock_Ordering.ID.count'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='15%'\n   \t>\n\t<panel elementName='Approved'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n>\n\t<pr \n\t\t\twidth='fill'\n\t\theight='50px'\n>\n\t<pc \n\t\tpadding = '0px'\n\tbgColor = '#7CCB8D'\n\n    borderColor = '#444444'\n    borderWidth = '0px'\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n    \tcornerRadius = '0px'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmarginLeft = '20px'\n\tmarginRight = '20px' \n\tmarginBottom = '0px'\n\tmarginTop = '0px'\n\tpadding = '0px'\n\tcolor = '#2D2D2D'\n\tsize = '16px'\n\ttype = 'Text'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\n\n\n    borderColor = '#2D2D2D'\n    borderWidth = '0px'\n\n\t  value = 'Approved'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr><pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmargin = '0px'\n\tpadding = '0px'\n\tcolor = '#FF4C2F'\n\tsize = '36px'\n\tbold = 'true' \n\ttype = 'Form Data'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '5px'\n\n\n\tdisplayType = 'actual'\n\tthousandsSeperator = 'LOCALE'\n\tdecimalSeperator = 'DOT'\n\tnumberScale = 'none'\n\n\n\n    borderColor = '#FF4C2F'\n    borderWidth = '0px'\n\n\t\tcriteria = 'Order_Status == &quot;Approved&quot;'\n\t  value = 'thisapp.Stock_Ordering.ID.count'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='15%'\n   \t>\n\t<panel elementName='Picking'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n>\n\t<pr \n\t\t\twidth='fill'\n\t\theight='50px'\n>\n\t<pc \n\t\tpadding = '0px'\n\tbgColor = '#5AC374'\n\n    borderColor = '#444444'\n    borderWidth = '0px'\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n    \tcornerRadius = '0px'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmarginLeft = '20px'\n\tmarginRight = '20px' \n\tmarginBottom = '0px'\n\tmarginTop = '0px'\n\tpadding = '0px'\n\tcolor = '#2D2D2D'\n\tsize = '16px'\n\ttype = 'Text'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\n\n\n    borderColor = '#2D2D2D'\n    borderWidth = '0px'\n\n\t  value = 'Picking'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr><pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmargin = '0px'\n\tpadding = '0px'\n\tcolor = '#FF4C2F'\n\tsize = '36px'\n\tbold = 'true' \n\ttype = 'Form Data'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '5px'\n\n\n\tdisplayType = 'actual'\n\tthousandsSeperator = 'LOCALE'\n\tdecimalSeperator = 'DOT'\n\tnumberScale = 'none'\n\n\n\n    borderColor = '#FF4C2F'\n    borderWidth = '0px'\n\n\t\tcriteria = 'Order_Status == &quot;Approved&quot;'\n\t  value = 'thisapp.Stock_Ordering.ID.count'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='15%'\n   \t>\n\t<panel elementName='Ready'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n>\n\t<pr \n\t\t\twidth='fill'\n\t\theight='50px'\n>\n\t<pc \n\t\tpadding = '0px'\n\tbgColor = '#0ABB51'\n\n    borderColor = '#444444'\n    borderWidth = '0px'\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n    \tcornerRadius = '0px'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmarginLeft = '20px'\n\tmarginRight = '20px' \n\tmarginBottom = '0px'\n\tmarginTop = '0px'\n\tpadding = '0px'\n\tcolor = '#2D2D2D'\n\tsize = '16px'\n\ttype = 'Text'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\n\n\n    borderColor = '#2D2D2D'\n    borderWidth = '0px'\n\n\t  value = 'Ready'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr><pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmargin = '0px'\n\tpadding = '0px'\n\tcolor = '#FF4C2F'\n\tsize = '36px'\n\tbold = 'true' \n\ttype = 'Form Data'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '5px'\n\n\n\tdisplayType = 'actual'\n\tthousandsSeperator = 'LOCALE'\n\tdecimalSeperator = 'DOT'\n\tnumberScale = 'none'\n\n\n\n    borderColor = '#FF4C2F'\n    borderWidth = '0px'\n\n\t\tcriteria = 'Order_Status == &quot;Ready&quot;'\n\t  value = 'thisapp.Stock_Ordering.ID.count'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column>\n<\/row><row>\n\t<column\n   \t\t width='100%'\n   \t>\n\t<report \n\telementName='All Stock Orders Report'\n\n\t\tappLinkName = 'thisapp'\n\t\tlinkName = 'All_Stock_Orders'\n\t\tallowPublicAccess = 'true'\n\t\n\t\tiszreport = 'false'\n\t\t\t\t\tzc_AddRec = 'false'\n\t\t\t\t\tzc_EditRec = 'false'\n\t\t\t\t\tzc_DelRec = 'false'\n\t\t\t\t\tzc_DuplRec = 'false'\n\t\t\t\t\tzc_EditBulkRec = 'false'\n\t\t\t\t\tzc_BulkDelete = 'false'\n\t\t\t\t\tzc_BulkDuplicate = 'false'\n\theightType = 'auto'\n\theightValue = '700'\n\n\/>\n<\/column>\n<\/row>\n<\/layout>\n<\/zml>"
		}
		page Proposals_Dashboard
		{
			displayname = "Proposals"
			Content="<zml    \t\t\n\t\t\n\t\t\n\t\t\n\t\t\n>\n\t<layout>\n\t<row>\n\t<column\n   \t\t width='40%'\n   \t>\n\t<panel elementName='Create New Proposal Panel'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n\t\tvAlign = 'middle'\n>\n\t<button \n\t\tmargin = '0px'\n\tpaddingTop = '15px'\n\tpaddingLeft = '20px'\n\tpaddingRight = '20px'\n\tpaddingBottom = '15px'\n\n    action = 'OpenForm'\n\t\tcomponentLinkName = 'Project_Proposals'\n\t\ttarget = 'popup'\n\t\tpopupWidth = '1500px'\n\t  \tpopupHeight = '1500px'\n\tcolor = '#FFFFFF'\n\tsize = '16px'\n    borderColor = '#FFFFFF'\n    borderWidth = '0px'\n\ttext ='Create New Proposal'\n\t\tbgColor = 'theme'\n\t\tcornerRadius = '10px' \n\/>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='20%'\n   \t>\n\t<panel elementName='Panel'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n>\n\t<pr \n\t\t\twidth='fill'\n\t\theight='50px'\n>\n\t<pc \n\t\tpadding = '0px'\n\tbgColor = '#A0D6AA'\n\n    borderColor = '#444444'\n    borderWidth = '0px'\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n    \tcornerRadius = '0px'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmarginLeft = '20px'\n\tmarginRight = '20px' \n\tmarginBottom = '0px'\n\tmarginTop = '0px'\n\tpadding = '0px'\n\tcolor = '#2D2D2D'\n\tsize = '16px'\n\ttype = 'Text'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\n\n\n    borderColor = '#2D2D2D'\n    borderWidth = '0px'\n\n\t  value = 'Draft'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr><pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmargin = '0px'\n\tpadding = '0px'\n\tcolor = '#FF4C2F'\n\tsize = '36px'\n\tbold = 'true' \n\ttype = 'Form Data'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\tdisplayType = 'actual'\n\tthousandsSeperator = 'LOCALE'\n\tdecimalSeperator = 'DOT'\n\tnumberScale = 'none'\n\n\n\n    borderColor = '#FF4C2F'\n    borderWidth = '0px'\n\n\t\tcriteria = 'Proposal_Status == &quot;Draft&quot;'\n\t  value = 'thisapp.Project_Proposals.ID.count'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='20%'\n   \t>\n\t<panel elementName='Panel 3'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n>\n\t<pr \n\t\t\twidth='fill'\n\t\theight='50px'\n>\n\t<pc \n\t\tpadding = '0px'\n\tbgColor = '#5AC374'\n\n    borderColor = '#5AC374'\n    borderWidth = '0px'\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n    \tcornerRadius = '0px'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmarginLeft = '20px'\n\tmarginRight = '20px' \n\tmarginBottom = '0px'\n\tmarginTop = '0px'\n\tpadding = '0px'\n\tcolor = '#2D2D2D'\n\tsize = '16px'\n\ttype = 'Text'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\n\n\n    borderColor = '#2D2D2D'\n    borderWidth = '0px'\n\n\t  value = 'Approved'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr><pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmargin = '0px'\n\tpadding = '0px'\n\tcolor = '#FF4C2F'\n\tsize = '36px'\n\tbold = 'true' \n\ttype = 'Form Data'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\tdisplayType = 'actual'\n\tthousandsSeperator = 'LOCALE'\n\tdecimalSeperator = 'DOT'\n\tnumberScale = 'none'\n\n\n\n    borderColor = '#FF4C2F'\n    borderWidth = '0px'\n\n\t\tcriteria = 'Proposal_Status == &quot;Approved&quot;'\n\t  value = 'thisapp.Project_Proposals.ID.count'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='20%'\n   \t>\n\t<panel elementName='Panel 4'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n>\n\t<pr \n\t\t\twidth='fill'\n\t\theight='50px'\n>\n\t<pc \n\t\tpadding = '0px'\n\tbgColor = '#0ABB51'\n\n    borderColor = '#06943F'\n    borderWidth = '0px'\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n    \tcornerRadius = '0px'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmarginLeft = '20px'\n\tmarginRight = '20px' \n\tmarginBottom = '0px'\n\tmarginTop = '0px'\n\tpadding = '0px'\n\tcolor = '#2D2D2D'\n\tsize = '16px'\n\ttype = 'Text'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\n\n\n    borderColor = '#2D2D2D'\n    borderWidth = '0px'\n\n\t  value = 'Won'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr><pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmargin = '0px'\n\tpadding = '0px'\n\tcolor = '#FF4C2F'\n\tsize = '36px'\n\tbold = 'true' \n\ttype = 'Form Data'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\tdisplayType = 'actual'\n\tthousandsSeperator = 'LOCALE'\n\tdecimalSeperator = 'DOT'\n\tnumberScale = 'none'\n\n\n\n    borderColor = '#FF4C2F'\n    borderWidth = '0px'\n\n\t\tcriteria = 'Proposal_Status == &quot;Won&quot;'\n\t  value = 'thisapp.Project_Proposals.ID.count'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column>\n<\/row><row>\n\t<column\n   \t\t width='100%'\n   \t>\n\t<panel elementName='Panel 5'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\tpadding = '5px'\n\n>\n\t<pr \n\t>\n\t<pc \n\t\n>\n\t<image  \n\t\tmargin = '0px'\n\n    borderColor = '#FFFFFF'\n    borderWidth = '0px'\n\tcolor = '#FFFFFF'\n\tbgColor = '#5AC374'\n\twidth = '52px'\n\theight = '52px'\n\ttype = 'icon'\n\tvalue = 'business-round-euro'\n\tsize = '32px'\n\tcornerRadius = '26px'\n\ticonType = 'outline'\n\/>\n<\/pc>\n<\/pr><pr \n\t>\n\t<pc \n\t\n>\n\t<text \n\n\tmarginLeft = '0px'\n\tmarginRight = '0px' \n\tmarginBottom = '0px'\n\tmarginTop = '3px'\n\tpadding = '0px'\n\tcolor = '#0ABB51'\n\tsize = '36px'\n\tbold = 'true' \n\ttype = 'Form Data'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\tdisplayType = 'actual'\n\tdecimalPlaces = '2'\n\tthousandsSeperator = 'COMMA'\n\tdecimalSeperator = 'DOT'\n\tnumberScale = 'none'\n\n\n\n    borderColor = '#0ABB51'\n    borderWidth = '0px'\n\n\t\tcriteria = 'Proposal_Status != &quot;Rejected&quot; &amp;&amp; Proposal_Status != &quot;Won&quot; &amp;&amp; Proposal_Status != &quot;Lost&quot;'\n\t  value = 'thisapp.Project_Proposals.Agreed_Price.sum'\n>\n<\/text>\n\n<\/pc>\n<\/pr><pr \n\t>\n\t<pc \n\t\n>\n\t<text \n\n\tmarginLeft = '0px'\n\tmarginRight = '0px' \n\tmarginBottom = '0px'\n\tmarginTop = '3px'\n\tpadding = '0px'\n\tcolor = '#333333'\n\tsize = '16px'\n\ttype = 'Text'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\n\n\n    borderColor = '#333333'\n    borderWidth = '0px'\n\n\t  value = 'Pipeline Value'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column>\n<\/row><row>\n\t<column\n   \t\t width='100%'\n   \t>\n\t<report \n\telementName='Report'\n\n\t\tappLinkName = 'thisapp'\n\t\tlinkName = 'All_Project_Proposals'\n\t\tallowPublicAccess = 'true'\n\t\n\t\tiszreport = 'false'\n\t\t\t\t\tzc_AddRec = 'false'\n\t\t\t\t\tzc_EditRec = 'false'\n\t\t\t\t\tzc_Print = 'false'\n\t\t\t\t\tzc_DelRec = 'false'\n\t\t\t\t\tzc_DuplRec = 'false'\n\t\t\t\t\tzc_EditBulkRec = 'false'\n\t\t\t\t\tzc_BulkDelete = 'false'\n\t\t\t\t\tzc_BulkDuplicate = 'false'\n\theightType = 'auto'\n\theightValue = '700'\n\n\/>\n<\/column>\n<\/row><row>\n\t<column\n   \t\t width='86%'\n   \t>\n\t<report \n\telementName='Report 1'\n\n\t\tappLinkName = 'thisapp'\n\t\tlinkName = 'Proposal_Status'\n\t\n\t\tiszreport = 'false'\n\theightType = 'auto'\n\theightValue = '700'\n\n\/>\n<\/column><column\n   \t\t width='14%'\n   \t>\n\t<panel elementName='Panel 1'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n\t\tvAlign = 'middle'\n>\n\t<button \n\t\tmargin = '0px'\n\tpaddingTop = '12px'\n\tpaddingLeft = '15px'\n\tpaddingRight = '15px'\n\tpaddingBottom = '12px'\n\n    action = 'OpenURL'\n\t\turl = 'https:\/\/sandbox.procore.com\/4279460\/company\/home\/list' \n\t\ttarget = 'popup'\n\t\tpopupWidth = '1500px'\n\t  \tpopupHeight = '1500px'\n\tcolor = '#FFFFFF'\n\tsize = '16px'\n    borderColor = '#FFFFFF'\n    borderWidth = '0px'\n\ttext ='Procore'\n\t\tbgColor = 'theme'\n\t\tcornerRadius = '60px' \n\/>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column>\n<\/row>\n<\/layout>\n<\/zml>"
		}
		page View_Proposal
		{
			displayname = "View_Proposal"
			Content="<zml    \t\t\n\t\t\tisPrintEnabled='true'\n\t\t\n\t\t\n\t\t\n\t\t\n>\n\t<layout>\n\t<row>\n\t<column\n   \t\t width='100%'\n   \t>\n\t<dsp id='html_snippet' elementName='HTML Snippet'\n bgColor=\"#FFFFFF\" \n>\n\t<![CDATA[htmlpage html_snippet()\ncontent\n&lt;%{\n\t\/\/ Get proposal ID from Parameters\n\tparams = Parameters[ID != 0];\n\tproposalID = params.Current_Proposal_ID;\n\t\/\/ Fetch the proposal record\n\tproposal = Project_Proposals[ID == proposalID];\n\tif(proposal.count() == 0)\n\t{\n\t\thtmlContent = &quot;&lt;p&gt;Proposal not found&lt;\/p&gt;&quot;;\n\t}\n\telse\n\t{\n\t\t\/\/ Fetch lookup values\n\t\tcompanyRec = Companies[ID == proposal.Companies];\n\t\tcompanyName = ifnull(companyRec.Company_Name,&quot;&quot;);\n\t\tcontactRec = Company_Contacts[ID == proposal.Company_Contacts];\n\t\tcontactName = ifnull(contactRec.Full_Name,&quot;&quot;);\n\t\tcontactEmail = ifnull(contactRec.Email,&quot;&quot;);\n\t\t\/\/ Handle null values\n\t\tagreedPrice = ifnull(proposal.Agreed_Price,0);\n\t\tprojectName = ifnull(proposal.Project_Name,&quot;&quot;);\n\t\taddress = ifnull(proposal.Address,&quot;&quot;);\n\t\tproposalDate = ifnull(proposal.Proposal_Date,&quot;&quot;);\n\t\tstartDate = ifnull(proposal.Estimated_Start_Date,&quot;TBC&quot;);\n\t\tgoogleMapsLink = ifnull(proposal.Google_Maps_Link,&quot;&quot;);\n\t\t\/\/ Logo URL\n\t\tlogoUrl = &quot;https:\/\/creator.zoho.eu\/appbuilder\/quantumbuild1\/rascor-stock-management\/downLoadImage?imgFileId=5647446000000023086&amp;imgFileName=1764016384124_Rascor-Logo.png&quot;;\n\t\t\/\/ ============ PAGE 1: HEADER ============\n\t\thtmlContent = &quot;&lt;div style=&apos;font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto;&apos;&gt;&quot;;\n\t\t\/\/ Logo\n\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;text-align: right; margin-bottom: 20px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;img src=&apos;&quot; + logoUrl + &quot;&apos; alt=&apos;RASCOR&apos; style=&apos;height: 60px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&quot;;\n\t\t\/\/ Title\n\t\thtmlContent = htmlContent + &quot;&lt;h1 style=&apos;text-align: center; color: #333; font-size: 24px; margin-bottom: 30px;&apos;&gt;SALES WON FORM&lt;\/h1&gt;&quot;;\n\t\t\/\/ Project Details Table\n\t\thtmlContent = htmlContent + &quot;&lt;table style=&apos;width: 100%; border-collapse: collapse; margin-bottom: 30px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;tr&gt;&lt;td style=&apos;padding: 10px; font-weight: bold; width: 200px; border: 1px solid #ccc;&apos;&gt;Project Number&lt;\/td&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 10px; text-align: center; border: 1px solid #ccc;&apos;&gt;&quot; + proposal.Proposal_Number + &quot;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;tr&gt;&lt;td style=&apos;padding: 10px; font-weight: bold; border: 1px solid #ccc;&apos;&gt;Project Name&lt;\/td&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 10px; text-align: center; border: 1px solid #ccc;&apos;&gt;&quot; + projectName + &quot;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;tr&gt;&lt;td style=&apos;padding: 10px; font-weight: bold; border: 1px solid #ccc;&apos;&gt;Project Address&lt;\/td&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 10px; text-align: center; border: 1px solid #ccc;&apos;&gt;&quot; + address + &quot;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;tr&gt;&lt;td style=&apos;padding: 10px; font-weight: bold; border: 1px solid #ccc;&apos;&gt;Eircode \/ Post Code&lt;\/td&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 10px; text-align: center; border: 1px solid #ccc;&apos;&gt;&lt;a href=&apos;&quot; + googleMapsLink + &quot;&apos;&gt;&quot; + googleMapsLink + &quot;&lt;\/a&gt;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;tr&gt;&lt;td style=&apos;padding: 10px; font-weight: bold; border: 1px solid #ccc;&apos;&gt;Estimated Start Date&lt;\/td&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 10px; text-align: center; border: 1px solid #ccc;&apos;&gt;&quot; + startDate + &quot;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;tr&gt;&lt;td style=&apos;padding: 10px; font-weight: bold; border: 1px solid #ccc;&apos;&gt;Contractor&lt;\/td&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 10px; text-align: center; border: 1px solid #ccc;&apos;&gt;&lt;strong style=&apos;color: #7030A0;&apos;&gt;&quot; + companyName + &quot;&lt;\/strong&gt;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;tr&gt;&lt;td style=&apos;padding: 10px; font-weight: bold; border: 1px solid #ccc;&apos;&gt;Contractor Sales Contact&lt;\/td&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 10px; text-align: center; border: 1px solid #ccc;&apos;&gt;&lt;strong style=&apos;color: #7030A0;&apos;&gt;&quot; + contactName + &quot;&lt;\/strong&gt;&lt;br&gt;&quot; + contactEmail + &quot;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;tr&gt;&lt;td style=&apos;padding: 10px; font-weight: bold; color: #7030A0; border: 1px solid #ccc;&apos;&gt;Agreed Price&lt;\/td&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 10px; text-align: center; font-weight: bold; color: #7030A0; font-size: 18px; border: 1px solid #ccc;&apos;&gt;\u20AC&quot; + agreedPrice + &quot;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/table&gt;&quot;;\n\t\t\/\/ ============ PROJECT CONTACTS ============\n\t\thtmlContent = htmlContent + &quot;&lt;h2 style=&apos;text-align: center; color: #333; margin: 30px 0 15px;&apos;&gt;PROJECT CONTACTS&lt;\/h2&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;table style=&apos;width: 100%; border-collapse: collapse; margin-bottom: 30px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;tr style=&apos;background-color: #f0f0f0;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 10px; border: 1px solid #ccc; width: 150px;&apos;&gt;&lt;\/th&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 10px; border: 1px solid #ccc;&apos;&gt;Name&lt;\/th&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 10px; border: 1px solid #ccc;&apos;&gt;Tel.&lt;\/th&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 10px; border: 1px solid #ccc;&apos;&gt;Email&lt;\/th&gt;&lt;\/tr&gt;&quot;;\n\t\tfor each  contact in proposal.Project_Contacts\n\t\t{\n\t\t\troleName = ifnull(contact.Role,&quot;&quot;);\n\t\t\tcName = ifnull(contact.Contact_Name,&quot;&quot;);\n\t\t\tcEmail = ifnull(contact.Email,&quot;&quot;);\n\t\t\tcPhone = ifnull(contact.Phone_Number,&quot;&quot;);\n\t\t\thtmlContent = htmlContent + &quot;&lt;tr&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 10px; font-weight: bold; font-style: italic; border: 1px solid #ccc;&apos;&gt;&quot; + roleName + &quot;&lt;\/td&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 10px; text-align: center; border: 1px solid #ccc;&apos;&gt;&quot; + cName + &quot;&lt;\/td&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 10px; text-align: center; border: 1px solid #ccc;&apos;&gt;&quot; + cPhone + &quot;&lt;\/td&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 10px; text-align: center; border: 1px solid #ccc;&apos;&gt;&quot; + cEmail + &quot;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\t}\n\t\thtmlContent = htmlContent + &quot;&lt;\/table&gt;&quot;;\n\t\t\/\/ Note about pricing\n\t\thtmlContent = htmlContent + &quot;&lt;p style=&apos;text-align: center; font-style: italic;&apos;&gt;For Products, Quantities &amp; Location of works&lt;br&gt;Please See the Drawings &amp; Pricing Sheets Below&lt;\/p&gt;&quot;;\n\t\t\/\/ ============ PAGE 2: PRICING SHEET ============\n\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;page-break-before: always; margin-top: 40px;&apos;&gt;&lt;\/div&gt;&quot;;\n\t\t\/\/ Logo again\n\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;text-align: right; margin-bottom: 10px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;img src=&apos;&quot; + logoUrl + &quot;&apos; alt=&apos;RASCOR&apos; style=&apos;height: 60px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&quot;;\n\t\t\/\/ Project header bar\n\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;background: linear-gradient(to right, #7030A0, #9950C0); color: white; padding: 15px; font-size: 18px; font-weight: bold; margin-bottom: 20px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + projectName + &quot; - &quot; + proposal.Proposal_Number;\n\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&quot;;\n\t\t\/\/ Sub-header info\n\t\thtmlContent = htmlContent + &quot;&lt;table style=&apos;width: 100%; margin-bottom: 20px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Project:&lt;\/strong&gt; &quot; + projectName + &quot;&lt;\/td&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;text-align: right;&apos;&gt;&lt;strong style=&apos;text-decoration: underline;&apos;&gt;Waterproofing&lt;\/strong&gt;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Date:&lt;\/strong&gt; &quot; + proposalDate + &quot;&lt;\/td&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;text-align: right;&apos;&gt;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/table&gt;&quot;;\n\t\t\/\/ ============ LINE ITEMS (Direct - no Work Packages) ============\n\t\t\/\/ Pricing table header\n\t\thtmlContent = htmlContent + &quot;&lt;table style=&apos;width: 100%; border-collapse: collapse;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;tr style=&apos;background-color: #f0f0f0;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 8px; border: 1px solid #ccc; text-align: left; width: 60px;&apos;&gt;Code&lt;\/th&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 8px; border: 1px solid #ccc; text-align: left; color: #7030A0;&apos;&gt;Description&lt;\/th&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 8px; border: 1px solid #ccc; width: 70px;&apos;&gt;Quantity&lt;\/th&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 8px; border: 1px solid #ccc; width: 50px;&apos;&gt;Unit&lt;\/th&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 8px; border: 1px solid #ccc; background-color: #7030A0; color: white; width: 70px;&apos;&gt;Rate&lt;\/th&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 8px; border: 1px solid #ccc; background-color: #7030A0; color: white; width: 80px;&apos;&gt;Total&lt;\/th&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 8px; border: 1px solid #ccc; background-color: #7030A0; color: white; width: 80px;&apos;&gt;Comment&lt;\/th&gt;&lt;\/tr&gt;&quot;;\n\t\t\/\/ Get ALL Line Items for this Proposal directly\n\t\tlineItems = Proposal_Line_Items[Proposal == proposalID];\n\t\tfor each  item in lineItems\n\t\t{\n\t\t\tproductName = ifnull(item.Description,&quot;&quot;);\n\t\t\tif(productName == &quot;&quot; &amp;&amp; item.Product != null)\n\t\t\t{\n\t\t\t\tproductRec = Product_Master[ID == item.Product];\n\t\t\t\tproductName = ifnull(productRec.Product_Name,&quot;&quot;);\n\t\t\t}\n\t\t\tqty = ifnull(item.Quantity,&quot;&quot;);\n\t\t\tunit = ifnull(item.Unit,&quot;&quot;);\n\t\t\trate = ifnull(item.Rate,&quot;&quot;);\n\t\t\tlineTotal = ifnull(item.Line_Total,&quot;&quot;);\n\t\t\tcomment = ifnull(item.Comment,&quot;&quot;);\n\t\t\thtmlContent = htmlContent + &quot;&lt;tr&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 6px; border: 1px solid #ccc;&apos;&gt;&lt;\/td&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 6px; border: 1px solid #ccc;&apos;&gt;&quot; + productName + &quot;&lt;\/td&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 6px; border: 1px solid #ccc; text-align: center;&apos;&gt;&quot; + qty + &quot;&lt;\/td&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 6px; border: 1px solid #ccc; text-align: center;&apos;&gt;&quot; + unit + &quot;&lt;\/td&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 6px; border: 1px solid #ccc; text-align: right;&apos;&gt;\u20AC &quot; + rate + &quot;&lt;\/td&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 6px; border: 1px solid #ccc; text-align: right;&apos;&gt;\u20AC &quot; + lineTotal + &quot;&lt;\/td&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 6px; border: 1px solid #ccc;&apos;&gt;&quot; + comment + &quot;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\t}\n\t\t\/\/ Total row\n\t\thtmlContent = htmlContent + &quot;&lt;tr style=&apos;background-color: #f0f0f0; font-weight: bold;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;td colspan=&apos;5&apos; style=&apos;padding: 10px; border: 1px solid #ccc; color: #7030A0;&apos;&gt;Total:&lt;\/td&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 10px; border: 1px solid #ccc; text-align: right; color: #7030A0;&apos;&gt;\u20AC &quot; + agreedPrice + &quot;&lt;\/td&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 10px; border: 1px solid #ccc;&apos;&gt;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/table&gt;&quot;;\n\t\t\/\/ ============ PAGE 3: DRAWING ============\n\t\tdrawingUrl = ifnull(proposal.Drawing_Attachment,&quot;&quot;);\n\t\tif(drawingUrl != &quot;&quot;)\n\t\t{\n\t\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;page-break-before: always; margin-top: 40px;&apos;&gt;&lt;\/div&gt;&quot;;\n\t\t\t\/\/ Logo\n\t\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;text-align: right; margin-bottom: 20px;&apos;&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;img src=&apos;&quot; + logoUrl + &quot;&apos; alt=&apos;RASCOR&apos; style=&apos;height: 60px;&apos;&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&quot;;\n\t\t\t\/\/ Drawing\n\t\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;text-align: center;&apos;&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;img src=&apos;&quot; + drawingUrl + &quot;&apos; style=&apos;max-width: 100%; border: 1px solid #ccc;&apos;&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&quot;;\n\t\t}\n\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&quot;;\n\t}\n\t%&gt;\n&lt;%=htmlContent%&gt;\n&lt;%\n\n}%&gt;]]>\n<\/dsp>\n<\/column>\n<\/row>\n<\/layout>\n<\/zml>"
		}
		page Inventory_Dashboard
		{
			displayname = "Stock Dashboard"
			Content="<zml    \t\t\n\t\t\n\t\t\n\t\t\n\t\t\n>\n\t<layout>\n\t<row>\n\t<column\n   \t\t width='15%'\n   \t>\n\t<panel elementName='Create Purchase Order Panel'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpaddingTop = '0px'\n\tpaddingLeft = '0px'\n\tpaddingRight = '0px'\n\tpaddingBottom = '5px'\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n\t\tvAlign = 'middle'\n>\n\t<button \n\t\tmargin = '0px'\n\tpaddingTop = '15px'\n\tpaddingLeft = '20px'\n\tpaddingRight = '20px'\n\tpaddingBottom = '15px'\n\n    action = 'OpenForm'\n\t\tcomponentLinkName = 'Purchase_Orders'\n\t\ttarget = 'popup'\n\t\tpopupWidth = '1200px'\n\t  \tpopupHeight = '1000px'\n\tcolor = '#FFFFFF'\n\tsize = '16px'\n    borderColor = '#FFFFFF'\n    borderWidth = '0px'\n\ttext ='Create Purchase Order'\n\t\tbgColor = 'theme'\n\t\tcornerRadius = '10px' \n\/>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='15%'\n   \t>\n\t<panel elementName='Create Goods Receipt Panel'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpaddingTop = '0px'\n\tpaddingLeft = '0px'\n\tpaddingRight = '0px'\n\tpaddingBottom = '5px'\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n\t\tvAlign = 'middle'\n>\n\t<button \n\t\tmargin = '0px'\n\tpaddingTop = '15px'\n\tpaddingLeft = '20px'\n\tpaddingRight = '20px'\n\tpaddingBottom = '15px'\n\n    action = 'OpenForm'\n\t\tcomponentLinkName = 'Goods_Receipt'\n\t\ttarget = 'popup'\n\t\tpopupWidth = '1200px'\n\t  \tpopupHeight = '1000px'\n\tcolor = '#FFFFFF'\n\tsize = '16px'\n    borderColor = '#FFFFFF'\n    borderWidth = '0px'\n\ttext ='Create Goods Receipt'\n\t\tbgColor = 'theme'\n\t\tcornerRadius = '10px' \n\/>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='15%'\n   \t>\n\t<panel elementName='Panel 4'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpaddingTop = '0px'\n\tpaddingLeft = '0px'\n\tpaddingRight = '0px'\n\tpaddingBottom = '5px'\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n\t\tvAlign = 'middle'\n>\n\t<button \n\t\tmargin = '0px'\n\tpaddingTop = '15px'\n\tpaddingLeft = '20px'\n\tpaddingRight = '20px'\n\tpaddingBottom = '15px'\n\n    action = 'ExecuteFunction'\n\n\t\tfunctionName = 'fn_RunStockReport'  \n\tcolor = '#FFFFFF'\n\tsize = '16px'\n    borderColor = '#FFFFFF'\n    borderWidth = '0px'\n\ttext ='Stock Report'\n\t\tbgColor = 'theme'\n\t\tcornerRadius = '10px' \n\/>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='12%'\n   \t>\n\t<panel elementName='Panel'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n>\n\t<pr \n\t\t\twidth='fill'\n\t\theight='50px'\n>\n\t<pc \n\t\tpadding = '0px'\n\tbgColor = '#FFCDBC'\n\n    borderColor = '#444444'\n    borderWidth = '0px'\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n    \tcornerRadius = '0px'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmarginLeft = '20px'\n\tmarginRight = '20px' \n\tmarginBottom = '0px'\n\tmarginTop = '0px'\n\tpadding = '0px'\n\tcolor = '#2D2D2D'\n\tsize = '16px'\n\ttype = 'Text'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\n\n\n    borderColor = '#2D2D2D'\n    borderWidth = '0px'\n\n\t  value = 'Low Stock Items'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr><pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmargin = '0px'\n\tpadding = '0px'\n\tcolor = '#FF4C2F'\n\tsize = '36px'\n\tbold = 'true' \n\ttype = 'Form Data'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\tdisplayType = 'actual'\n\tthousandsSeperator = 'LOCALE'\n\tdecimalSeperator = 'DOT'\n\tnumberScale = 'none'\n\n\n\n    borderColor = '#FF4C2F'\n    borderWidth = '0px'\n\n\t\tcriteria = 'Is_Low_Stock == 1'\n\t  value = 'thisapp.Stock_Levels.ID.count'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='12%'\n   \t>\n\t<panel elementName='Panel 1'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n>\n\t<pr \n\t\t\twidth='fill'\n\t\theight='50px'\n>\n\t<pc \n\t\tpadding = '0px'\n\tbgColor = '#BDC9F3'\n\n    borderColor = '#BDC9F3'\n    borderWidth = '0px'\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n    \tcornerRadius = '0px'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmarginLeft = '20px'\n\tmarginRight = '20px' \n\tmarginBottom = '0px'\n\tmarginTop = '0px'\n\tpadding = '0px'\n\tcolor = '#2D2D2D'\n\tsize = '16px'\n\ttype = 'Text'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\n\n\n    borderColor = '#2D2D2D'\n    borderWidth = '0px'\n\n\t  value = 'Orders Pending Approval'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr><pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmargin = '0px'\n\tpadding = '0px'\n\tcolor = '#FF4C2F'\n\tsize = '36px'\n\tbold = 'true' \n\ttype = 'Form Data'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\tdisplayType = 'actual'\n\tthousandsSeperator = 'LOCALE'\n\tdecimalSeperator = 'DOT'\n\tnumberScale = 'none'\n\n\n\n    borderColor = '#FF4C2F'\n    borderWidth = '0px'\n\n\t\tcriteria = 'Order_Status == &quot;Pending Approval&quot;'\n\t  value = 'thisapp.Stock_Ordering.ID.count'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='12%'\n   \t>\n\t<panel elementName='Panel 2'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n>\n\t<pr \n\t\t\twidth='fill'\n\t\theight='50px'\n>\n\t<pc \n\t\tpadding = '0px'\n\tbgColor = '#FFBCC1'\n\n    borderColor = '#444444'\n    borderWidth = '0px'\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n    \tcornerRadius = '0px'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmarginLeft = '20px'\n\tmarginRight = '20px' \n\tmarginBottom = '0px'\n\tmarginTop = '0px'\n\tpadding = '0px'\n\tcolor = '#2D2D2D'\n\tsize = '16px'\n\ttype = 'Text'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\n\n\n    borderColor = '#2D2D2D'\n    borderWidth = '0px'\n\n\t  value = 'Open POs'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr><pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmargin = '0px'\n\tpadding = '0px'\n\tcolor = '#FF4C2F'\n\tsize = '36px'\n\tbold = 'true' \n\ttype = 'Form Data'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\tdisplayType = 'actual'\n\tthousandsSeperator = 'LOCALE'\n\tdecimalSeperator = 'DOT'\n\tnumberScale = 'none'\n\n\n\n    borderColor = '#FF4C2F'\n    borderWidth = '0px'\n\n\t\tcriteria = 'PO_Status != &quot;Fully Received&quot; &amp;&amp; PO_Status != &quot;Cancelled&quot;'\n\t  value = 'thisapp.Purchase_Orders.ID.count'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='19%'\n   \t>\n\t<panel elementName='Panel 3'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n>\n\t<pr \n\t\t\twidth='fill'\n\t\theight='50px'\n>\n\t<pc \n\t\tpadding = '0px'\n\tbgColor = '#CFBFFD'\n\n    borderColor = '#444444'\n    borderWidth = '0px'\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n    \tcornerRadius = '0px'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmarginLeft = '20px'\n\tmarginRight = '20px' \n\tmarginBottom = '0px'\n\tmarginTop = '0px'\n\tpadding = '0px'\n\tcolor = '#2D2D2D'\n\tsize = '16px'\n\ttype = 'Text'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\n\n\n    borderColor = '#2D2D2D'\n    borderWidth = '0px'\n\n\t  value = 'Total Stock Value'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr><pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '20px'\n\tbgColor = '#FFFFFF'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n>\n\t<text \n\n\tmargin = '0px'\n\tpadding = '0px'\n\tcolor = '#FF4C2F'\n\tsize = '36px'\n\tbold = 'true' \n\ttype = 'Form Data'\n\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\tcornerRadius = '0px'\n\n\n\tdisplayType = 'actual'\n\tdecimalPlaces = '2'\n\tthousandsSeperator = 'COMMA'\n\tdecimalSeperator = 'DOT'\n\tnumberScale = 'none'\n\n\n\n    borderColor = '#FF4C2F'\n    borderWidth = '0px'\n\n\t  value = 'thisapp.Stock_Levels.Stock_Value_Stored.sum'\n>\n<\/text>\n\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column>\n<\/row><row>\n\t<column\n   \t\t width='50%'\n   \t>\n\t<report \n\telementName='Report'\n\n\t\tappLinkName = 'thisapp'\n\t\tlinkName = 'Low_Stock_Alert'\n\t\n\t\tiszreport = 'false'\n\t\t\t\t\tzc_AddRec = 'false'\n\t\t\t\t\tzc_EditRec = 'false'\n\t\t\t\t\tzc_Print = 'false'\n\t\t\t\t\tzc_Export = 'false'\n\t\t\t\t\tzc_DelRec = 'false'\n\t\t\t\t\tzc_DuplRec = 'false'\n\t\t\t\t\tzc_EditBulkRec = 'false'\n\t\t\t\t\tzc_BulkDelete = 'false'\n\t\t\t\t\tzc_BulkDuplicate = 'false'\n\theightType = 'auto'\n\theightValue = '700'\n\n\/>\n<\/column><column\n   \t\t width='50%'\n   \t>\n\t<report \n\telementName='Report 2'\n\n\t\tappLinkName = 'thisapp'\n\t\tlinkName = 'Orders_Pending_Approval1'\n\t\n\t\tiszreport = 'false'\n\t\t\t\t\tzc_AddRec = 'false'\n\t\t\t\t\tzc_EditRec = 'false'\n\t\t\t\t\tzc_Export = 'false'\n\t\t\t\t\tzc_DelRec = 'false'\n\t\t\t\t\tzc_DuplRec = 'false'\n\t\t\t\t\tzc_EditBulkRec = 'false'\n\t\t\t\t\tzc_BulkDelete = 'false'\n\t\t\t\t\tzc_BulkDuplicate = 'false'\n\theightType = 'auto'\n\theightValue = '700'\n\n\/>\n<\/column>\n<\/row><row>\n\t<column\n   \t\t width='35%'\n   \t>\n\t<chart \n\telementName='Orders By Month'\n\n\ttype = 'Bar'\n\txtitle = 'Months'\n\tytitle = 'Order Value Totals'\n\tbgColor = '#FFFFFF'\n\ttheme = 'theme1'\n\tlegendPos = 'center.top'\n\theightType = 'auto'\n\theightValue = '300px'\n\tappLinkName = 'thisapp'\n\tformLinkName = 'Stock_Ordering'\n\txfield = 'Order_Month'\n\tyfields = 'sum:Order_Total_Stored'\n\/>\n\n<\/column><column\n   \t\t width='65%'\n   \t>\n\t<report \n\telementName='Report 4'\n\n\t\tappLinkName = 'thisapp'\n\t\tlinkName = 'Stock_Valuation'\n\t\n\t\tiszreport = 'false'\n\t\t\t\t\tzc_AddRec = 'false'\n\t\t\t\t\tzc_EditRec = 'false'\n\t\t\t\t\tzc_Export = 'false'\n\t\t\t\t\tzc_DelRec = 'false'\n\t\t\t\t\tzc_DuplRec = 'false'\n\t\t\t\t\tzc_EditBulkRec = 'false'\n\t\t\t\t\tzc_BulkDelete = 'false'\n\t\t\t\t\tzc_BulkDuplicate = 'false'\n\theightType = 'auto'\n\theightValue = '700'\n\n\/>\n<\/column>\n<\/row><row>\n\t<column\n   \t\t width='35%'\n   \t>\n\t<dsp id='html_snippet6' elementName='HTML Snippet'\n bgColor=\"#FFFFFF\" \n>\n\t<![CDATA[htmlpage html_snippet6()\ncontent\n&lt;%{\n\t%&gt;\n&lt;%=Parameters[ID != null].Product_Trends_Report%&gt;\n&lt;%\n\n}%&gt;]]>\n<\/dsp>\n<\/column><column\n   \t\t width='65%'\n   \t>\n\t<report \n\telementName='Report 3'\n\n\t\tappLinkName = 'thisapp'\n\t\tlinkName = 'Stock_Transactions_Report'\n\t\n\t\tiszreport = 'false'\n\t\t\t\t\tzc_AddRec = 'false'\n\t\t\t\t\tzc_EditRec = 'false'\n\t\t\t\t\tzc_Export = 'false'\n\t\t\t\t\tzc_DelRec = 'false'\n\t\t\t\t\tzc_DuplRec = 'false'\n\t\t\t\t\tzc_EditBulkRec = 'false'\n\t\t\t\t\tzc_BulkDelete = 'false'\n\t\t\t\t\tzc_BulkDuplicate = 'false'\n\theightType = 'auto'\n\theightValue = '700'\n\n\/>\n<\/column>\n<\/row>\n<\/layout>\n<\/zml>"
		}
		page Assign_Bay_Page
		{
			displayname = "Assign_Bay_Page"
			Content="<zml    \t\t\n\t\t\n\t\t\n\t\t\n\t\t\n>\n\t<layout>\n\t<row>\n\t<column\n   \t\t width='100%'\n   \t>\n\t<dsp id='html_snippet4' elementName='HTML Snippet'\n bgColor=\"#FFFFFF\" \n>\n\t<![CDATA[htmlpage html_snippet4()\ncontent\n&lt;%{\n\t\/\/ Get order ID from Parameters\n\tparamRec = Parameters[ID != null];\n\torderID = &quot;&quot;;\n\tfor each  p in paramRec\n\t{\n\t\torderID = p.Bay_Assignment_Order_ID;\n\t}\n\t\/\/ Get order details\n\torderRec = Stock_Ordering[ID == orderID.ToString()];\n\torderNumber = &quot;&quot;;\n\tsiteName = &quot;&quot;;\n\tfor each  o in orderRec\n\t{\n\t\torderNumber = o.Order_Number_Auto;\n\t\tsiteName = o.Sites_Reference.Site_Name;\n\t}\n\t\/\/ Get Bay options\n\tbayOptions = Bay_Locations[Active == true];\n\t%&gt;\n&lt;div style=&quot;padding: 20px; font-family: Arial, sans-serif;&quot;&gt;\n    &lt;h2&gt;Assign Collection Bay&lt;\/h2&gt;\n    &lt;p&gt;&lt;strong&gt;Order:&lt;\/strong&gt; &lt;%=orderNumber%&gt;&lt;\/p&gt;\n    &lt;p&gt;&lt;strong&gt;Site:&lt;\/strong&gt; &lt;%=siteName%&gt;&lt;\/p&gt;\n    \n    &lt;form id=&quot;bayForm&quot;&gt;\n        &lt;label for=&quot;baySelect&quot;&gt;&lt;strong&gt;Select Bay:&lt;\/strong&gt;&lt;\/label&gt;&lt;br&gt;&lt;br&gt;\n        &lt;select id=&quot;baySelect&quot; style=&quot;width: 200px; padding: 8px; font-size: 14px;&quot;&gt;\n            &lt;option value=&quot;&quot;&gt;-- Select Bay --&lt;\/option&gt;\n&lt;%\n\tfor each  bay in bayOptions\n\t{\n\t\t%&gt;\n&lt;option value=&quot;&lt;%=bay.ID%&gt;&quot;&gt;&lt;%=bay.Bay_Name%&gt;&lt;\/option&gt;\n&lt;%\n\t}\n\t%&gt;\n&lt;\/select&gt;\n        &lt;br&gt;&lt;br&gt;\n        &lt;button type=&quot;button&quot; onclick=&quot;assignBay()&quot; style=&quot;padding: 10px 20px; background-color: #4CAF50; color: white; border: none; cursor: pointer;&quot;&gt;\n            Assign Bay &amp; Move to Collection\n        &lt;\/button&gt;\n    &lt;\/form&gt;\n&lt;\/div&gt;\n\n&lt;script&gt;\nfunction assignBay() {\n    var bayID = document.getElementById(&apos;baySelect&apos;).value;\n    if(bayID == &quot;&quot;) {\n        alert(&quot;Please select a Bay&quot;);\n        return;\n    }\n    \/\/ This will need a workflow to handle the update\n    window.location.href = &quot;#Report:Stock_Ordering_Report?Bay_Update=&quot; + bayID + &quot;&amp;Order_ID=&lt;%=orderID%&gt;&quot;;\n}\n&lt;\/script&gt;\n&lt;%\n\n}%&gt;]]>\n<\/dsp>\n<\/column>\n<\/row>\n<\/layout>\n<\/zml>"
		}
		page Proposal_VS_Order
		{
			displayname = "Proposal VS Order"
			Content="<zml    \t\t\n\t\t\n\t\t\n\t\t\n\t\t\n>\n\t<layout>\n\t<row>\n\t<column\n   \t\t width='100%'\n   \t>\n\t<dsp id='html_snippet3' elementName='Proposal Vs Order Report'\n bgColor=\"transparent\" \n>\n\t<![CDATA[htmlpage html_snippet3()\ncontent\n&lt;%{\n\t%&gt;\n&lt;%=Parameters[ID != null].Proposal_Order_Comparison_Report%&gt;\n&lt;%\n\n}%&gt;]]>\n<\/dsp>\n<\/column>\n<\/row>\n<\/layout>\n<\/zml>"
		}
		page TEST
		{
			displayname = "TEST"
			Content="<zml    \t\t\n\t\t\n\t\t\n\t\t\n\t\t\n>\n\t<layout>\n\t<row>\n\t<column\n   \t\t width='100%'\n   \t>\n\t<dsp id='html_snippet2' elementName='HTML Snippet'\n bgColor=\"#FFFFFF\" \n>\n\t<![CDATA[htmlpage html_snippet2()\ncontent\n&lt;%{\n\t%&gt;\nString fn_GenerateProposalVsOrderReport()\n{\n    \/\/ ---- STYLES ----\n    \/\/ Inline CSS for email compatibility\n    \n    tableStyle = &quot;width:100%; border-collapse:collapse; font-family:Arial,sans-serif; font-size:14px;&quot;;\n    headerRowStyle = &quot;background-color:#1a365d; color:#ffffff;&quot;;\n    headerCellStyle = &quot;padding:12px 16px; text-align:left; font-weight:600; border:1px solid #2d4a6f;&quot;;\n    headerCellRightStyle = &quot;padding:12px 16px; text-align:right; font-weight:600; border:1px solid #2d4a6f;&quot;;\n    rowStyle = &quot;background-color:#ffffff;&quot;;\n    altRowStyle = &quot;background-color:#f7fafc;&quot;;\n    cellStyle = &quot;padding:10px 16px; border:1px solid #e2e8f0;&quot;;\n    cellRightStyle = &quot;padding:10px 16px; border:1px solid #e2e8f0; text-align:right;&quot;;\n    totalRowStyle = &quot;background-color:#2d3748; color:#ffffff; font-weight:600;&quot;;\n    totalCellStyle = &quot;padding:12px 16px; border:1px solid #1a202c;&quot;;\n    totalCellRightStyle = &quot;padding:12px 16px; border:1px solid #1a202c; text-align:right;&quot;;\n    \n    \/\/ Variance colors\n    positiveColor = &quot;#c53030&quot;; \/\/ Red - over budget\n    negativeColor = &quot;#276749&quot;; \/\/ Green - under budget\n    neutralColor = &quot;#2b6cb0&quot;;  \/\/ Blue - on target\n    \n    \/\/ ---- FETCH DATA ----\n    \n    proposals = Project_Proposals[Proposal_Status == &quot;Accepted&quot; || Proposal_Status == &quot;In Progress&quot;];\n    \n    \/\/ Initialize totals\n    grandTotalProposed = 0.0;\n    grandTotalOrdered = 0.0;\n    projectCount = 0;\n    overBudgetCount = 0;\n    underBudgetCount = 0;\n    \n    \/\/ Build data list\n    dataList = List();\n    \n    for each prop in proposals\n    {\n        projectData = Map();\n        \n        \/\/ Project info\n        projectData.put(&quot;projectId&quot;, ifnull(prop.Proposal_Number, &quot;N\/A&quot;));\n        projectData.put(&quot;projectName&quot;, ifnull(prop.Project_Name, &quot;Unnamed Project&quot;));\n        projectData.put(&quot;status&quot;, ifnull(prop.Proposal_Status, &quot;&quot;));\n        \n        \/\/ Company name\n        companyName = &quot;N\/A&quot;;\n        if(prop.Company != null)\n        {\n            compRec = Companies[ID == prop.Company];\n            for each c in compRec\n            {\n                companyName = ifnull(c.Company_Name, &quot;N\/A&quot;);\n            }\n        }\n        projectData.put(&quot;company&quot;, companyName);\n        \n        \/\/ ---- CALCULATE PROPOSED VALUE ----\n        \/\/ Sum from Proposal Line Items via Work Packages\n        proposedValue = 0.0;\n        \n        workPackages = Proposal_Work_Packages[Proposal == prop.ID];\n        for each wp in workPackages\n        {\n            lineItems = Proposal_Line_Items[Work_Package == wp.ID];\n            for each li in lineItems\n            {\n                proposedValue = proposedValue + ifnull(li.Line_Total, 0);\n            }\n        }\n        \n        \/\/ Fallback to Agreed_Price if line items not populated\n        if(proposedValue == 0 &amp;&amp; prop.Agreed_Price != null)\n        {\n            proposedValue = prop.Agreed_Price;\n        }\n        \n        projectData.put(&quot;proposedValue&quot;, proposedValue);\n        grandTotalProposed = grandTotalProposed + proposedValue;\n        \n        \/\/ ---- CALCULATE ORDERED VALUE ----\n        \/\/ Match orders by site name (adjust logic as needed)\n        orderedValue = 0.0;\n        orderCount = 0;\n        \n        projectName = ifnull(prop.Project_Name, &quot;&quot;);\n        \n        if(projectName != &quot;&quot;)\n        {\n            \/\/ Get all collected orders\n            collectedOrders = Stock_Ordering[Order_Status == &quot;Collected&quot;];\n            \n            for each ord in collectedOrders\n            {\n                siteName = &quot;&quot;;\n                \n                \/\/ Get site name from linked site\n                if(ord.Sites_Reference != null)\n                {\n                    siteRec = zoho.creator.getRecordById(&quot;rascor_site_attendance&quot;, &quot;Sites_Reference&quot;, ord.Sites_Reference);\n                    if(siteRec != null)\n                    {\n                        siteName = ifnull(siteRec.get(&quot;Site_Name&quot;), &quot;&quot;);\n                    }\n                }\n                \n                \/\/ Check if site matches project\n                \/\/ Adjust this matching logic based on your naming conventions\n                isMatch = false;\n                if(siteName != &quot;&quot; &amp;&amp; projectName != &quot;&quot;)\n                {\n                    if(siteName.toLowerCase().contains(projectName.toLowerCase()) || projectName.toLowerCase().contains(siteName.toLowerCase()))\n                    {\n                        isMatch = true;\n                    }\n                }\n                \n                if(isMatch)\n                {\n                    orderCount = orderCount + 1;\n                    \n                    \/\/ Sum line items value\n                    orderLines = Order_Line_Items[Order == ord.ID];\n                    for each line in orderLines\n                    {\n                        qty = ifnull(line.Quantity, 0);\n                        \n                        \/\/ Get product rate\n                        rate = 0.0;\n                        if(line.Product != null)\n                        {\n                            prodRec = Product_Master[ID == line.Product];\n                            for each p in prodRec\n                            {\n                                rate = ifnull(p.Base_Rate, 0);\n                            }\n                        }\n                        orderedValue = orderedValue + (qty * rate);\n                    }\n                }\n            }\n        }\n        \n        projectData.put(&quot;orderedValue&quot;, orderedValue);\n        projectData.put(&quot;orderCount&quot;, orderCount);\n        grandTotalOrdered = grandTotalOrdered + orderedValue;\n        \n        \/\/ ---- CALCULATE VARIANCE ----\n        variance = orderedValue - proposedValue;\n        variancePercent = 0.0;\n        if(proposedValue &gt; 0)\n        {\n            variancePercent = (variance \/ proposedValue) * 100;\n        }\n        \n        projectData.put(&quot;variance&quot;, variance);\n        projectData.put(&quot;variancePercent&quot;, round(variancePercent, 1));\n        \n        \/\/ Track budget status\n        if(variancePercent &gt; 5)\n        {\n            overBudgetCount = overBudgetCount + 1;\n            projectData.put(&quot;status_color&quot;, positiveColor);\n            projectData.put(&quot;status_label&quot;, &quot;OVER&quot;);\n        }\n        else if(variancePercent &lt; -5)\n        {\n            underBudgetCount = underBudgetCount + 1;\n            projectData.put(&quot;status_color&quot;, negativeColor);\n            projectData.put(&quot;status_label&quot;, &quot;UNDER&quot;);\n        }\n        else\n        {\n            projectData.put(&quot;status_color&quot;, neutralColor);\n            projectData.put(&quot;status_label&quot;, &quot;ON TARGET&quot;);\n        }\n        \n        dataList.add(projectData);\n        projectCount = projectCount + 1;\n    }\n    \n    \/\/ ---- CALCULATE GRAND TOTALS ----\n    grandVariance = grandTotalOrdered - grandTotalProposed;\n    grandVariancePercent = 0.0;\n    if(grandTotalProposed &gt; 0)\n    {\n        grandVariancePercent = (grandVariance \/ grandTotalProposed) * 100;\n    }\n    \n    \/\/ ---- BUILD HTML ----\n    \n    html = &quot;&quot;;\n    \n    \/\/ Container\n    html = html + &quot;&lt;div style=&apos;font-family:Arial,sans-serif; max-width:1000px; margin:0 auto;&apos;&gt;&quot;;\n    \n    \/\/ Header\n    html = html + &quot;&lt;div style=&apos;background:linear-gradient(135deg,#1a365d,#2c5282); color:#fff; padding:24px; border-radius:8px 8px 0 0;&apos;&gt;&quot;;\n    html = html + &quot;&lt;h1 style=&apos;margin:0 0 8px 0; font-size:24px;&apos;&gt;Proposal vs Orders Analysis&lt;\/h1&gt;&quot;;\n    html = html + &quot;&lt;p style=&apos;margin:0; opacity:0.9;&apos;&gt;Generated: &quot; + zoho.currentdate.toString(&quot;dd MMM yyyy&quot;) + &quot;at &quot; + zoho.currenttime.toString(&quot;HH:mm&quot;) + &quot;&lt;\/p&gt;&quot;;\n    html = html + &quot;&lt;\/div&gt;&quot;;\n    \n    \/\/ Summary Cards\n    html = html + &quot;&lt;div style=&apos;display:flex; flex-wrap:wrap; gap:16px; padding:20px; background:#f7fafc; border-left:1px solid #e2e8f0; border-right:1px solid #e2e8f0;&apos;&gt;&quot;;\n    \n    \/\/ Card 1: Total Proposed\n    html = html + &quot;&lt;div style=&apos;flex:1; min-width:150px; background:#fff; padding:16px; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,0.1);&apos;&gt;&quot;;\n    html = html + &quot;&lt;div style=&apos;font-size:12px; color:#718096; text-transform:uppercase; letter-spacing:1px;&apos;&gt;Total Proposed&lt;\/div&gt;&quot;;\n    html = html + &quot;&lt;div style=&apos;font-size:24px; font-weight:700; color:#1a365d;&apos;&gt;\u20AC&quot; + formatNumber(grandTotalProposed) + &quot;&lt;\/div&gt;&quot;;\n    html = html + &quot;&lt;div style=&apos;font-size:12px; color:#718096;&apos;&gt;&quot; + projectCount + &quot;projects&lt;\/div&gt;&quot;;\n    html = html + &quot;&lt;\/div&gt;&quot;;\n    \n    \/\/ Card 2: Total Ordered\n    html = html + &quot;&lt;div style=&apos;flex:1; min-width:150px; background:#fff; padding:16px; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,0.1);&apos;&gt;&quot;;\n    html = html + &quot;&lt;div style=&apos;font-size:12px; color:#718096; text-transform:uppercase; letter-spacing:1px;&apos;&gt;Total Ordered&lt;\/div&gt;&quot;;\n    html = html + &quot;&lt;div style=&apos;font-size:24px; font-weight:700; color:#276749;&apos;&gt;\u20AC&quot; + formatNumber(grandTotalOrdered) + &quot;&lt;\/div&gt;&quot;;\n    html = html + &quot;&lt;div style=&apos;font-size:12px; color:#718096;&apos;&gt;&quot; + round(grandVariancePercent, 1) + &quot;% of proposed&lt;\/div&gt;&quot;;\n    html = html + &quot;&lt;\/div&gt;&quot;;\n    \n    \/\/ Card 3: Variance\n    varianceColor = positiveColor;\n    if(grandVariance &lt; 0)\n    {\n        varianceColor = negativeColor;\n    }\n    html = html + &quot;&lt;div style=&apos;flex:1; min-width:150px; background:#fff; padding:16px; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,0.1);&apos;&gt;&quot;;\n    html = html + &quot;&lt;div style=&apos;font-size:12px; color:#718096; text-transform:uppercase; letter-spacing:1px;&apos;&gt;Variance&lt;\/div&gt;&quot;;\n    html = html + &quot;&lt;div style=&apos;font-size:24px; font-weight:700; color:&quot; + varianceColor + &quot;;&apos;&gt;&quot;;\n    if(grandVariance &gt;= 0)\n    {\n        html = html + &quot;+&quot;;\n    }\n    html = html + &quot;\u20AC&quot; + formatNumber(grandVariance) + &quot;&lt;\/div&gt;&quot;;\n    html = html + &quot;&lt;div style=&apos;font-size:12px; color:#718096;&apos;&gt;&quot;;\n    if(grandVariance &gt;= 0)\n    {\n        html = html + &quot;+&quot;;\n    }\n    html = html + round(grandVariancePercent, 1) + &quot;%&lt;\/div&gt;&quot;;\n    html = html + &quot;&lt;\/div&gt;&quot;;\n    \n    \/\/ Card 4: Budget Status\n    html = html + &quot;&lt;div style=&apos;flex:1; min-width:150px; background:#fff; padding:16px; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,0.1);&apos;&gt;&quot;;\n    html = html + &quot;&lt;div style=&apos;font-size:12px; color:#718096; text-transform:uppercase; letter-spacing:1px;&apos;&gt;Budget Status&lt;\/div&gt;&quot;;\n    html = html + &quot;&lt;div style=&apos;font-size:14px; margin-top:8px;&apos;&gt;&quot;;\n    html = html + &quot;&lt;span style=&apos;color:&quot; + positiveColor + &quot;;&apos;&gt;\u25CF&lt;\/span&gt; &quot; + overBudgetCount + &quot;Over &amp;nbsp;&quot;;\n    html = html + &quot;&lt;span style=&apos;color:&quot; + negativeColor + &quot;;&apos;&gt;\u25CF&lt;\/span&gt; &quot; + underBudgetCount + &quot;Under &amp;nbsp;&quot;;\n    html = html + &quot;&lt;span style=&apos;color:&quot; + neutralColor + &quot;;&apos;&gt;\u25CF&lt;\/span&gt; &quot; + (projectCount - overBudgetCount - underBudgetCount) + &quot;On Target&quot;;\n    html = html + &quot;&lt;\/div&gt;&quot;;\n    html = html + &quot;&lt;\/div&gt;&quot;;\n    \n    html = html + &quot;&lt;\/div&gt;&quot;; \/\/ End summary cards\n    \n    \/\/ ---- MAIN DATA TABLE ----\n    \n    html = html + &quot;&lt;table style=&apos;&quot; + tableStyle + &quot;&apos;&gt;&quot;;\n    \n    \/\/ Table Header\n    html = html + &quot;&lt;thead&gt;&quot;;\n    html = html + &quot;&lt;tr style=&apos;&quot; + headerRowStyle + &quot;&apos;&gt;&quot;;\n    html = html + &quot;&lt;th style=&apos;&quot; + headerCellStyle + &quot;&apos;&gt;Project&lt;\/th&gt;&quot;;\n    html = html + &quot;&lt;th style=&apos;&quot; + headerCellStyle + &quot;&apos;&gt;Company&lt;\/th&gt;&quot;;\n    html = html + &quot;&lt;th style=&apos;&quot; + headerCellRightStyle + &quot;&apos;&gt;Proposed&lt;\/th&gt;&quot;;\n    html = html + &quot;&lt;th style=&apos;&quot; + headerCellRightStyle + &quot;&apos;&gt;Ordered&lt;\/th&gt;&quot;;\n    html = html + &quot;&lt;th style=&apos;&quot; + headerCellRightStyle + &quot;&apos;&gt;Variance&lt;\/th&gt;&quot;;\n    html = html + &quot;&lt;th style=&apos;&quot; + headerCellRightStyle + &quot;&apos;&gt;%&lt;\/th&gt;&quot;;\n    html = html + &quot;&lt;th style=&apos;&quot; + headerCellStyle + &quot;text-align:center;&apos;&gt;Status&lt;\/th&gt;&quot;;\n    html = html + &quot;&lt;\/tr&gt;&quot;;\n    html = html + &quot;&lt;\/thead&gt;&quot;;\n    \n    \/\/ Table Body\n    html = html + &quot;&lt;tbody&gt;&quot;;\n    \n    rowNum = 0;\n    for each item in dataList\n    {\n        \/\/ Alternate row colors\n        currentRowStyle = rowStyle;\n        if(rowNum % 2 == 1)\n        {\n            currentRowStyle = altRowStyle;\n        }\n        \n        html = html + &quot;&lt;tr style=&apos;&quot; + currentRowStyle + &quot;&apos;&gt;&quot;;\n        \n        \/\/ Project\n        html = html + &quot;&lt;td style=&apos;&quot; + cellStyle + &quot;&apos;&gt;&quot;;\n        html = html + &quot;&lt;strong&gt;&quot; + item.get(&quot;projectName&quot;) + &quot;&lt;\/strong&gt;&lt;br\/&gt;&quot;;\n        html = html + &quot;&lt;span style=&apos;font-size:12px; color:#718096;&apos;&gt;&quot; + item.get(&quot;projectId&quot;) + &quot;&lt;\/span&gt;&quot;;\n        html = html + &quot;&lt;\/td&gt;&quot;;\n        \n        \/\/ Company\n        html = html + &quot;&lt;td style=&apos;&quot; + cellStyle + &quot;&apos;&gt;&quot; + item.get(&quot;company&quot;) + &quot;&lt;\/td&gt;&quot;;\n        \n        \/\/ Proposed\n        html = html + &quot;&lt;td style=&apos;&quot; + cellRightStyle + &quot;&apos;&gt;\u20AC&quot; + formatNumber(item.get(&quot;proposedValue&quot;)) + &quot;&lt;\/td&gt;&quot;;\n        \n        \/\/ Ordered\n        html = html + &quot;&lt;td style=&apos;&quot; + cellRightStyle + &quot;&apos;&gt;&quot;;\n        html = html + &quot;\u20AC&quot; + formatNumber(item.get(&quot;orderedValue&quot;));\n        if(item.get(&quot;orderCount&quot;) &gt; 0)\n        {\n            html = html + &quot;&lt;br\/&gt;&lt;span style=&apos;font-size:11px; color:#718096;&apos;&gt;(&quot; + item.get(&quot;orderCount&quot;) + &quot;orders)&lt;\/span&gt;&quot;;\n        }\n        html = html + &quot;&lt;\/td&gt;&quot;;\n        \n        \/\/ Variance\n        varValue = item.get(&quot;variance&quot;);\n        varColor = item.get(&quot;status_color&quot;);\n        html = html + &quot;&lt;td style=&apos;&quot; + cellRightStyle + &quot;color:&quot; + varColor + &quot;; font-weight:600;&apos;&gt;&quot;;\n        if(varValue &gt;= 0)\n        {\n            html = html + &quot;+&quot;;\n        }\n        html = html + &quot;\u20AC&quot; + formatNumber(varValue);\n        html = html + &quot;&lt;\/td&gt;&quot;;\n        \n        \/\/ Variance %\n        varPct = item.get(&quot;variancePercent&quot;);\n        html = html + &quot;&lt;td style=&apos;&quot; + cellRightStyle + &quot;color:&quot; + varColor + &quot;;&apos;&gt;&quot;;\n        if(varPct &gt;= 0)\n        {\n            html = html + &quot;+&quot;;\n        }\n        html = html + varPct + &quot;%&quot;;\n        html = html + &quot;&lt;\/td&gt;&quot;;\n        \n        \/\/ Status Badge\n        html = html + &quot;&lt;td style=&apos;&quot; + cellStyle + &quot;text-align:center;&apos;&gt;&quot;;\n        html = html + &quot;&lt;span style=&apos;display:inline-block; padding:4px 12px; border-radius:12px; font-size:11px; font-weight:600; &quot;;\n        html = html + &quot;background-color:&quot; + item.get(&quot;status_color&quot;) + &quot;22; color:&quot; + item.get(&quot;status_color&quot;) + &quot;;&apos;&gt;&quot;;\n        html = html + item.get(&quot;status_label&quot;);\n        html = html + &quot;&lt;\/span&gt;&quot;;\n        html = html + &quot;&lt;\/td&gt;&quot;;\n        \n        html = html + &quot;&lt;\/tr&gt;&quot;;\n        \n        \/\/ ---- VISUAL BAR (Optional) ----\n        \/\/ Add a row with a visual comparison bar\n        html = html + &quot;&lt;tr style=&apos;&quot; + currentRowStyle + &quot;&apos;&gt;&quot;;\n        html = html + &quot;&lt;td colspan=&apos;7&apos; style=&apos;padding:4px 16px 12px 16px; border:1px solid #e2e8f0; border-top:none;&apos;&gt;&quot;;\n        \n        \/\/ Calculate bar widths\n        maxVal = item.get(&quot;proposedValue&quot;);\n        if(item.get(&quot;orderedValue&quot;) &gt; maxVal)\n        {\n            maxVal = item.get(&quot;orderedValue&quot;);\n        }\n        if(maxVal == 0)\n        {\n            maxVal = 1;\n        }\n        \n        proposedWidth = (item.get(&quot;proposedValue&quot;) \/ maxVal) * 100;\n        orderedWidth = (item.get(&quot;orderedValue&quot;) \/ maxVal) * 100;\n        \n        \/\/ Proposed bar\n        html = html + &quot;&lt;div style=&apos;display:flex; align-items:center; margin-bottom:4px;&apos;&gt;&quot;;\n        html = html + &quot;&lt;span style=&apos;width:60px; font-size:11px; color:#718096;&apos;&gt;Proposed&lt;\/span&gt;&quot;;\n        html = html + &quot;&lt;div style=&apos;flex:1; background:#e2e8f0; height:8px; border-radius:4px; overflow:hidden;&apos;&gt;&quot;;\n        html = html + &quot;&lt;div style=&apos;width:&quot; + proposedWidth + &quot;%; height:100%; background:#667eea; border-radius:4px;&apos;&gt;&lt;\/div&gt;&quot;;\n        html = html + &quot;&lt;\/div&gt;&quot;;\n        html = html + &quot;&lt;\/div&gt;&quot;;\n        \n        \/\/ Ordered bar\n        html = html + &quot;&lt;div style=&apos;display:flex; align-items:center;&apos;&gt;&quot;;\n        html = html + &quot;&lt;span style=&apos;width:60px; font-size:11px; color:#718096;&apos;&gt;Ordered&lt;\/span&gt;&quot;;\n        html = html + &quot;&lt;div style=&apos;flex:1; background:#e2e8f0; height:8px; border-radius:4px; overflow:hidden;&apos;&gt;&quot;;\n        html = html + &quot;&lt;div style=&apos;width:&quot; + orderedWidth + &quot;%; height:100%; background:#48bb78; border-radius:4px;&apos;&gt;&lt;\/div&gt;&quot;;\n        html = html + &quot;&lt;\/div&gt;&quot;;\n        html = html + &quot;&lt;\/div&gt;&quot;;\n        \n        html = html + &quot;&lt;\/td&gt;&quot;;\n        html = html + &quot;&lt;\/tr&gt;&quot;;\n        \n        rowNum = rowNum + 1;\n    }\n    \n    html = html + &quot;&lt;\/tbody&gt;&quot;;\n    \n    \/\/ ---- TOTALS ROW ----\n    html = html + &quot;&lt;tfoot&gt;&quot;;\n    html = html + &quot;&lt;tr style=&apos;&quot; + totalRowStyle + &quot;&apos;&gt;&quot;;\n    html = html + &quot;&lt;td style=&apos;&quot; + totalCellStyle + &quot;&apos;colspan=&apos;2&apos;&gt;&lt;strong&gt;GRAND TOTAL&lt;\/strong&gt;&lt;\/td&gt;&quot;;\n    html = html + &quot;&lt;td style=&apos;&quot; + totalCellRightStyle + &quot;&apos;&gt;\u20AC&quot; + formatNumber(grandTotalProposed) + &quot;&lt;\/td&gt;&quot;;\n    html = html + &quot;&lt;td style=&apos;&quot; + totalCellRightStyle + &quot;&apos;&gt;\u20AC&quot; + formatNumber(grandTotalOrdered) + &quot;&lt;\/td&gt;&quot;;\n    \n    \/\/ Total variance\n    html = html + &quot;&lt;td style=&apos;&quot; + totalCellRightStyle + &quot;&apos;&gt;&quot;;\n    if(grandVariance &gt;= 0)\n    {\n        html = html + &quot;+&quot;;\n    }\n    html = html + &quot;\u20AC&quot; + formatNumber(grandVariance) + &quot;&lt;\/td&gt;&quot;;\n    \n    \/\/ Total variance %\n    html = html + &quot;&lt;td style=&apos;&quot; + totalCellRightStyle + &quot;&apos;&gt;&quot;;\n    if(grandVariancePercent &gt;= 0)\n    {\n        html = html + &quot;+&quot;;\n    }\n    html = html + round(grandVariancePercent, 1) + &quot;%&lt;\/td&gt;&quot;;\n    \n    html = html + &quot;&lt;td style=&apos;&quot; + totalCellStyle + &quot;&apos;&gt;&lt;\/td&gt;&quot;;\n    html = html + &quot;&lt;\/tr&gt;&quot;;\n    html = html + &quot;&lt;\/tfoot&gt;&quot;;\n    \n    html = html + &quot;&lt;\/table&gt;&quot;;\n    \n    \/\/ Footer\n    html = html + &quot;&lt;div style=&apos;padding:16px; background:#f7fafc; border:1px solid #e2e8f0; border-top:none; border-radius:0 0 8px 8px;&apos;&gt;&quot;;\n    html = html + &quot;&lt;p style=&apos;margin:0; font-size:12px; color:#718096;&apos;&gt;&quot;;\n    html = html + &quot;\u25CF Over Budget = Ordered &gt; Proposed by more than 5% &amp;nbsp;&amp;nbsp;&quot;;\n    html = html + &quot;\u25CF Under Budget = Ordered &lt; Proposed by more than 5% &amp;nbsp;&amp;nbsp;&quot;;\n    html = html + &quot;\u25CF On Target = Within \u00B15%&quot;;\n    html = html + &quot;&lt;\/p&gt;&quot;;\n    html = html + &quot;&lt;p style=&apos;margin:8px 0 0 0; font-size:11px; color:#a0aec0;&apos;&gt;&quot;;\n    html = html + &quot;Report generated by RASCOR Stock Management System&quot;;\n    html = html + &quot;&lt;\/p&gt;&quot;;\n    html = html + &quot;&lt;\/div&gt;&quot;;\n    \n    html = html + &quot;&lt;\/div&gt;&quot;; \/\/ End container\n    \n    return html;\n}\n&lt;%\n\n}%&gt;]]>\n<\/dsp>\n<\/column>\n<\/row>\n<\/layout>\n<\/zml>"
		}
		page Main_Dashboard
		{
			displayname = "Stock Management"
			Content="<zml    \t\t\n\t\t\n\t\t\n\t\t\n\t\t\n>\n\t<layout>\n\t<row>\n\t<column\n   \t\t width='15%'\n   \t>\n\t<panel elementName='Panel'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '10px'\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n\t\tvAlign = 'middle'\n>\n\t<button \n\t\tmargin = '0px'\n\tpaddingTop = '15px'\n\tpaddingLeft = '20px'\n\tpaddingRight = '20px'\n\tpaddingBottom = '15px'\n\n    action = 'OpenForm'\n\t\tcomponentLinkName = 'Purchase_Orders'\n\t\ttarget = 'same-window'\n\tcolor = '#FFFFFF'\n\tsize = '16px'\n    borderColor = '#FFFFFF'\n    borderWidth = '0px'\n\ttext ='Purchase Orders'\n\t\tbgColor = 'theme'\n\t\tcornerRadius = '10px' \n\/>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='15%'\n   \t>\n\t<panel elementName='Panel 1'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '10px'\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n\t\tvAlign = 'middle'\n>\n\t<button \n\t\tmargin = '0px'\n\tpaddingTop = '15px'\n\tpaddingLeft = '20px'\n\tpaddingRight = '20px'\n\tpaddingBottom = '15px'\n\n    action = 'OpenForm'\n\t\tcomponentLinkName = 'Goods_Receipt'\n\t\ttarget = 'same-window'\n\tcolor = '#FFFFFF'\n\tsize = '16px'\n    borderColor = '#FFFFFF'\n    borderWidth = '0px'\n\ttext ='Goods Received'\n\t\tbgColor = 'theme'\n\t\tcornerRadius = '10px' \n\/>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='16%'\n   \t>\n\t<panel elementName='Panel 2'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '10px'\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n\t\tvAlign = 'middle'\n>\n\t<button \n\t\tmargin = '0px'\n\tpaddingTop = '15px'\n\tpaddingLeft = '20px'\n\tpaddingRight = '20px'\n\tpaddingBottom = '15px'\n\n    action = 'OpenPage'\n\t\tcomponentLinkName = 'Inventory_Dashboard'\n\t\ttarget = 'same-window'\n\tcolor = '#FFFFFF'\n\tsize = '16px'\n    borderColor = '#FFFFFF'\n    borderWidth = '0px'\n\ttext ='Stock Dashboard'\n\t\tbgColor = 'theme'\n\t\tcornerRadius = '10px' \n\/>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='17%'\n   \t>\n\t<panel elementName='Panel 3'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '10px'\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n\t\tvAlign = 'middle'\n>\n\t<button \n\t\tmargin = '0px'\n\tpaddingTop = '15px'\n\tpaddingLeft = '20px'\n\tpaddingRight = '20px'\n\tpaddingBottom = '15px'\n\n    action = 'ExecuteFunction'\n\n\t\tfunctionName = 'fn_RunOrdersReport'  \n\tcolor = '#FFFFFF'\n\tsize = '16px'\n    borderColor = '#FFFFFF'\n    borderWidth = '0px'\n\ttext ='Orders Report'\n\t\tbgColor = 'theme'\n\t\tcornerRadius = '10px' \n\/>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='17%'\n   \t>\n\t<panel elementName='Panel 4'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '10px'\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n\t\tvAlign = 'middle'\n>\n\t<button \n\t\tmargin = '0px'\n\tpaddingTop = '15px'\n\tpaddingLeft = '20px'\n\tpaddingRight = '20px'\n\tpaddingBottom = '15px'\n\n    action = 'OpenPage'\n\t\tcomponentLinkName = 'Proposals_Dashboard'\n\t\ttarget = 'same-window'\n\tcolor = '#FFFFFF'\n\tsize = '16px'\n    borderColor = '#FFFFFF'\n    borderWidth = '0px'\n\ttext ='Proposals'\n\t\tbgColor = 'theme'\n\t\tcornerRadius = '10px' \n\/>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column><column\n   \t\t width='20%'\n   \t>\n\t<panel elementName='Panel 5'\n \n >\n\t<pr \n\t\t\twidth='fill'\n\t\theight='fill'\n>\n\t<pc \n\t\tpadding = '10px'\n\tbgColor = 'transparent'\n        bgColorType = 'noFill'\n\n\t\twidth = '100%'\n\t\thAlign = 'center'\n\t\tvAlign = 'middle'\n>\n\t<pr \n\t\t\twidth='auto'\n\t\theight='auto'\n>\n\t<pc \n\t\n\t\tvAlign = 'middle'\n>\n\t<button \n\t\tmargin = '0px'\n\tpaddingTop = '15px'\n\tpaddingLeft = '20px'\n\tpaddingRight = '20px'\n\tpaddingBottom = '15px'\n\n    action = 'ExecuteFunction'\n\n\t\tfunctionName = 'fn_RunProposalReport'  \n\tcolor = '#FFFFFF'\n\tsize = '16px'\n    borderColor = '#FFFFFF'\n    borderWidth = '0px'\n\ttext ='Proposal vs Actual'\n\t\tbgColor = 'theme'\n\t\tcornerRadius = '10px' \n\/>\n<\/pc>\n<\/pr>\n<\/pc>\n<\/pr>\n<\/panel>\n<\/column>\n<\/row><row>\n\t<column\n   \t\t width='50%'\n   \t>\n\t<dsp id='html_snippet7' elementName='HTML Snippet'\n bgColor=\"#FFFFFF\" \n>\n\t<![CDATA[htmlpage html_snippet7()\ncontent\n&lt;%{\n\t%&gt;\n&lt;%=Parameters[ID != null].Products_By_Month_Chart%&gt;\n&lt;%\n\n}%&gt;]]>\n<\/dsp>\n<\/column><column\n   \t\t width='50%'\n   \t>\n\t<dsp id='html_snippet8' elementName='HTML Snippet 1'\n bgColor=\"#FFFFFF\" \n>\n\t<![CDATA[htmlpage html_snippet8()\ncontent\n&lt;%{\n\t%&gt;\n&lt;%=Parameters[ID != null].Products_By_Site_Chart%&gt;\n&lt;%\n\n}%&gt;]]>\n<\/dsp>\n<\/column>\n<\/row><row>\n\t<column\n   \t\t width='100%'\n   \t>\n\t<dsp id='html_snippet9' elementName='HTML Snippet 2'\n bgColor=\"#FFFFFF\" \n>\n\t<![CDATA[htmlpage html_snippet9()\ncontent\n&lt;%{\n\t%&gt;\n&lt;%=Parameters[ID != null].Products_By_Week_Chart%&gt;\n&lt;%\n\n}%&gt;]]>\n<\/dsp>\n<\/column>\n<\/row>\n<\/layout>\n<\/zml>"
		}
		page Stock_Report_Page
		{
			displayname = "Stock Report Page"
			Content="<zml    \t\t\n\t\t\n\t\t\n\t\t\n\t\t\n>\n\t<layout>\n\t<row>\n\t<column\n   \t\t width='100%'\n   \t>\n\t<dsp id='html_snippet1' elementName='HTML Snippet'\n bgColor=\"transparent\" \n>\n\t<![CDATA[htmlpage html_snippet1()\ncontent\n&lt;%{\n\t%&gt;\n&lt;%=Parameters[ID != null].Dynamic_Stock_Report%&gt;\n&lt;%\n\n}%&gt;]]>\n<\/dsp>\n<\/column>\n<\/row>\n<\/layout>\n<\/zml>"
		}
		page Orders_Report_Page
		{
			displayname = "Orders Report Page"
			Content="<zml    \t\t\n\t\t\n\t\t\n\t\t\n\t\t\n>\n\t<layout>\n\t<row>\n\t<column\n   \t\t width='100%'\n   \t>\n\t<dsp id='html_snippet5' elementName='HTML Snippet'\n bgColor=\"transparent\" \n>\n\t<![CDATA[htmlpage html_snippet5()\ncontent\n&lt;%{\n\t%&gt;\n&lt;%=Parameters[ID != null].Dynamic_Order_Report%&gt;\n&lt;%\n\n}%&gt;]]>\n<\/dsp>\n<\/column>\n<\/row>\n<\/layout>\n<\/zml>"
		}
		page Print_Count_Sheet
		{
			displayname = "Print_Count_Sheet"
			Content="<zml    \t\t\n\t\t\n\t\t\n\t\t\n\t\t\n>\n\t<layout>\n\t\n<\/layout>\n<\/zml>"
		}
		page Print_Count
		{
			displayname = "Print_Count"
			Content="<zml    \t\t\n\t\t\n\t\t\n\t\t\n\t\t\n>\n\t<layout>\n\t<row>\n\t<column\n   \t\t width='100%'\n   \t>\n\t<dsp id='html_snippet10' elementName='HTML Snippet'\n bgColor=\"#FFFFFF\" \n>\n\t<![CDATA[htmlpage html_snippet10()\ncontent\n&lt;%{\n\t\/\/ Get stock take ID from Parameters\n\tparamRecords = Parameters[ID != 0];\n\tstockTakeID = 0;\n\tfor each  p in paramRecords\n\t{\n\t\tstockTakeID = p.Current_Stock_Take_ID;\n\t\tbreak;\n\t}\n\t\/\/ Fetch the stock take record\n\tstockTakeRecords = Stock_Takes[ID == stockTakeID];\n\tstockTakeFound = false;\n\tstockTakeNum = &quot;&quot;;\n\tstockTakeDate = &quot;&quot;;\n\tlocationName = &quot;&quot;;\n\tstatus = &quot;&quot;;\n\tlocationID = 0;\n\tfor each  st in stockTakeRecords\n\t{\n\t\tstockTakeFound = true;\n\t\tstockTakeNum = ifnull(st.Stock_Take_Number,&quot;&quot;);\n\t\tstockTakeDate = ifnull(st.Stock_Take_Date,&quot;&quot;);\n\t\tstatus = ifnull(st.Status,&quot;&quot;);\n\t\tlocationID = st.Location;\n\t\tlocRecords = Stock_Locations[ID == locationID];\n\t\tfor each  loc in locRecords\n\t\t{\n\t\t\tlocationName = ifnull(loc.Location_Name,&quot;&quot;);\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t}\n\tif(!stockTakeFound)\n\t{\n\t\thtmlContent = &quot;&lt;p&gt;Stock Take not found. ID: &quot; + stockTakeID + &quot;&lt;\/p&gt;&quot;;\n\t}\n\telse\n\t{\n\t\t\/\/ Base URL for QR codes\n\t\tbaseUrl = &quot;https:\/\/creatorapp.zoho.eu\/quantumbuild1\/rascor-stock-management\/#Form:Quick_Count_Redirect?Line_ID=&quot;;\n\t\t\/\/ Logo URL\n\t\tlogoUrl = &quot;https:\/\/creator.zoho.eu\/appbuilder\/quantumbuild1\/rascor-stock-management\/downLoadImage?imgFileId=5647446000000023086&amp;imgFileName=1764016384124_Rascor-Logo.png&quot;;\n\t\thtmlContent = &quot;&lt;style&gt;@media print { .no-print { display: none; } } table { page-break-inside: auto; } tr { page-break-inside: avoid; }&lt;\/style&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;font-family: Arial, sans-serif; max-width: 900px; margin: 0 auto;&apos;&gt;&quot;;\n\t\t\/\/ Print button\n\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;text-align: right; margin-bottom: 10px;&apos; class=&apos;no-print&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;button onclick=&apos;window.print()&apos; style=&apos;padding: 10px 20px; background-color: #7030A0; color: white; border: none; cursor: pointer;&apos;&gt;Print Count Sheet&lt;\/button&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&quot;;\n\t\t\/\/ Header\n\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;text-align: right;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;img src=&apos;&quot; + logoUrl + &quot;&apos; alt=&apos;RASCOR&apos; style=&apos;height: 60px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;h1 style=&apos;text-align: center; color: #333;&apos;&gt;STOCK COUNT SHEET&lt;\/h1&gt;&quot;;\n\t\t\/\/ Details\n\t\thtmlContent = htmlContent + &quot;&lt;table style=&apos;width: 100%; margin-bottom: 20px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Stock Take #:&lt;\/strong&gt; &quot; + stockTakeNum + &quot;&lt;\/td&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;td&gt;&lt;strong&gt;Date:&lt;\/strong&gt; &quot; + stockTakeDate + &quot;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Location:&lt;\/strong&gt; &quot; + locationName + &quot;&lt;\/td&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;td&gt;&lt;strong&gt;Status:&lt;\/strong&gt; &quot; + status + &quot;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/table&gt;&quot;;\n\t\t\/\/ Count table with QR code and Bay column\n\t\thtmlContent = htmlContent + &quot;&lt;table style=&apos;width: 100%; border-collapse: collapse;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;tr style=&apos;background-color: #7030A0; color: white;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 8px; border: 1px solid #ccc; width: 60px;&apos;&gt;Scan&lt;\/th&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 8px; border: 1px solid #ccc; width: 80px;&apos;&gt;Bay&lt;\/th&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 8px; border: 1px solid #ccc; text-align: left;&apos;&gt;Product&lt;\/th&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 8px; border: 1px solid #ccc; width: 80px;&apos;&gt;Expected&lt;\/th&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 8px; border: 1px solid #ccc; width: 80px;&apos;&gt;Counted&lt;\/th&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;th style=&apos;padding: 8px; border: 1px solid #ccc; width: 120px;&apos;&gt;Notes&lt;\/th&gt;&lt;\/tr&gt;&quot;;\n\t\t\/\/ Get line items sorted by Bay Location\n\t\tlineItems = Stock_Take_Lines[Stock_Take == stockTakeID] sort by Bay_Location asc;\n\t\tfor each  line in lineItems\n\t\t{\n\t\t\tlineID = line.ID;\n\t\t\t\/\/ Get Bay name\n\t\t\tbayName = &quot;&quot;;\n\t\t\tif(line.Bay_Location != null)\n\t\t\t{\n\t\t\t\tbayRecords = Bay_Locations[ID == line.Bay_Location];\n\t\t\t\tfor each  bay in bayRecords\n\t\t\t\t{\n\t\t\t\t\tbayName = ifnull(bay.Bay_Name,&quot;&quot;);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\/\/ Get product name\n\t\t\tproductName = &quot;&quot;;\n\t\t\tprodRecords = Product_Master[ID == line.Product];\n\t\t\tfor each  prod in prodRecords\n\t\t\t{\n\t\t\t\tproductName = ifnull(prod.Product_Name,&quot;&quot;);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\texpectedQty = ifnull(line.Expected_Quantity,0);\n\t\t\t\/\/ QR Code URL\n\t\t\tqrData = baseUrl + lineID;\n\t\t\tqrUrl = &quot;https:\/\/api.qrserver.com\/v1\/create-qr-code\/?size=150x150&amp;data=&quot; + encodeUrl(qrData);\n\t\t\thtmlContent = htmlContent + &quot;&lt;tr&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 4px; border: 1px solid #ccc; text-align: center;&apos;&gt;&lt;img src=&apos;&quot; + qrUrl + &quot;&apos; style=&apos;width: 80px; height: 80px;&apos;&gt;&lt;\/td&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 8px; border: 1px solid #ccc; text-align: center;&apos;&gt;&quot; + bayName + &quot;&lt;\/td&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 8px; border: 1px solid #ccc;&apos;&gt;&quot; + productName + &quot;&lt;\/td&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 8px; border: 1px solid #ccc; text-align: center;&apos;&gt;&quot; + expectedQty + &quot;&lt;\/td&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 8px; border: 1px solid #ccc;&apos;&gt;&lt;\/td&gt;&quot;;\n\t\t\thtmlContent = htmlContent + &quot;&lt;td style=&apos;padding: 8px; border: 1px solid #ccc;&apos;&gt;&lt;\/td&gt;&lt;\/tr&gt;&quot;;\n\t\t}\n\t\thtmlContent = htmlContent + &quot;&lt;\/table&gt;&quot;;\n\t\t\/\/ Signature section\n\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;margin-top: 40px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;p&gt;&lt;strong&gt;Counted By:&lt;\/strong&gt; _________________________ &lt;strong&gt;Date:&lt;\/strong&gt; _____________&lt;\/p&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&quot;;\n\t}\n\t%&gt;\n&lt;%=htmlContent%&gt;\n&lt;%\n\n}%&gt;]]>\n<\/dsp>\n<\/column>\n<\/row>\n<\/layout>\n<\/zml>"
		}
		page Quick_Count
		{
			displayname = "Quick_Count"
			Content="<zml    \t\t\n\t\t\n\t\t\n\t\t\n\t\t\n>\n\t<layout>\n\t<row>\n\t<column\n   \t\t width='100%'\n   \t>\n\t<dsp id='html_snippet11' elementName='HTML Snippet'\n bgColor=\"#FFFFFF\" \n>\n\t<![CDATA[htmlpage html_snippet11()\ncontent\n&lt;%{\n\t\/\/ Get line ID from Parameters\n\tparamRecords = Parameters[ID != 0];\n\tlineID = 0;\n\tfor each  p in paramRecords\n\t{\n\t\tlineID = p.Current_Stock_Take_Line_ID;\n\t\tbreak;\n\t}\n\t\/\/ Fetch the stock take line\n\tlineRecords = Stock_Take_Lines[ID == lineID];\n\tlineFound = false;\n\tproductName = &quot;&quot;;\n\tproductCode = &quot;&quot;;\n\tstockTakeNum = &quot;&quot;;\n\tlocationName = &quot;&quot;;\n\texpectedQty = 0;\n\tcurrentCount = 0;\n\tfor each  l in lineRecords\n\t{\n\t\tlineFound = true;\n\t\texpectedQty = ifnull(l.Expected_Quantity,0);\n\t\tcurrentCount = ifnull(l.Counted_Quantity,0);\n\t\tprodRecords = Product_Master[ID == l.Product];\n\t\tfor each  prod in prodRecords\n\t\t{\n\t\t\tproductName = ifnull(prod.Product_Name,&quot;&quot;);\n\t\t\tproductCode = ifnull(prod.Product_Number,&quot;&quot;);\n\t\t\tbreak;\n\t\t}\n\t\tstRecords = Stock_Takes[ID == l.Stock_Take];\n\t\tfor each  st in stRecords\n\t\t{\n\t\t\tstockTakeNum = ifnull(st.Stock_Take_Number,&quot;&quot;);\n\t\t\tlocRecords = Stock_Locations[ID == st.Location];\n\t\t\tfor each  loc in locRecords\n\t\t\t{\n\t\t\t\tlocationName = ifnull(loc.Location_Name,&quot;&quot;);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t}\n\tformUrl = &quot;#Form:Update_Stock_Count?zc_LoadIn=inline&amp;Line_ID=&quot; + lineID;\n\tif(!lineFound)\n\t{\n\t\thtmlContent = &quot;&lt;div style=&apos;padding: 20px; font-family: Arial;&apos;&gt;&lt;h2&gt;Line not found&lt;\/h2&gt;&lt;p&gt;ID: &quot; + lineID + &quot;&lt;\/p&gt;&lt;\/div&gt;&quot;;\n\t}\n\telse\n\t{\n\t\thtmlContent = &quot;&lt;div style=&apos;font-family: Arial, sans-serif; max-width: 400px; margin: 0 auto; padding: 15px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;background-color: #7030A0; color: white; padding: 15px; border-radius: 8px 8px 0 0; text-align: center;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;h2 style=&apos;margin: 0;&apos;&gt;Quick Count&lt;\/h2&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;p style=&apos;margin: 5px 0 0 0; font-size: 14px;&apos;&gt;&quot; + stockTakeNum + &quot; | &quot; + locationName + &quot;&lt;\/p&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;border: 1px solid #ddd; border-top: none; padding: 20px; border-radius: 0 0 8px 8px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;margin-bottom: 20px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;p style=&apos;color: #666; margin: 0 0 5px 0; font-size: 12px;&apos;&gt;PRODUCT CODE&lt;\/p&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;p style=&apos;margin: 0; font-size: 16px; font-weight: bold;&apos;&gt;&quot; + productCode + &quot;&lt;\/p&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;margin-bottom: 20px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;p style=&apos;color: #666; margin: 0 0 5px 0; font-size: 12px;&apos;&gt;PRODUCT NAME&lt;\/p&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;p style=&apos;margin: 0; font-size: 18px;&apos;&gt;&quot; + productName + &quot;&lt;\/p&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;background-color: #f5f5f5; padding: 15px; border-radius: 8px; margin-bottom: 20px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;p style=&apos;color: #666; margin: 0 0 5px 0; font-size: 12px;&apos;&gt;EXPECTED QUANTITY&lt;\/p&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;p style=&apos;margin: 0; font-size: 24px; font-weight: bold; color: #7030A0;&apos;&gt;&quot; + expectedQty + &quot;&lt;\/p&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;div style=&apos;background-color: #f0f0f0; padding: 15px; border-radius: 8px; margin-bottom: 10px;&apos;&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;p style=&apos;color: #666; margin: 0 0 5px 0; font-size: 12px;&apos;&gt;CURRENT COUNT&lt;\/p&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;p style=&apos;margin: 0; font-size: 24px; font-weight: bold;&apos;&gt;&quot; + currentCount + &quot;&lt;\/p&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;p style=&apos;text-align: center; margin: 20px 0;&apos;&gt;&lt;a href=&apos;&quot; + formUrl + &quot;&apos; style=&apos;display: inline-block; padding: 15px 30px; background-color: #7030A0; color: white; text-decoration: none; border-radius: 8px; font-size: 18px;&apos;&gt;Update Count&lt;\/a&gt;&lt;\/p&gt;&quot;;\n\t\thtmlContent = htmlContent + &quot;&lt;\/div&gt;&lt;\/div&gt;&quot;;\n\t}\n\t%&gt;\n&lt;%=htmlContent%&gt;\n&lt;%\n\n}%&gt;]]>\n<\/dsp>\n<\/column>\n<\/row>\n<\/layout>\n<\/zml>"
		}
	}


		 functions
		 {
			 Deluge
			 {
				 void createOrderWithLines(string orderDate, list productIds, int productCount, int orderNum)
                 {
                 	// Create Stock Order (without site for now)
                 	orderMap = Map();
                 	orderMap.put("Order_Date",orderDate);
                 	orderMap.put("Order_Status","Collected");
                 	newOrder = zoho.creator.createRecord("quantumbuild1","stock-management","Stock_Ordering",orderMap,Map(),"creator_connection");
                 	newOrderId = newOrder.get("ID");
                 	info "Created order " + orderNum + " for " + orderDate;
                 	// Create 2-5 line items
                 	numLines = orderNum % 4 + 2;
                 	for each  lineIndex in {1,2,3,4,5}
                 	{
                 		if(lineIndex <= numLines)
                 		{
                 			// Select a product
                 			productIndex = (orderNum * 3 + lineIndex) % productCount;
                 			productId = productIds.get(productIndex);
                 			// Quantity 1-20
                 			qty = (orderNum + lineIndex) % 20 + 1;
                 			// Create line item
                 			lineMap = Map();
                 			lineMap.put("Order",newOrderId);
                 			lineMap.put("Product",productId);
                 			lineMap.put("Quantity",qty);
                 			lineMap.put("Line_Status","Issued");
                 			zoho.creator.createRecord("quantumbuild1","stock-management","Order_Line_Items",lineMap,Map(),"creator_connection");
                 		}
                 	}
                 }
				 void fn_BackfillPONumbers()
                 {
                 	// Get all POs without a PO Number
                 	poRecords = Purchase_Orders[PO_Number == null || PO_Number == ""];
                 	for each  po in poRecords
                 	{
                 		// Generate PO Number based on creation date
                 		dateStr = po.Order_Date.toString("yyMMdd");
                 		// Count existing POs for that date to get sequence
                 		existingCount = Purchase_Orders[PO_Number.startsWith("PO-" + dateStr)].count();
                 		sequence = existingCount + 1;
                 		// Manual padding
                 		if(sequence < 10)
                 		{
                 			sequenceStr = "00" + sequence;
                 		}
                 		else if(sequence < 100)
                 		{
                 			sequenceStr = "0" + sequence;
                 		}
                 		else
                 		{
                 			sequenceStr = sequence.toString();
                 		}
                 		poNumber = "PO-" + dateStr + "-" + sequenceStr;
                 		po.PO_Number=poNumber;
                 	}
                 }
				 void fn_BackfillSiteNames_NoAPI()
                 {
                 	// Hardcoded site map - for one-time backfill only
                 	siteCache = Map();
                 	siteCache.put("244136000000222048","Quantum Build");
                 	siteCache.put("244136000000222052","RASCOR HQ");
                 	siteCache.put("244136000000222056","South West Gate");
                 	siteCache.put("244136000000110041","Marmalade Lane");
                 	siteCache.put("244136000000222064","Rathbourne Crossing");
                 	siteCache.put("244136000000110049","Castleforbes Prem Inn");
                 	siteCache.put("244136000000222072","Angem");
                 	siteCache.put("244136000000222076","Oscar Trainer Road");
                 	siteCache.put("244136000000222080","Eden");
                 	siteCache.put("244136000000222084","Jacobs Island");
                 	siteCache.put("244136000000110069","Ford");
                 	siteCache.put("244136000000222092","Tile 6");
                 	siteCache.put("244136000000222096","Montrose");
                 	siteCache.put("244136000000110081","Donore");
                 	// Get orders without site name
                 	orders = Stock_Ordering[Site_Name_Stored == null || Site_Name_Stored == ""];
                 	updatedCount = 0;
                 	notFoundCount = 0;
                 	for each  ord in orders
                 	{
                 		if(ord.Sites_Reference != null)
                 		{
                 			siteIdStr = ord.Sites_Reference.toString();
                 			siteName = siteCache.get(siteIdStr);
                 			if(siteName != null)
                 			{
                 				ord.Site_Name_Stored=siteName;
                 				updatedCount = updatedCount + 1;
                 			}
                 			else
                 			{
                 				notFoundCount = notFoundCount + 1;
                 			}
                 		}
                 	}
                 	info "Updated: " + updatedCount + " | Not in cache: " + notFoundCount;
                 }
				 void fn_ClearOrderLineItems()
                 {
                 	allLines = Order_Line_Items[ID != null];
                 	count = allLines.count();
                 	for each  rec in allLines
                 	{
                 		delete from Order_Line_Items[ID == rec.ID];
                 	}
                 	info "Deleted " + count + " Order Line Items";
                 }
				 void fn_ClearPOLineItems()
                 {
                 	allLines = PO_Line_Items[ID != null];
                 	count = allLines.count();
                 	for each  rec in allLines
                 	{
                 		delete from PO_Line_Items[ID == rec.ID];
                 	}
                 	info "Deleted " + count + " PO Line Items";
                 }
				 void fn_ClearPurchaseOrders()
                 {
                 	allPOs = Purchase_Orders[ID != null];
                 	count = allPOs.count();
                 	for each  rec in allPOs
                 	{
                 		delete from Purchase_Orders[ID == rec.ID];
                 	}
                 	info "Deleted " + count + " Purchase Orders";
                 }
				 void fn_ClearStockLevels()
                 {
                 	allLevels = Stock_Levels[ID != null];
                 	count = allLevels.count();
                 	for each  rec in allLevels
                 	{
                 		delete from Stock_Levels[ID == rec.ID];
                 	}
                 	info "Deleted " + count + " Stock Levels";
                 }
				 void fn_ClearStockOrders()
                 {
                 	allOrders = Stock_Ordering[ID != null];
                 	count = allOrders.count();
                 	for each  rec in allOrders
                 	{
                 		delete from Stock_Ordering[ID == rec.ID];
                 	}
                 	info "Deleted " + count + " Stock Orders";
                 }
				 void fn_ClearStockTransactions()
                 {
                 	allTxns = Stock_Transactions[ID != null];
                 	count = allTxns.count();
                 	for each  rec in allTxns
                 	{
                 		delete from Stock_Transactions[ID == rec.ID];
                 	}
                 	info "Deleted " + count + " Stock Transactions";
                 }
				 void fn_ClearTestData()
                 {
                 }
				 void fn_CreateProcoreProject(int proposalId)
                 {
                 	// ===== GET PROPOSAL =====
                 	proposalResp = Project_Proposals[ID == proposalId];
                 	if(proposalResp.count() == 0)
                 	{
                 		info "ERROR: Proposal not found";
                 		return;
                 	}
                 	proposal = null;
                 	for each  rec in proposalResp
                 	{
                 		proposal = rec;
                 		break;
                 	}
                 	// Check if already synced
                 	existingProcoreId = ifnull(proposal.Procore_Project_ID,"");
                 	if(existingProcoreId != "")
                 	{
                 		info "Proposal already synced to Procore: " + existingProcoreId;
                 		return;
                 	}
                 	// ===== GET PROCORE SETTINGS =====
                 	settingsResp = Procore_Settings[Is_Active == true];
                 	if(settingsResp.count() == 0)
                 	{
                 		info "ERROR: No active Procore settings found";
                 		return;
                 	}
                 	config = null;
                 	for each  setting in settingsResp
                 	{
                 		config = setting;
                 		break;
                 	}
                 	clientId = config.Client_ID;
                 	clientSecret = config.Client_Secret;
                 	companyId = config.Company_ID;
                 	apiBase = config.API_Base_URL;
                 	authUrl = config.Auth_URL;
                 	// ===== GET ACCESS TOKEN =====
                 	tokenParams = Map();
                 	tokenParams.put("grant_type","client_credentials");
                 	tokenParams.put("client_id",clientId);
                 	tokenParams.put("client_secret",clientSecret);
                 	tokenResp = invokeurl
                 	[
                 		url :authUrl
                 		type :POST
                 		parameters:tokenParams
                 	];
                 	accessToken = tokenResp.get("access_token");
                 	if(accessToken == null)
                 	{
                 		info "ERROR: Failed to get access token";
                 		return;
                 	}
                 	// ===== BUILD PROJECT DATA =====
                 	projectName = ifnull(proposal.Project_Name,"Unnamed Project");
                 	proposalNumber = ifnull(proposal.Proposal_Number,"");
                 	// Build inner project map
                 	projectInner = Map();
                 	projectInner.put("name",projectName);
                 	if(proposalNumber != "")
                 	{
                 		projectInner.put("project_number",proposalNumber);
                 	}
                 	// Address fields - handle nulls
                 	addressField = proposal.Address;
                 	if(addressField != null)
                 	{
                 		addressLine = ifnull(addressField.address_line_1,"");
                 		city = ifnull(addressField.district_city,"");
                 		postalCode = ifnull(addressField.postal_Code,"");
                 		country = ifnull(addressField.country,"");
                 		if(addressLine != "")
                 		{
                 			projectInner.put("address",addressLine);
                 		}
                 		if(city != "")
                 		{
                 			projectInner.put("city",city);
                 		}
                 		if(postalCode != "")
                 		{
                 			projectInner.put("zip",postalCode);
                 		}
                 		// Map country to code
                 		if(country != "")
                 		{
                 			countryCode = "US";
                 			if(country.containsIgnoreCase("Ireland"))
                 			{
                 				countryCode = "IE";
                 			}
                 			else if(country.containsIgnoreCase("United Kingdom") || country.containsIgnoreCase("UK"))
                 			{
                 				countryCode = "GB";
                 			}
                 			else if(country.containsIgnoreCase("United States") || country.containsIgnoreCase("USA"))
                 			{
                 				countryCode = "US";
                 			}
                 			projectInner.put("country_code",countryCode);
                 		}
                 	}
                 	// Estimated start date
                 	startDate = proposal.Estimated_Start;
                 	if(startDate != null)
                 	{
                 		projectInner.put("estimated_start_date",startDate.toString("yyyy-MM-dd"));
                 	}
                 	// Estimated value (Agreed_Price)
                 	agreedPrice = proposal.Agreed_Price;
                 	if(agreedPrice != null && agreedPrice > 0)
                 	{
                 		projectInner.put("estimated_value",agreedPrice);
                 	}
                 	// Description (Notes)
                 	notes = ifnull(proposal.Notes,"");
                 	if(notes != "")
                 	{
                 		projectInner.put("description",notes);
                 	}
                 	// Wrap in project object
                 	projectData = Map();
                 	projectData.put("project",projectInner);
                 	// ===== CREATE PROJECT IN PROCORE =====
                 	createUrl = apiBase + "/rest/v1.0/projects?company_id=" + companyId;
                 	headerMap = Map();
                 	headerMap.put("Authorization","Bearer " + accessToken);
                 	headerMap.put("Procore-Company-Id",companyId);
                 	headerMap.put("Content-Type","application/json");
                 	createResp = invokeurl
                 	[
                 		url :createUrl
                 		type :POST
                 		parameters:projectData.toString()
                 		headers:headerMap
                 	];
                 	// ===== UPDATE PROPOSAL WITH PROCORE ID =====
                 	newProcoreId = createResp.get("id");
                 	if(newProcoreId != null)
                 	{
                 		proposal.Procore_Project_ID=newProcoreId.toString();
                 		info "SUCCESS: Created Procore project " + newProcoreId;
                 	}
                 	else
                 	{
                 		info "ERROR: " + createResp.toString();
                 	}
                 }
				 void fn_CreateTestData()
                 {
                 	// Get products
                 	allProducts = Product_Master[ID != null];
                 	productIds = List();
                 	for each  prod in allProducts
                 	{
                 		productIds.add(prod.ID);
                 	}
                 	productCount = productIds.size();
                 	info "Found " + productCount + " products";
                 	// Location ID (Main Warehouse)
                 	locationId = 244136000001012003;
                 	// Site IDs and Names (excluding RASCOR HQ)
                 	siteIds = List();
                 	siteNames = List();
                 	siteIds.add(244136000000222048);
                 	siteNames.add("Quantum Build");
                 	siteIds.add(244136000000222056);
                 	siteNames.add("South West Gate");
                 	siteIds.add(244136000000110041);
                 	siteNames.add("Marmalade Lane");
                 	siteIds.add(244136000000222064);
                 	siteNames.add("Rathbourne Crossing");
                 	siteIds.add(244136000000110049);
                 	siteNames.add("Castleforbes Prem Inn");
                 	siteIds.add(244136000000222080);
                 	siteNames.add("Eden");
                 	siteIds.add(244136000000110069);
                 	siteNames.add("Ford");
                 	siteCount = siteIds.size();
                 	orderNum = 1;
                 	totalLines = 0;
                 	// ========== SEPTEMBER 2025 (10 Collected) ==========
                 	for each  day in {1,3,5,8,10,13,16,19,23,27}
                 	{
                 		orderDate = '01-Sep-2025'.addDay(day - 1);
                 		siteIndex = orderNum % siteCount;
                 		siteId = siteIds.get(siteIndex);
                 		siteName = siteNames.get(siteIndex);
                 		newOrder = insert into Stock_Ordering
                 		[
                 			Order_Date=orderDate
                 			Order_Status="Collected"
                 			Sites_Reference=siteId
                 			Site_Name_Stored=siteName
                 			Source_Location=locationId
                 			Added_User=zoho.loginuser
                 		];
                 		numLines = orderNum % 4 + 2;
                 		for each  lineIndex in {1,2,3,4,5}
                 		{
                 			if(lineIndex <= numLines)
                 			{
                 				productIndex = (orderNum * 3 + lineIndex) % productCount;
                 				productId = productIds.get(productIndex);
                 				qty = (orderNum + lineIndex) % 20 + 1;
                 				insert into Order_Line_Items
                 				[
                 					Order=newOrder
                 					Product=productId
                 					Quantity=qty
                 					Line_Status="Issued"
                 					Added_User=zoho.loginuser
                 				]
                 				totalLines = totalLines + 1;
                 			}
                 		}
                 		orderNum = orderNum + 1;
                 	}
                 	// ========== OCTOBER 2025 (12 Collected) ==========
                 	for each  day in {1,3,6,8,11,14,17,19,22,24,27,30}
                 	{
                 		orderDate = '01-Oct-2025'.addDay(day - 1);
                 		siteIndex = orderNum % siteCount;
                 		siteId = siteIds.get(siteIndex);
                 		siteName = siteNames.get(siteIndex);
                 		newOrder = insert into Stock_Ordering
                 		[
                 			Order_Date=orderDate
                 			Order_Status="Collected"
                 			Sites_Reference=siteId
                 			Site_Name_Stored=siteName
                 			Source_Location=locationId
                 			Added_User=zoho.loginuser
                 		];
                 		numLines = orderNum % 4 + 2;
                 		for each  lineIndex in {1,2,3,4,5}
                 		{
                 			if(lineIndex <= numLines)
                 			{
                 				productIndex = (orderNum * 3 + lineIndex) % productCount;
                 				productId = productIds.get(productIndex);
                 				qty = (orderNum + lineIndex) % 20 + 1;
                 				insert into Order_Line_Items
                 				[
                 					Order=newOrder
                 					Product=productId
                 					Quantity=qty
                 					Line_Status="Issued"
                 					Added_User=zoho.loginuser
                 				]
                 				totalLines = totalLines + 1;
                 			}
                 		}
                 		orderNum = orderNum + 1;
                 	}
                 	// ========== NOVEMBER 2025 (10 Collected) ==========
                 	for each  day in {2,5,8,11,14,17,20,23,26,29}
                 	{
                 		orderDate = '01-Nov-2025'.addDay(day - 1);
                 		siteIndex = orderNum % siteCount;
                 		siteId = siteIds.get(siteIndex);
                 		siteName = siteNames.get(siteIndex);
                 		newOrder = insert into Stock_Ordering
                 		[
                 			Order_Date=orderDate
                 			Order_Status="Collected"
                 			Sites_Reference=siteId
                 			Site_Name_Stored=siteName
                 			Source_Location=locationId
                 			Added_User=zoho.loginuser
                 		];
                 		numLines = orderNum % 4 + 2;
                 		for each  lineIndex in {1,2,3,4,5}
                 		{
                 			if(lineIndex <= numLines)
                 			{
                 				productIndex = (orderNum * 3 + lineIndex) % productCount;
                 				productId = productIds.get(productIndex);
                 				qty = (orderNum + lineIndex) % 20 + 1;
                 				insert into Order_Line_Items
                 				[
                 					Order=newOrder
                 					Product=productId
                 					Quantity=qty
                 					Line_Status="Issued"
                 					Added_User=zoho.loginuser
                 				]
                 				totalLines = totalLines + 1;
                 			}
                 		}
                 		orderNum = orderNum + 1;
                 	}
                 	// ========== DECEMBER 2025 (6 Collected) ==========
                 	for each  day in {1,3,5,8,10,12}
                 	{
                 		orderDate = '01-Dec-2025'.addDay(day - 1);
                 		siteIndex = orderNum % siteCount;
                 		siteId = siteIds.get(siteIndex);
                 		siteName = siteNames.get(siteIndex);
                 		newOrder = insert into Stock_Ordering
                 		[
                 			Order_Date=orderDate
                 			Order_Status="Collected"
                 			Sites_Reference=siteId
                 			Site_Name_Stored=siteName
                 			Source_Location=locationId
                 			Added_User=zoho.loginuser
                 		];
                 		numLines = orderNum % 4 + 2;
                 		for each  lineIndex in {1,2,3,4,5}
                 		{
                 			if(lineIndex <= numLines)
                 			{
                 				productIndex = (orderNum * 3 + lineIndex) % productCount;
                 				productId = productIds.get(productIndex);
                 				qty = (orderNum + lineIndex) % 20 + 1;
                 				insert into Order_Line_Items
                 				[
                 					Order=newOrder
                 					Product=productId
                 					Quantity=qty
                 					Line_Status="Issued"
                 					Added_User=zoho.loginuser
                 				]
                 				totalLines = totalLines + 1;
                 			}
                 		}
                 		orderNum = orderNum + 1;
                 	}
                 	info "Created " + (orderNum - 1) + " orders with " + totalLines + " line items";
                 }
				 void fn_CreateTestData_Active()
                 {
                 	// Get products
                 	allProducts = Product_Master[ID != null];
                 	productIds = List();
                 	for each  prod in allProducts
                 	{
                 		productIds.add(prod.ID);
                 	}
                 	productCount = productIds.size();
                 	// Location ID (Main Warehouse)
                 	locationId = 244136000001012003;
                 	// Site IDs and Names
                 	siteIds = List();
                 	siteNames = List();
                 	siteIds.add(244136000000222048);
                 	siteNames.add("Quantum Build");
                 	siteIds.add(244136000000222056);
                 	siteNames.add("South West Gate");
                 	siteIds.add(244136000000110041);
                 	siteNames.add("Marmalade Lane");
                 	siteIds.add(244136000000222064);
                 	siteNames.add("Rathbourne Crossing");
                 	siteIds.add(244136000000110049);
                 	siteNames.add("Castleforbes Prem Inn");
                 	siteIds.add(244136000000222080);
                 	siteNames.add("Eden");
                 	siteIds.add(244136000000110069);
                 	siteNames.add("Ford");
                 	siteCount = siteIds.size();
                 	orderNum = 1;
                 	totalLines = 0;
                 	// ========== DRAFT ORDERS (8) ==========
                 	for each  day in {10,11,12,13,14,14,15,15}
                 	{
                 		orderDate = '01-Dec-2025'.addDay(day - 1);
                 		siteIndex = orderNum % siteCount;
                 		siteId = siteIds.get(siteIndex);
                 		siteName = siteNames.get(siteIndex);
                 		newOrder = insert into Stock_Ordering
                 		[
                 			Order_Date=orderDate
                 			Order_Status="Draft"
                 			Sites_Reference=siteId
                 			Site_Name_Stored=siteName
                 			Source_Location=locationId
                 			Added_User=zoho.loginuser
                 		];
                 		numLines = orderNum % 3 + 2;
                 		for each  lineIndex in {1,2,3,4}
                 		{
                 			if(lineIndex <= numLines)
                 			{
                 				productIndex = (orderNum * 5 + lineIndex) % productCount;
                 				productId = productIds.get(productIndex);
                 				qty = (orderNum + lineIndex) % 15 + 1;
                 				insert into Order_Line_Items
                 				[
                 					Order=newOrder
                 					Product=productId
                 					Quantity=qty
                 					Line_Status="Pending"
                 					Added_User=zoho.loginuser
                 				]
                 				totalLines = totalLines + 1;
                 			}
                 		}
                 		orderNum = orderNum + 1;
                 	}
                 	// ========== PENDING APPROVAL ORDERS (12) ==========
                 	for each  day in {8,9,9,10,10,11,11,12,12,13,13,14}
                 	{
                 		orderDate = '01-Dec-2025'.addDay(day - 1);
                 		siteIndex = orderNum % siteCount;
                 		siteId = siteIds.get(siteIndex);
                 		siteName = siteNames.get(siteIndex);
                 		newOrder = insert into Stock_Ordering
                 		[
                 			Order_Date=orderDate
                 			Order_Status="Pending Approval"
                 			Sites_Reference=siteId
                 			Site_Name_Stored=siteName
                 			Source_Location=locationId
                 			Added_User=zoho.loginuser
                 		];
                 		numLines = orderNum % 3 + 2;
                 		for each  lineIndex in {1,2,3,4}
                 		{
                 			if(lineIndex <= numLines)
                 			{
                 				productIndex = (orderNum * 7 + lineIndex) % productCount;
                 				productId = productIds.get(productIndex);
                 				qty = (orderNum + lineIndex) % 12 + 1;
                 				insert into Order_Line_Items
                 				[
                 					Order=newOrder
                 					Product=productId
                 					Quantity=qty
                 					Line_Status="Pending"
                 					Added_User=zoho.loginuser
                 				]
                 				totalLines = totalLines + 1;
                 			}
                 		}
                 		orderNum = orderNum + 1;
                 	}
                 	// ========== AWAITING PICK ORDERS (10) ==========
                 	for each  day in {6,7,8,9,10,11,12,13,14,15}
                 	{
                 		orderDate = '01-Dec-2025'.addDay(day - 1);
                 		siteIndex = orderNum % siteCount;
                 		siteId = siteIds.get(siteIndex);
                 		siteName = siteNames.get(siteIndex);
                 		newOrder = insert into Stock_Ordering
                 		[
                 			Order_Date=orderDate
                 			Order_Status="Awaiting Pick"
                 			Sites_Reference=siteId
                 			Site_Name_Stored=siteName
                 			Source_Location=locationId
                 			Added_User=zoho.loginuser
                 		];
                 		numLines = orderNum % 3 + 2;
                 		for each  lineIndex in {1,2,3,4}
                 		{
                 			if(lineIndex <= numLines)
                 			{
                 				productIndex = (orderNum * 4 + lineIndex) % productCount;
                 				productId = productIds.get(productIndex);
                 				qty = (orderNum + lineIndex) % 10 + 1;
                 				insert into Order_Line_Items
                 				[
                 					Order=newOrder
                 					Product=productId
                 					Quantity=qty
                 					Line_Status="Approved"
                 					Added_User=zoho.loginuser
                 				]
                 				totalLines = totalLines + 1;
                 			}
                 		}
                 		orderNum = orderNum + 1;
                 	}
                 	// ========== AWAITING COLLECTION ORDERS (8) ==========
                 	for each  day in {5,7,9,10,11,12,13,14}
                 	{
                 		orderDate = '01-Dec-2025'.addDay(day - 1);
                 		siteIndex = orderNum % siteCount;
                 		siteId = siteIds.get(siteIndex);
                 		siteName = siteNames.get(siteIndex);
                 		newOrder = insert into Stock_Ordering
                 		[
                 			Order_Date=orderDate
                 			Order_Status="Awaiting Collection"
                 			Sites_Reference=siteId
                 			Site_Name_Stored=siteName
                 			Source_Location=locationId
                 			Added_User=zoho.loginuser
                 		];
                 		numLines = orderNum % 3 + 2;
                 		for each  lineIndex in {1,2,3,4}
                 		{
                 			if(lineIndex <= numLines)
                 			{
                 				productIndex = (orderNum * 6 + lineIndex) % productCount;
                 				productId = productIds.get(productIndex);
                 				qty = (orderNum + lineIndex) % 8 + 1;
                 				insert into Order_Line_Items
                 				[
                 					Order=newOrder
                 					Product=productId
                 					Quantity=qty
                 					Line_Status="Picked"
                 					Added_User=zoho.loginuser
                 				]
                 				totalLines = totalLines + 1;
                 			}
                 		}
                 		orderNum = orderNum + 1;
                 	}
                 	// ========== REJECTED ORDERS (2) ==========
                 	for each  day in {3,8}
                 	{
                 		orderDate = '01-Dec-2025'.addDay(day - 1);
                 		siteIndex = orderNum % siteCount;
                 		siteId = siteIds.get(siteIndex);
                 		siteName = siteNames.get(siteIndex);
                 		newOrder = insert into Stock_Ordering
                 		[
                 			Order_Date=orderDate
                 			Order_Status="Rejected"
                 			Sites_Reference=siteId
                 			Site_Name_Stored=siteName
                 			Source_Location=locationId
                 			Added_User=zoho.loginuser
                 		];
                 		numLines = 2;
                 		for each  lineIndex in {1,2}
                 		{
                 			productIndex = (orderNum * 2 + lineIndex) % productCount;
                 			productId = productIds.get(productIndex);
                 			qty = lineIndex + 1;
                 			insert into Order_Line_Items
                 			[
                 				Order=newOrder
                 				Product=productId
                 				Quantity=qty
                 				Line_Status="Rejected"
                 				Added_User=zoho.loginuser
                 			]
                 			totalLines = totalLines + 1;
                 		}
                 		orderNum = orderNum + 1;
                 	}
                 	// ========== CANCELLED ORDERS (2) ==========
                 	for each  day in {2,6}
                 	{
                 		orderDate = '01-Dec-2025'.addDay(day - 1);
                 		siteIndex = orderNum % siteCount;
                 		siteId = siteIds.get(siteIndex);
                 		siteName = siteNames.get(siteIndex);
                 		newOrder = insert into Stock_Ordering
                 		[
                 			Order_Date=orderDate
                 			Order_Status="Cancelled"
                 			Sites_Reference=siteId
                 			Site_Name_Stored=siteName
                 			Source_Location=locationId
                 			Added_User=zoho.loginuser
                 		];
                 		numLines = 2;
                 		for each  lineIndex in {1,2}
                 		{
                 			productIndex = (orderNum * 3 + lineIndex) % productCount;
                 			productId = productIds.get(productIndex);
                 			qty = lineIndex + 2;
                 			insert into Order_Line_Items
                 			[
                 				Order=newOrder
                 				Product=productId
                 				Quantity=qty
                 				Line_Status="Cancelled"
                 				Added_User=zoho.loginuser
                 			]
                 			totalLines = totalLines + 1;
                 		}
                 		orderNum = orderNum + 1;
                 	}
                 	info "Created " + (orderNum - 1) + " active orders with " + totalLines + " line items";
                 }
				 void fn_CreateTestOrders_Batch1()
                 {
                 }
				 void fn_CreateTestPurchaseOrders()
                 {
                 	// Get products with their base rates
                 	allProducts = Product_Master[ID != null];
                 	productIds = List();
                 	productRates = Map();
                 	for each  prod in allProducts
                 	{
                 		productIds.add(prod.ID);
                 		productRates.put(prod.ID.toString(),ifnull(prod.Base_Rate,10.00));
                 	}
                 	productCount = productIds.size();
                 	// Get suppliers
                 	allSuppliers = Suppliers[ID != null];
                 	supplierIds = List();
                 	for each  sup in allSuppliers
                 	{
                 		supplierIds.add(sup.ID);
                 	}
                 	supplierCount = supplierIds.size();
                 	info "Found " + productCount + " products and " + supplierCount + " suppliers";
                 	// Location ID (Main Warehouse)
                 	locationId = 244136000001012003;
                 	poNum = 1;
                 	totalLines = 0;
                 	// ========== FULLY RECEIVED POs (10) - Historical ==========
                 	for each  day in {5,10,15,20,25,30,5,10,15,20}
                 	{
                 		poDate = '01-Sep-2025'.addDay(day - 1 + (poNum - 1) / 5 * 30);
                 		supplierIndex = poNum % supplierCount;
                 		supplierId = supplierIds.get(supplierIndex);
                 		newPO = insert into Purchase_Orders
                 		[
                 			Order_Date=poDate
                 			PO_Status="Fully Received"
                 			Supplier=supplierId
                 			Delivery_Location=locationId
                 			Added_User=zoho.loginuser
                 		];
                 		numLines = poNum % 3 + 2;
                 		for each  lineIndex in {1,2,3,4}
                 		{
                 			if(lineIndex <= numLines)
                 			{
                 				productIndex = (poNum * 4 + lineIndex) % productCount;
                 				productId = productIds.get(productIndex);
                 				qty = (poNum + lineIndex) * 5;
                 				unitPrice = productRates.get(productId.toString());
                 				insert into PO_Line_Items
                 				[
                 					Purchase_Order=newPO
                 					Product=productId
                 					Quantity_Ordered=qty
                 					Quantity_Received=qty
                 					Unit_Price=unitPrice
                 					Line_Status="Received"
                 					Added_User=zoho.loginuser
                 				]
                 				totalLines = totalLines + 1;
                 			}
                 		}
                 		poNum = poNum + 1;
                 	}
                 	// ========== PARTIALLY RECEIVED POs (8) ==========
                 	for each  day in {1,5,8,12,15,18,22,25}
                 	{
                 		poDate = '01-Nov-2025'.addDay(day - 1);
                 		supplierIndex = poNum % supplierCount;
                 		supplierId = supplierIds.get(supplierIndex);
                 		newPO = insert into Purchase_Orders
                 		[
                 			Order_Date=poDate
                 			PO_Status="Partially Received"
                 			Supplier=supplierId
                 			Delivery_Location=locationId
                 			Added_User=zoho.loginuser
                 		];
                 		numLines = poNum % 3 + 2;
                 		for each  lineIndex in {1,2,3,4}
                 		{
                 			if(lineIndex <= numLines)
                 			{
                 				productIndex = (poNum * 5 + lineIndex) % productCount;
                 				productId = productIds.get(productIndex);
                 				qty = (poNum + lineIndex) * 5;
                 				qtyReceived = qty / 2;
                 				unitPrice = productRates.get(productId.toString());
                 				insert into PO_Line_Items
                 				[
                 					Purchase_Order=newPO
                 					Product=productId
                 					Quantity_Ordered=qty
                 					Quantity_Received=qtyReceived
                 					Unit_Price=unitPrice
                 					Line_Status="Partial"
                 					Added_User=zoho.loginuser
                 				]
                 				totalLines = totalLines + 1;
                 			}
                 		}
                 		poNum = poNum + 1;
                 	}
                 	// ========== CONFIRMED POs (10) - Open ==========
                 	for each  day in {1,3,5,7,9,10,11,12,13,14}
                 	{
                 		poDate = '01-Dec-2025'.addDay(day - 1);
                 		supplierIndex = poNum % supplierCount;
                 		supplierId = supplierIds.get(supplierIndex);
                 		newPO = insert into Purchase_Orders
                 		[
                 			Order_Date=poDate
                 			PO_Status="Confirmed"
                 			Supplier=supplierId
                 			Delivery_Location=locationId
                 			Added_User=zoho.loginuser
                 		];
                 		numLines = poNum % 3 + 2;
                 		for each  lineIndex in {1,2,3,4}
                 		{
                 			if(lineIndex <= numLines)
                 			{
                 				productIndex = (poNum * 6 + lineIndex) % productCount;
                 				productId = productIds.get(productIndex);
                 				qty = (poNum + lineIndex) * 5;
                 				unitPrice = productRates.get(productId.toString());
                 				insert into PO_Line_Items
                 				[
                 					Purchase_Order=newPO
                 					Product=productId
                 					Quantity_Ordered=qty
                 					Quantity_Received=0
                 					Unit_Price=unitPrice
                 					Line_Status="Pending"
                 					Added_User=zoho.loginuser
                 				]
                 				totalLines = totalLines + 1;
                 			}
                 		}
                 		poNum = poNum + 1;
                 	}
                 	// ========== DRAFT POs (5) ==========
                 	for each  day in {12,13,14,14,15}
                 	{
                 		poDate = '01-Dec-2025'.addDay(day - 1);
                 		supplierIndex = poNum % supplierCount;
                 		supplierId = supplierIds.get(supplierIndex);
                 		newPO = insert into Purchase_Orders
                 		[
                 			Order_Date=poDate
                 			PO_Status="Draft"
                 			Supplier=supplierId
                 			Delivery_Location=locationId
                 			Added_User=zoho.loginuser
                 		];
                 		numLines = poNum % 2 + 2;
                 		for each  lineIndex in {1,2,3}
                 		{
                 			if(lineIndex <= numLines)
                 			{
                 				productIndex = (poNum * 7 + lineIndex) % productCount;
                 				productId = productIds.get(productIndex);
                 				qty = (poNum + lineIndex) * 3;
                 				unitPrice = productRates.get(productId.toString());
                 				insert into PO_Line_Items
                 				[
                 					Purchase_Order=newPO
                 					Product=productId
                 					Quantity_Ordered=qty
                 					Quantity_Received=0
                 					Unit_Price=unitPrice
                 					Line_Status="Draft"
                 					Added_User=zoho.loginuser
                 				]
                 				totalLines = totalLines + 1;
                 			}
                 		}
                 		poNum = poNum + 1;
                 	}
                 	// ========== CANCELLED POs (2) ==========
                 	for each  day in {5,10}
                 	{
                 		poDate = '01-Dec-2025'.addDay(day - 1);
                 		supplierIndex = poNum % supplierCount;
                 		supplierId = supplierIds.get(supplierIndex);
                 		newPO = insert into Purchase_Orders
                 		[
                 			Order_Date=poDate
                 			PO_Status="Cancelled"
                 			Supplier=supplierId
                 			Delivery_Location=locationId
                 			Added_User=zoho.loginuser
                 		];
                 		for each  lineIndex in {1,2}
                 		{
                 			productIndex = (poNum * 3 + lineIndex) % productCount;
                 			productId = productIds.get(productIndex);
                 			qty = lineIndex * 10;
                 			unitPrice = productRates.get(productId.toString());
                 			insert into PO_Line_Items
                 			[
                 				Purchase_Order=newPO
                 				Product=productId
                 				Quantity_Ordered=qty
                 				Quantity_Received=0
                 				Unit_Price=unitPrice
                 				Line_Status="Cancelled"
                 				Added_User=zoho.loginuser
                 			]
                 			totalLines = totalLines + 1;
                 		}
                 		poNum = poNum + 1;
                 	}
                 	info "Created " + (poNum - 1) + " purchase orders with " + totalLines + " line items";
                 }
				 void fn_CreateTestStockLevels()
                 {
                 	// Get products
                 	allProducts = Product_Master[ID != null];
                 	productIds = List();
                 	for each  prod in allProducts
                 	{
                 		productIds.add(prod.ID);
                 	}
                 	productCount = productIds.size();
                 	// Location ID (Main Warehouse)
                 	locationId = 244136000001012003;
                 	created = 0;
                 	// Create stock levels for first 80 products with varied quantities
                 	// Normal stock (1-20)
                 	for each  i in {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20}
                 	{
                 		if(i <= productCount)
                 		{
                 			productId = productIds.get(i - 1);
                 			qty = 50 + (i * 7) % 100;
                 			insert into Stock_Levels
                 			[
                 				Product=productId
                 				Location=locationId
                 				Quantity_On_Hand=qty
                 				Added_User=zoho.loginuser
                 			]
                 			created = created + 1;
                 		}
                 	}
                 	// More normal stock (21-40)
                 	for each  i in {21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40}
                 	{
                 		if(i <= productCount)
                 		{
                 			productId = productIds.get(i - 1);
                 			qty = 30 + (i * 5) % 80;
                 			insert into Stock_Levels
                 			[
                 				Product=productId
                 				Location=locationId
                 				Quantity_On_Hand=qty
                 				Added_User=zoho.loginuser
                 			]
                 			created = created + 1;
                 		}
                 	}
                 	// More normal stock (41-50)
                 	for each  i in {41,42,43,44,45,46,47,48,49,50}
                 	{
                 		if(i <= productCount)
                 		{
                 			productId = productIds.get(i - 1);
                 			qty = 25 + (i * 3) % 50;
                 			insert into Stock_Levels
                 			[
                 				Product=productId
                 				Location=locationId
                 				Quantity_On_Hand=qty
                 				Added_User=zoho.loginuser
                 			]
                 			created = created + 1;
                 		}
                 	}
                 	// Low stock (51-65)
                 	for each  i in {51,52,53,54,55,56,57,58,59,60,61,62,63,64,65}
                 	{
                 		if(i <= productCount)
                 		{
                 			productId = productIds.get(i - 1);
                 			qty = 3 + i % 7;
                 			insert into Stock_Levels
                 			[
                 				Product=productId
                 				Location=locationId
                 				Quantity_On_Hand=qty
                 				Added_User=zoho.loginuser
                 			]
                 			created = created + 1;
                 		}
                 	}
                 	// Critical stock - near zero (66-75)
                 	for each  i in {66,67,68,69,70,71,72,73,74,75}
                 	{
                 		if(i <= productCount)
                 		{
                 			productId = productIds.get(i - 1);
                 			qty = 1 + i % 3;
                 			insert into Stock_Levels
                 			[
                 				Product=productId
                 				Location=locationId
                 				Quantity_On_Hand=qty
                 				Added_User=zoho.loginuser
                 			]
                 			created = created + 1;
                 		}
                 	}
                 	// Out of stock - zero quantity (76-80)
                 	for each  i in {76,77,78,79,80}
                 	{
                 		if(i <= productCount)
                 		{
                 			productId = productIds.get(i - 1);
                 			qty = 0;
                 			insert into Stock_Levels
                 			[
                 				Product=productId
                 				Location=locationId
                 				Quantity_On_Hand=qty
                 				Added_User=zoho.loginuser
                 			]
                 			created = created + 1;
                 		}
                 	}
                 	info "Created " + created + " stock level records";
                 }
				 string fn_GenerateOrdersReport()
                 {
                 	// ============================================
                 	// ORDERS REPORT GENERATOR - OPTIMIZED
                 	// ============================================
                 	// --------------------------------------------
                 	// 1. FETCH DATA
                 	// --------------------------------------------
                 	stockOrders = Stock_Ordering[ID != null] sort by Order_Date desc;
                 	purchaseOrders = Purchase_Orders[ID != null] sort by Order_Date desc;
                 	// Pre-count line items per order (avoid nested loops)
                 	orderLineCounts = Map();
                 	orderLineItems = Order_Line_Items[ID != null];
                 	for each  line in orderLineItems
                 	{
                 		if(line.Order != null)
                 		{
                 			orderId = line.Order.ID.toString();
                 			currentCount = orderLineCounts.get(orderId);
                 			if(currentCount == null)
                 			{
                 				currentCount = 0;
                 			}
                 			orderLineCounts.put(orderId,currentCount + 1);
                 		}
                 	}
                 	// Pre-count PO line items
                 	poLineCounts = Map();
                 	poLines = PO_Line_Items[ID != null];
                 	for each  poLine in poLines
                 	{
                 		if(poLine.Purchase_Order != null)
                 		{
                 			poId = poLine.Purchase_Order.ID.toString();
                 			currentCount = poLineCounts.get(poId);
                 			if(currentCount == null)
                 			{
                 				currentCount = 0;
                 			}
                 			poLineCounts.put(poId,currentCount + 1);
                 		}
                 	}
                 	// --------------------------------------------
                 	// 2. PROCESS STOCK ORDERS (using stored values)
                 	// --------------------------------------------
                 	stockOrderData = List();
                 	stockTotalValue = 0.00;
                 	stockTotalCount = 0;
                 	pendingApprovalCount = 0;
                 	stockStatusCounts = Map();
                 	stockStatusValues = Map();
                 	siteStats = Map();
                 	for each  order in stockOrders
                 	{
                 		orderId = order.ID;
                 		orderStatus = ifnull(order.Order_Status,"Unknown");
                 		// Use stored site name (no API call!)
                 		siteName = ifnull(order.Site_Name_Stored,"Unknown Site");
                 		// Use stored order total (no nested loop!)
                 		orderValue = ifnull(order.Order_Total_Stored,0.00).toDecimal();
                 		// Get line count from pre-built map
                 		lineCount = orderLineCounts.get(orderId.toString());
                 		if(lineCount == null)
                 		{
                 			lineCount = 0;
                 		}
                 		stockOrderData.add({"id":orderId,"date":order.Order_Date,"site":siteName,"status":orderStatus,"value":orderValue,"line_count":lineCount});
                 		stockTotalValue = stockTotalValue + orderValue;
                 		stockTotalCount = stockTotalCount + 1;
                 		if(orderStatus == "Pending Approval")
                 		{
                 			pendingApprovalCount = pendingApprovalCount + 1;
                 		}
                 		// Update status counters
                 		if(stockStatusCounts.get(orderStatus) != null)
                 		{
                 			stockStatusCounts.put(orderStatus,stockStatusCounts.get(orderStatus) + 1);
                 			stockStatusValues.put(orderStatus,stockStatusValues.get(orderStatus) + orderValue);
                 		}
                 		else
                 		{
                 			stockStatusCounts.put(orderStatus,1);
                 			stockStatusValues.put(orderStatus,orderValue);
                 		}
                 		// Update site stats
                 		if(siteStats.get(siteName) != null)
                 		{
                 			siteData = siteStats.get(siteName);
                 			siteData.put("order_count",siteData.get("order_count") + 1);
                 			siteData.put("total_value",siteData.get("total_value") + orderValue);
                 		}
                 		else
                 		{
                 			siteStats.put(siteName,{"order_count":1,"total_value":orderValue});
                 		}
                 	}
                 	// --------------------------------------------
                 	// 3. PROCESS PURCHASE ORDERS
                 	// --------------------------------------------
                 	poData = List();
                 	poTotalValue = 0.00;
                 	poTotalCount = 0;
                 	outstandingPOCount = 0;
                 	outstandingPOValue = 0.00;
                 	poStatusCounts = Map();
                 	poStatusValues = Map();
                 	supplierStats = Map();
                 	for each  po in purchaseOrders
                 	{
                 		poId = po.ID;
                 		poStatus = ifnull(po.PO_Status,"Unknown");
                 		poValue = ifnull(po.Total_Value,0.00).toDecimal();
                 		supplierName = ifnull(po.Supplier.Supplier_Name,"Unknown Supplier");
                 		// Get line count from pre-built map
                 		lineCount = poLineCounts.get(poId.toString());
                 		if(lineCount == null)
                 		{
                 			lineCount = 0;
                 		}
                 		poData.add({"id":poId,"date":po.Order_Date,"supplier":supplierName,"status":poStatus,"value":poValue,"line_count":lineCount});
                 		poTotalValue = poTotalValue + poValue;
                 		poTotalCount = poTotalCount + 1;
                 		if(poStatus == "Draft" || poStatus == "Confirmed" || poStatus == "Partially Received")
                 		{
                 			outstandingPOCount = outstandingPOCount + 1;
                 			outstandingPOValue = outstandingPOValue + poValue;
                 		}
                 		// Update status counters
                 		if(poStatusCounts.get(poStatus) != null)
                 		{
                 			poStatusCounts.put(poStatus,poStatusCounts.get(poStatus) + 1);
                 			poStatusValues.put(poStatus,poStatusValues.get(poStatus) + poValue);
                 		}
                 		else
                 		{
                 			poStatusCounts.put(poStatus,1);
                 			poStatusValues.put(poStatus,poValue);
                 		}
                 		// Update supplier stats
                 		if(supplierStats.get(supplierName) != null)
                 		{
                 			suppData = supplierStats.get(supplierName);
                 			suppData.put("count",suppData.get("count") + 1);
                 			suppData.put("total_value",suppData.get("total_value") + poValue);
                 			if(poStatus == "Draft" || poStatus == "Confirmed" || poStatus == "Partially Received")
                 			{
                 				suppData.put("open_value",suppData.get("open_value") + poValue);
                 			}
                 		}
                 		else
                 		{
                 			openVal = 0.00;
                 			if(poStatus == "Draft" || poStatus == "Confirmed" || poStatus == "Partially Received")
                 			{
                 				openVal = poValue;
                 			}
                 			supplierStats.put(supplierName,{"count":1,"total_value":poValue,"open_value":openVal});
                 		}
                 	}
                 	// --------------------------------------------
                 	// 4. BUILD HTML REPORT
                 	// --------------------------------------------
                 	grandTotalOrders = stockTotalCount + poTotalCount;
                 	grandTotalValue = stockTotalValue + poTotalValue;
                 	html = "";
                 	// CSS Styles
                 	html = html + "<style>";
                 	html = html + "* { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; box-sizing: border-box; }";
                 	html = html + ".report-container { max-width: 1400px; margin: 0 auto; padding: 20px; background: #f5f7fa; }";
                 	html = html + ".report-header { background: linear-gradient(135deg, #2c5282 0%, #4a7ab5 100%); color: white; padding: 25px 30px; border-radius: 12px; margin-bottom: 25px; }";
                 	html = html + ".report-title { font-size: 28px; font-weight: 700; margin: 0 0 5px 0; }";
                 	html = html + ".report-subtitle { font-size: 14px; opacity: 0.85; margin: 0; }";
                 	html = html + ".summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; margin-bottom: 25px; }";
                 	html = html + ".summary-card { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); text-align: center; }";
                 	html = html + ".summary-card.alert { border-left: 4px solid #e74c3c; }";
                 	html = html + ".summary-card.warning { border-left: 4px solid #f39c12; }";
                 	html = html + ".summary-card.success { border-left: 4px solid #27ae60; }";
                 	html = html + ".summary-card.info { border-left: 4px solid #3498db; }";
                 	html = html + ".summary-card.purple { border-left: 4px solid #9b59b6; }";
                 	html = html + ".summary-value { font-size: 32px; font-weight: 700; margin-bottom: 5px; }";
                 	html = html + ".summary-value.alert { color: #e74c3c; }";
                 	html = html + ".summary-value.warning { color: #f39c12; }";
                 	html = html + ".summary-value.success { color: #27ae60; }";
                 	html = html + ".summary-value.info { color: #3498db; }";
                 	html = html + ".summary-value.purple { color: #9b59b6; }";
                 	html = html + ".summary-label { font-size: 13px; color: #7f8c8d; text-transform: uppercase; }";
                 	html = html + ".section { background: white; border-radius: 12px; padding: 25px; margin-bottom: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }";
                 	html = html + ".section-title { font-size: 18px; font-weight: 600; color: #2c3e50; margin: 0 0 20px 0; padding-bottom: 10px; border-bottom: 2px solid #ecf0f1; }";
                 	html = html + ".two-columns { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 25px; margin-bottom: 25px; }";
                 	html = html + "table { width: 100%; border-collapse: collapse; font-size: 14px; }";
                 	html = html + "th { background: #f8f9fa; padding: 12px 15px; text-align: left; font-weight: 600; color: #2c3e50; border-bottom: 2px solid #ecf0f1; }";
                 	html = html + "td { padding: 12px 15px; border-bottom: 1px solid #ecf0f1; color: #34495e; }";
                 	html = html + ".text-right { text-align: right; }";
                 	html = html + ".text-center { text-align: center; }";
                 	html = html + ".status { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; }";
                 	html = html + ".status-draft { background: #e9ecef; color: #495057; }";
                 	html = html + ".status-pending { background: #fff3cd; color: #856404; }";
                 	html = html + ".status-awaiting { background: #cce5ff; color: #004085; }";
                 	html = html + ".status-complete { background: #d4edda; color: #155724; }";
                 	html = html + ".status-partial { background: #fff3cd; color: #856404; }";
                 	html = html + ".status-cancelled { background: #f8d7da; color: #721c24; }";
                 	html = html + ".progress-bar { background: #ecf0f1; border-radius: 10px; height: 20px; overflow: hidden; }";
                 	html = html + ".progress-fill { height: 100%; border-radius: 10px; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px; font-size: 11px; font-weight: 600; color: white; min-width: 40px; }";
                 	html = html + ".progress-fill.blue { background: linear-gradient(90deg, #3498db, #2980b9); }";
                 	html = html + ".progress-fill.purple { background: linear-gradient(90deg, #9b59b6, #8e44ad); }";
                 	html = html + ".empty-state { text-align: center; padding: 30px; color: #95a5a6; }";
                 	html = html + "</style>";
                 	// Report Container
                 	html = html + "<div class='report-container'>";
                 	html = html + "<div style='margin-bottom: 15px;'><a href='#Page:Main_Dashboard' style='display: inline-block; padding: 10px 20px; background-color: #7030A0; color: white; text-decoration: none; border-radius: 5px;'> Back to Dashboard</a></div>";
                 	// Header
                 	html = html + "<div class='report-header'>";
                 	html = html + "<h1 class='report-title'> Orders Report</h1>";
                 	html = html + "<p class='report-subtitle'>Generated: " + zoho.currenttime.toString("dd MMM yyyy 'at' HH:mm") + "</p>";
                 	html = html + "</div>";
                 	// Summary Cards
                 	html = html + "<div class='summary-grid'>";
                 	html = html + "<div class='summary-card info'><div class='summary-value info'>" + grandTotalOrders + "</div><div class='summary-label'>Total Orders</div></div>";
                 	html = html + "<div class='summary-card success'><div class='summary-value success'>" + thisapp.formatNumber(grandTotalValue) + "</div><div class='summary-label'>Total Value</div></div>";
                 	html = html + "<div class='summary-card warning'><div class='summary-value warning'>" + pendingApprovalCount + "</div><div class='summary-label'>Pending Approval</div></div>";
                 	html = html + "<div class='summary-card purple'><div class='summary-value purple'>" + outstandingPOCount + "</div><div class='summary-label'>Outstanding POs</div></div>";
                 	html = html + "</div>";
                 	// Two Column Layout
                 	html = html + "<div class='two-columns'>";
                 	// Stock Orders by Status
                 	html = html + "<div class='section'>";
                 	html = html + "<h3 class='section-title'> Stock Orders by Status (" + stockTotalCount + ")</h3>";
                 	if(stockTotalCount > 0)
                 	{
                 		html = html + "<table><tr><th>Status</th><th class='text-right'>Count</th><th class='text-right'>Value</th></tr>";
                 		for each  statusName in {"Draft","Pending Approval","Awaiting Pick","Awaiting Collection","Collected","Rejected","Cancelled"}
                 		{
                 			count = stockStatusCounts.get(statusName);
                 			if(count != null && count > 0)
                 			{
                 				value = stockStatusValues.get(statusName);
                 				html = html + "<tr><td><strong>" + statusName + "</strong></td><td class='text-right'>" + count + "</td><td class='text-right'>" + thisapp.formatNumber(value) + "</td></tr>";
                 			}
                 		}
                 		html = html + "</table>";
                 	}
                 	html = html + "</div>";
                 	// Purchase Orders by Status
                 	html = html + "<div class='section'>";
                 	html = html + "<h3 class='section-title'> Purchase Orders by Status (" + poTotalCount + ")</h3>";
                 	if(poTotalCount > 0)
                 	{
                 		html = html + "<table><tr><th>Status</th><th class='text-right'>Count</th><th class='text-right'>Value</th></tr>";
                 		for each  statusName in {"Draft","Confirmed","Partially Received","Fully Received","Cancelled"}
                 		{
                 			count = poStatusCounts.get(statusName);
                 			if(count != null && count > 0)
                 			{
                 				value = poStatusValues.get(statusName);
                 				html = html + "<tr><td><strong>" + statusName + "</strong></td><td class='text-right'>" + count + "</td><td class='text-right'>" + thisapp.formatNumber(value) + "</td></tr>";
                 			}
                 		}
                 		html = html + "</table>";
                 	}
                 	html = html + "</div>";
                 	html = html + "</div>";
                 	// Orders by Site
                 	html = html + "<div class='two-columns'>";
                 	html = html + "<div class='section'>";
                 	html = html + "<h3 class='section-title'> Stock Orders by Site</h3>";
                 	if(siteStats.size() > 0)
                 	{
                 		html = html + "<table><tr><th>Site</th><th class='text-right'>Orders</th><th class='text-right'>Value</th></tr>";
                 		for each  siteName in siteStats.keys()
                 		{
                 			siteData = siteStats.get(siteName);
                 			html = html + "<tr><td><strong>" + siteName + "</strong></td><td class='text-right'>" + siteData.get("order_count") + "</td><td class='text-right'>" + thisapp.formatNumber(siteData.get("total_value")) + "</td></tr>";
                 		}
                 		html = html + "</table>";
                 	}
                 	html = html + "</div>";
                 	// POs by Supplier
                 	html = html + "<div class='section'>";
                 	html = html + "<h3 class='section-title'> POs by Supplier</h3>";
                 	if(supplierStats.size() > 0)
                 	{
                 		html = html + "<table><tr><th>Supplier</th><th class='text-right'>POs</th><th class='text-right'>Value</th></tr>";
                 		for each  suppName in supplierStats.keys()
                 		{
                 			suppData = supplierStats.get(suppName);
                 			html = html + "<tr><td><strong>" + suppName + "</strong></td><td class='text-right'>" + suppData.get("count") + "</td><td class='text-right'>" + thisapp.formatNumber(suppData.get("total_value")) + "</td></tr>";
                 		}
                 		html = html + "</table>";
                 	}
                 	html = html + "</div>";
                 	html = html + "</div>";
                 	// Recent Stock Orders (limit to 10)
                 	html = html + "<div class='section'>";
                 	html = html + "<h3 class='section-title'> Recent Stock Orders</h3>";
                 	if(stockOrderData.size() > 0)
                 	{
                 		html = html + "<table><tr><th>Date</th><th>Site</th><th class='text-right'>Items</th><th class='text-right'>Value</th><th class='text-center'>Status</th></tr>";
                 		displayCount = 0;
                 		for each  order in stockOrderData
                 		{
                 			if(displayCount < 10)
                 			{
                 				orderStatus = order.get("status");
                 				statusClass = "status-draft";
                 				if(orderStatus == "Pending Approval")
                 				{
                 					statusClass = "status-pending";
                 				}
                 				else if(orderStatus == "Awaiting Pick" || orderStatus == "Awaiting Collection")
                 				{
                 					statusClass = "status-awaiting";
                 				}
                 				else if(orderStatus == "Collected")
                 				{
                 					statusClass = "status-complete";
                 				}
                 				else if(orderStatus == "Rejected" || orderStatus == "Cancelled")
                 				{
                 					statusClass = "status-cancelled";
                 				}
                 				dateStr = "";
                 				if(order.get("date") != null)
                 				{
                 					dateStr = order.get("date").toString("dd MMM yyyy");
                 				}
                 				html = html + "<tr><td>" + dateStr + "</td><td><strong>" + order.get("site") + "</strong></td><td class='text-right'>" + order.get("line_count") + "</td><td class='text-right'>" + thisapp.formatNumber(order.get("value")) + "</td><td class='text-center'><span class='status " + statusClass + "'>" + orderStatus + "</span></td></tr>";
                 			}
                 			displayCount = displayCount + 1;
                 		}
                 		html = html + "</table>";
                 	}
                 	html = html + "</div>";
                 	// Footer
                 	html = html + "<div style='text-align:center;padding:20px;color:#95a5a6;font-size:12px;'>RASCOR Stock Management System</div>";
                 	html = html + "</div>";
                 	return html;
                 }
				 string fn_GenerateProductsByMonthChart()
                 {
                 	// ============================================
                 	// TOP 10 PRODUCTS BY MONTH - STACKED COLUMN
                 	// Using QuickChart.io (no JavaScript needed)
                 	// ============================================
                 	// --------------------------------------------
                 	// 1. FETCH DATA
                 	// --------------------------------------------
                 	orderLines = Order_Line_Items[ID != null];
                 	products = Product_Master[ID != null];
                 	productMap = Map();
                 	for each  prod in products
                 	{
                 		productMap.put(prod.ID.toString(),prod.Product_Name);
                 	}
                 	// --------------------------------------------
                 	// 2. AGGREGATE BY PRODUCT AND MONTH
                 	// --------------------------------------------
                 	productMonthData = Map();
                 	productTotals = Map();
                 	allMonths = List();
                 	for each  line in orderLines
                 	{
                 		if(line.Order != null && line.Product != null)
                 		{
                 			productId = line.Product.ID.toString();
                 			productName = productMap.get(productId);
                 			if(productName == null)
                 			{
                 				productName = "Unknown";
                 			}
                 			orderDate = line.Order.Order_Date;
                 			if(orderDate != null)
                 			{
                 				monthKey = orderDate.toString("yyyy-MM");
                 				monthLabel = orderDate.toString("MMM yyyy");
                 				monthExists = false;
                 				for each  m in allMonths
                 				{
                 					if(m.get("key") == monthKey)
                 					{
                 						monthExists = true;
                 					}
                 				}
                 				if(monthExists == false)
                 				{
                 					allMonths.add({"key":monthKey,"label":monthLabel});
                 				}
                 				lineValue = ifnull(line.Line_Total_Stored,0).toDecimal();
                 				if(productMonthData.get(productName) == null)
                 				{
                 					productMonthData.put(productName,Map());
                 					productTotals.put(productName,0.00);
                 				}
                 				prodData = productMonthData.get(productName);
                 				currentVal = prodData.get(monthKey);
                 				if(currentVal == null)
                 				{
                 					currentVal = 0.00;
                 				}
                 				prodData.put(monthKey,currentVal + lineValue);
                 				productTotals.put(productName,productTotals.get(productName) + lineValue);
                 			}
                 		}
                 	}
                 	// --------------------------------------------
                 	// 3. FIND TOP 10 PRODUCTS BY TOTAL VALUE
                 	// --------------------------------------------
                 	top10Products = List();
                 	processedProducts = List();
                 	productKeys = productTotals.keys();
                 	totalProducts = productKeys.size();
                 	maxToFind = 10;
                 	if(totalProducts < maxToFind)
                 	{
                 		maxToFind = totalProducts;
                 	}
                 	count = 0;
                 	for each  iteration in {1,2,3,4,5,6,7,8,9,10}
                 	{
                 		if(count < maxToFind)
                 		{
                 			maxProduct = "";
                 			maxValue = -1.0;
                 			for each  prodName in productKeys
                 			{
                 				alreadyProcessed = false;
                 				for each  p in processedProducts
                 				{
                 					if(p == prodName)
                 					{
                 						alreadyProcessed = true;
                 					}
                 				}
                 				if(alreadyProcessed == false)
                 				{
                 					prodTotal = productTotals.get(prodName).toDecimal();
                 					if(prodTotal > maxValue)
                 					{
                 						maxValue = prodTotal;
                 						maxProduct = prodName;
                 					}
                 				}
                 			}
                 			if(maxProduct != "")
                 			{
                 				top10Products.add(maxProduct);
                 				processedProducts.add(maxProduct);
                 				count = count + 1;
                 			}
                 		}
                 	}
                 	// --------------------------------------------
                 	// 4. SORT MONTHS CHRONOLOGICALLY
                 	// --------------------------------------------
                 	sortedMonths = List();
                 	processedMonths = List();
                 	totalMonths = allMonths.size();
                 	for each  iteration in {1,2,3,4,5,6,7,8,9,10,11,12}
                 	{
                 		if(sortedMonths.size() < totalMonths)
                 		{
                 			minKeyNum = 999999;
                 			minMonth = null;
                 			for each  m in allMonths
                 			{
                 				monthKey = m.get("key");
                 				monthKeyNum = monthKey.replaceAll("-","").toLong();
                 				alreadyProcessed = false;
                 				for each  pm in processedMonths
                 				{
                 					if(pm == monthKey)
                 					{
                 						alreadyProcessed = true;
                 					}
                 				}
                 				if(alreadyProcessed == false && monthKeyNum < minKeyNum)
                 				{
                 					minKeyNum = monthKeyNum;
                 					minMonth = m;
                 				}
                 			}
                 			if(minMonth != null)
                 			{
                 				sortedMonths.add(minMonth);
                 				processedMonths.add(minMonth.get("key"));
                 			}
                 		}
                 	}
                 	// --------------------------------------------
                 	// 5. BUILD QUICKCHART URL
                 	// --------------------------------------------
                 	// Month labels
                 	monthLabels = "";
                 	for each  m in sortedMonths
                 	{
                 		if(monthLabels != "")
                 		{
                 			monthLabels = monthLabels + ",";
                 		}
                 		monthLabels = monthLabels + "'" + m.get("label") + "'";
                 	}
                 	// Colors
                 	colors = {"#e74c3c","#3498db","#2ecc71","#f39c12","#9b59b6","#1abc9c","#e67e22","#34495e","#16a085","#c0392b"};
                 	// Build datasets
                 	datasets = "";
                 	colorIndex = 0;
                 	for each  prodName in top10Products
                 	{
                 		prodData = productMonthData.get(prodName);
                 		dataPoints = "";
                 		for each  m in sortedMonths
                 		{
                 			if(dataPoints != "")
                 			{
                 				dataPoints = dataPoints + ",";
                 			}
                 			val = prodData.get(m.get("key"));
                 			if(val == null)
                 			{
                 				val = 0;
                 			}
                 			dataPoints = dataPoints + val.round(0);
                 		}
                 		color = colors.get(colorIndex);
                 		if(color == null)
                 		{
                 			color = "#95a5a6";
                 		}
                 		if(datasets != "")
                 		{
                 			datasets = datasets + ",";
                 		}
                 		// Shorten product name for legend
                 		shortName = prodName;
                 		if(shortName.length() > 20)
                 		{
                 			shortName = shortName.subString(0,18) + "..";
                 		}
                 		datasets = datasets + "{label:'" + shortName + "',data:[" + dataPoints + "],backgroundColor:'" + color + "'}";
                 		colorIndex = colorIndex + 1;
                 	}
                 	// Build chart config JSON
                 	chartConfig = "{type:'bar',data:{labels:[" + monthLabels + "],datasets:[" + datasets + "]},options:{plugins:{legend:{position:'bottom',labels:{font:{size:9}}}},scales:{x:{stacked:true},y:{stacked:true,beginAtZero:true}}}}";
                 	// URL encode
                 	chartUrl = "https://quickchart.io/chart?w=700&h=400&c=" + encodeUrl(chartConfig);
                 	// --------------------------------------------
                 	// 6. BUILD HTML
                 	// --------------------------------------------
                 	html = "";
                 	html = html + "<div style='background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);'>";
                 	html = html + "<h3 style='font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif; font-size: 18px; font-weight: 600; color: #2c3e50; margin: 0 0 20px 0; padding-bottom: 10px; border-bottom: 2px solid #ecf0f1;'> Top 10 Products Ordered by Sites, by Value per Month</h3>";
                 	html = html + "<img src='" + chartUrl + "' style='width: 100%; max-width: 700px;' />";
                 	html = html + "</div>";
                 	return html;
                 }
				 string fn_GenerateProductsBySiteChart()
                 {
                 	// ============================================
                 	// TOP 10 PRODUCTS BY SITE - STACKED COLUMN
                 	// Using QuickChart.io + Site_Name_Stored field
                 	// ============================================
                 	// --------------------------------------------
                 	// 1. FETCH ORDER DATA
                 	// --------------------------------------------
                 	orderLines = Order_Line_Items[ID != null];
                 	products = Product_Master[ID != null];
                 	productMap = Map();
                 	for each  prod in products
                 	{
                 		productMap.put(prod.ID.toString(),prod.Product_Name);
                 	}
                 	// --------------------------------------------
                 	// 2. AGGREGATE BY PRODUCT AND SITE
                 	// --------------------------------------------
                 	productSiteData = Map();
                 	productTotals = Map();
                 	allSites = List();
                 	for each  line in orderLines
                 	{
                 		if(line.Order != null && line.Product != null)
                 		{
                 			productId = line.Product.ID.toString();
                 			productName = productMap.get(productId);
                 			if(productName == null)
                 			{
                 				productName = "Unknown";
                 			}
                 			// Get site name from stored field - NO API CALL
                 			siteName = ifnull(line.Order.Site_Name_Stored,"Unknown Site");
                 			if(siteName == "")
                 			{
                 				siteName = "Unknown Site";
                 			}
                 			// Track all sites
                 			siteExists = false;
                 			for each  s in allSites
                 			{
                 				if(s == siteName)
                 				{
                 					siteExists = true;
                 				}
                 			}
                 			if(siteExists == false)
                 			{
                 				allSites.add(siteName);
                 			}
                 			lineValue = ifnull(line.Line_Total_Stored,0).toDecimal();
                 			if(productSiteData.get(productName) == null)
                 			{
                 				productSiteData.put(productName,Map());
                 				productTotals.put(productName,0.00);
                 			}
                 			prodData = productSiteData.get(productName);
                 			currentVal = prodData.get(siteName);
                 			if(currentVal == null)
                 			{
                 				currentVal = 0.00;
                 			}
                 			prodData.put(siteName,currentVal + lineValue);
                 			productTotals.put(productName,productTotals.get(productName) + lineValue);
                 		}
                 	}
                 	// --------------------------------------------
                 	// 3. FIND TOP 10 PRODUCTS BY TOTAL VALUE
                 	// --------------------------------------------
                 	top10Products = List();
                 	processedProducts = List();
                 	productKeys = productTotals.keys();
                 	totalProducts = productKeys.size();
                 	maxToFind = 10;
                 	if(totalProducts < maxToFind)
                 	{
                 		maxToFind = totalProducts;
                 	}
                 	count = 0;
                 	for each  iteration in {1,2,3,4,5,6,7,8,9,10}
                 	{
                 		if(count < maxToFind)
                 		{
                 			maxProduct = "";
                 			maxValue = -1.0;
                 			for each  prodName in productKeys
                 			{
                 				alreadyProcessed = false;
                 				for each  p in processedProducts
                 				{
                 					if(p == prodName)
                 					{
                 						alreadyProcessed = true;
                 					}
                 				}
                 				if(alreadyProcessed == false)
                 				{
                 					prodTotal = productTotals.get(prodName).toDecimal();
                 					if(prodTotal > maxValue)
                 					{
                 						maxValue = prodTotal;
                 						maxProduct = prodName;
                 					}
                 				}
                 			}
                 			if(maxProduct != "")
                 			{
                 				top10Products.add(maxProduct);
                 				processedProducts.add(maxProduct);
                 				count = count + 1;
                 			}
                 		}
                 	}
                 	// --------------------------------------------
                 	// 4. BUILD QUICKCHART URL
                 	// --------------------------------------------
                 	siteLabels = "";
                 	for each  site in allSites
                 	{
                 		if(siteLabels != "")
                 		{
                 			siteLabels = siteLabels + ",";
                 		}
                 		shortSite = site;
                 		if(shortSite.length() > 15)
                 		{
                 			shortSite = shortSite.subString(0,13) + "..";
                 		}
                 		siteLabels = siteLabels + "'" + shortSite.replaceAll("'","") + "'";
                 	}
                 	colors = {"#e74c3c","#3498db","#2ecc71","#f39c12","#9b59b6","#1abc9c","#e67e22","#34495e","#16a085","#c0392b"};
                 	datasets = "";
                 	colorIndex = 0;
                 	for each  prodName in top10Products
                 	{
                 		prodData = productSiteData.get(prodName);
                 		dataPoints = "";
                 		for each  site in allSites
                 		{
                 			if(dataPoints != "")
                 			{
                 				dataPoints = dataPoints + ",";
                 			}
                 			val = prodData.get(site);
                 			if(val == null)
                 			{
                 				val = 0;
                 			}
                 			dataPoints = dataPoints + val.round(0);
                 		}
                 		color = colors.get(colorIndex);
                 		if(color == null)
                 		{
                 			color = "#95a5a6";
                 		}
                 		if(datasets != "")
                 		{
                 			datasets = datasets + ",";
                 		}
                 		shortName = prodName;
                 		if(shortName.length() > 20)
                 		{
                 			shortName = shortName.subString(0,18) + "..";
                 		}
                 		datasets = datasets + "{label:'" + shortName.replaceAll("'","") + "',data:[" + dataPoints + "],backgroundColor:'" + color + "'}";
                 		colorIndex = colorIndex + 1;
                 	}
                 	chartConfig = "{type:'bar',data:{labels:[" + siteLabels + "],datasets:[" + datasets + "]},options:{plugins:{legend:{position:'bottom',labels:{font:{size:9}}}},scales:{x:{stacked:true},y:{stacked:true,beginAtZero:true}}}}";
                 	chartUrl = "https://quickchart.io/chart?w=700&h=400&c=" + encodeUrl(chartConfig);
                 	// --------------------------------------------
                 	// 5. BUILD HTML
                 	// --------------------------------------------
                 	html = "";
                 	html = html + "<div style='background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);'>";
                 	html = html + "<h3 style='font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif; font-size: 18px; font-weight: 600; color: #2c3e50; margin: 0 0 20px 0; padding-bottom: 10px; border-bottom: 2px solid #ecf0f1;'> Top 10 Products Ordered, by Value per Site</h3>";
                 	html = html + "<img src='" + chartUrl + "' style='width: 100%; max-width: 700px;' />";
                 	html = html + "</div>";
                 	return html;
                 }
				 string fn_GenerateProductsByWeekChart()
                 {
                 	// Get only Collected orders
                 	orderLines = Order_Line_Items[Order.Order_Status == "Collected"];
                 	// Build product name map
                 	products = Product_Master[ID != null];
                 	productMap = Map();
                 	for each  prod in products
                 	{
                 		productMap.put(prod.ID.toString(),prod.Product_Name);
                 	}
                 	// Aggregate totals
                 	productTotals = Map();
                 	productWeekData = Map();
                 	allWeeks = Map();
                 	for each  line in orderLines
                 	{
                 		if(line.Order != null && line.Product != null)
                 		{
                 			productId = line.Product.ID.toString();
                 			productName = productMap.get(productId);
                 			if(productName == null)
                 			{
                 				productName = "Unknown";
                 			}
                 			orderDate = line.Order.Order_Date;
                 			if(orderDate != null)
                 			{
                 				weekNum = orderDate.toString("w");
                 				yearNum = orderDate.toString("yyyy");
                 				weekKey = yearNum + "-W" + weekNum;
                 				if(allWeeks.get(weekKey) == null)
                 				{
                 					weekLabel = orderDate.toString("dd MMM");
                 					allWeeks.put(weekKey,weekLabel);
                 				}
                 				lineValue = ifnull(line.Line_Total_Stored,0).toDecimal();
                 				currentTotal = productTotals.get(productName);
                 				if(currentTotal == null)
                 				{
                 					currentTotal = 0.0;
                 					productWeekData.put(productName,Map());
                 				}
                 				productTotals.put(productName,currentTotal + lineValue);
                 				weekData = productWeekData.get(productName);
                 				currentWeekVal = weekData.get(weekKey);
                 				if(currentWeekVal == null)
                 				{
                 					currentWeekVal = 0.0;
                 				}
                 				weekData.put(weekKey,currentWeekVal + lineValue);
                 			}
                 		}
                 	}
                 	// Find top 10 products
                 	top10Products = List();
                 	productKeys = productTotals.keys();
                 	for each  iteration in {1,2,3,4,5,6,7,8,9,10}
                 	{
                 		maxProduct = "";
                 		maxValue = -1.0;
                 		for each  prodName in productKeys
                 		{
                 			alreadyAdded = false;
                 			for each  t in top10Products
                 			{
                 				if(t == prodName)
                 				{
                 					alreadyAdded = true;
                 				}
                 			}
                 			if(alreadyAdded == false)
                 			{
                 				prodTotal = productTotals.get(prodName);
                 				if(prodTotal > maxValue)
                 				{
                 					maxValue = prodTotal;
                 					maxProduct = prodName;
                 				}
                 			}
                 		}
                 		if(maxProduct != "")
                 		{
                 			top10Products.add(maxProduct);
                 		}
                 	}
                 	// Sort week keys manually
                 	weekKeysList = allWeeks.keys();
                 	sortedWeeks = List();
                 	processedWeeks = List();
                 	totalWeeks = weekKeysList.size();
                 	for each  iteration in {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20}
                 	{
                 		if(sortedWeeks.size() < totalWeeks)
                 		{
                 			minKey = "";
                 			minKeyNum = 999999;
                 			for each  wk in weekKeysList
                 			{
                 				alreadyProcessed = false;
                 				for each  pw in processedWeeks
                 				{
                 					if(pw == wk)
                 					{
                 						alreadyProcessed = true;
                 					}
                 				}
                 				if(alreadyProcessed == false)
                 				{
                 					wkNum = wk.replaceAll("-W","").toLong();
                 					if(wkNum < minKeyNum)
                 					{
                 						minKeyNum = wkNum;
                 						minKey = wk;
                 					}
                 				}
                 			}
                 			if(minKey != "")
                 			{
                 				sortedWeeks.add(minKey);
                 				processedWeeks.add(minKey);
                 			}
                 		}
                 	}
                 	// Build labels
                 	weekLabels = "";
                 	for each  wk in sortedWeeks
                 	{
                 		if(weekLabels != "")
                 		{
                 			weekLabels = weekLabels + ",";
                 		}
                 		weekLabels = weekLabels + "'" + allWeeks.get(wk) + "'";
                 	}
                 	// Build datasets
                 	colors = {"#e74c3c","#3498db","#2ecc71","#f39c12","#9b59b6","#1abc9c","#e67e22","#34495e","#16a085","#c0392b"};
                 	datasets = "";
                 	colorIndex = 0;
                 	for each  prodName in top10Products
                 	{
                 		weekData = productWeekData.get(prodName);
                 		dataPoints = "";
                 		for each  wk in sortedWeeks
                 		{
                 			if(dataPoints != "")
                 			{
                 				dataPoints = dataPoints + ",";
                 			}
                 			val = weekData.get(wk);
                 			if(val == null)
                 			{
                 				val = 0;
                 			}
                 			dataPoints = dataPoints + val.round(0);
                 		}
                 		color = colors.get(colorIndex);
                 		if(color == null)
                 		{
                 			color = "#95a5a6";
                 		}
                 		if(datasets != "")
                 		{
                 			datasets = datasets + ",";
                 		}
                 		shortName = prodName;
                 		if(shortName.length() > 20)
                 		{
                 			shortName = shortName.subString(0,18) + "..";
                 		}
                 		datasets = datasets + "{label:'" + shortName.replaceAll("'","") + "',data:[" + dataPoints + "],borderColor:'" + color + "',backgroundColor:'" + color + "',fill:false,tension:0.3}";
                 		colorIndex = colorIndex + 1;
                 	}
                 	chartConfig = "{type:'line',data:{labels:[" + weekLabels + "],datasets:[" + datasets + "]},options:{plugins:{legend:{position:'bottom',labels:{font:{size:9}}}},scales:{y:{beginAtZero:true}}}}";
                 	chartUrl = "https://quickchart.io/chart?w=700&h=400&c=" + encodeUrl(chartConfig);
                 	html = "<div style='background:white;border-radius:12px;padding:25px;box-shadow:0 2px 8px rgba(0,0,0,0.08);'>";
                 	html = html + "<h3 style='font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;font-size:18px;font-weight:600;color:#2c3e50;margin:0 0 20px 0;padding-bottom:10px;border-bottom:2px solid #ecf0f1;'> Top 10 Products Collected by Sites, by Value per Week</h3>";
                 	html = html + "<img src='" + chartUrl + "' style='width:100%;max-width:700px;' />";
                 	html = html + "</div>";
                 	return html;
                 }
				 string fn_GenerateProductTrendsReport()
                 {
                 	// ============================================
                 	// PRODUCT TRENDS REPORT - LINE CHART
                 	// Using QuickChart.io (no JavaScript needed)
                 	// ============================================
                 	// --------------------------------------------
                 	// 1. FETCH DATA
                 	// --------------------------------------------
                 	orderLines = Order_Line_Items[ID != null];
                 	products = Product_Master[ID != null];
                 	productMap = Map();
                 	for each  prod in products
                 	{
                 		productMap.put(prod.ID.toString(),prod.Product_Name);
                 	}
                 	// --------------------------------------------
                 	// 2. AGGREGATE BY PRODUCT AND MONTH
                 	// --------------------------------------------
                 	productMonthData = Map();
                 	productTotals = Map();
                 	allMonths = List();
                 	for each  line in orderLines
                 	{
                 		if(line.Order != null && line.Product != null)
                 		{
                 			productId = line.Product.ID.toString();
                 			productName = productMap.get(productId);
                 			if(productName == null)
                 			{
                 				productName = "Unknown";
                 			}
                 			orderDate = line.Order.Order_Date;
                 			if(orderDate != null)
                 			{
                 				monthKey = orderDate.toString("yyyy-MM");
                 				monthLabel = orderDate.toString("MMM yyyy");
                 				monthExists = false;
                 				for each  m in allMonths
                 				{
                 					if(m.get("key") == monthKey)
                 					{
                 						monthExists = true;
                 					}
                 				}
                 				if(monthExists == false)
                 				{
                 					allMonths.add({"key":monthKey,"label":monthLabel});
                 				}
                 				lineValue = ifnull(line.Line_Total_Stored,0).toDecimal();
                 				if(productMonthData.get(productName) == null)
                 				{
                 					productMonthData.put(productName,Map());
                 					productTotals.put(productName,0.00);
                 				}
                 				prodData = productMonthData.get(productName);
                 				currentVal = prodData.get(monthKey);
                 				if(currentVal == null)
                 				{
                 					currentVal = 0.00;
                 				}
                 				prodData.put(monthKey,currentVal + lineValue);
                 				productTotals.put(productName,productTotals.get(productName) + lineValue);
                 			}
                 		}
                 	}
                 	// --------------------------------------------
                 	// 3. FIND TOP 10 PRODUCTS BY TOTAL VALUE
                 	// --------------------------------------------
                 	top10Products = List();
                 	processedProducts = List();
                 	productKeys = productTotals.keys();
                 	totalProducts = productKeys.size();
                 	maxToFind = 10;
                 	if(totalProducts < maxToFind)
                 	{
                 		maxToFind = totalProducts;
                 	}
                 	count = 0;
                 	for each  iteration in {1,2,3,4,5,6,7,8,9,10}
                 	{
                 		if(count < maxToFind)
                 		{
                 			maxProduct = "";
                 			maxValue = -1.0;
                 			for each  prodName in productKeys
                 			{
                 				alreadyProcessed = false;
                 				for each  p in processedProducts
                 				{
                 					if(p == prodName)
                 					{
                 						alreadyProcessed = true;
                 					}
                 				}
                 				if(alreadyProcessed == false)
                 				{
                 					prodTotal = productTotals.get(prodName).toDecimal();
                 					if(prodTotal > maxValue)
                 					{
                 						maxValue = prodTotal;
                 						maxProduct = prodName;
                 					}
                 				}
                 			}
                 			if(maxProduct != "")
                 			{
                 				top10Products.add(maxProduct);
                 				processedProducts.add(maxProduct);
                 				count = count + 1;
                 			}
                 		}
                 	}
                 	// --------------------------------------------
                 	// 4. SORT MONTHS CHRONOLOGICALLY
                 	// --------------------------------------------
                 	sortedMonths = List();
                 	processedMonths = List();
                 	totalMonths = allMonths.size();
                 	for each  iteration in {1,2,3,4,5,6,7,8,9,10,11,12}
                 	{
                 		if(sortedMonths.size() < totalMonths)
                 		{
                 			minKeyNum = 999999;
                 			minMonth = null;
                 			for each  m in allMonths
                 			{
                 				monthKey = m.get("key");
                 				monthKeyNum = monthKey.replaceAll("-","").toLong();
                 				alreadyProcessed = false;
                 				for each  pm in processedMonths
                 				{
                 					if(pm == monthKey)
                 					{
                 						alreadyProcessed = true;
                 					}
                 				}
                 				if(alreadyProcessed == false && monthKeyNum < minKeyNum)
                 				{
                 					minKeyNum = monthKeyNum;
                 					minMonth = m;
                 				}
                 			}
                 			if(minMonth != null)
                 			{
                 				sortedMonths.add(minMonth);
                 				processedMonths.add(minMonth.get("key"));
                 			}
                 		}
                 	}
                 	// --------------------------------------------
                 	// 5. BUILD QUICKCHART URL
                 	// --------------------------------------------
                 	monthLabels = "";
                 	for each  m in sortedMonths
                 	{
                 		if(monthLabels != "")
                 		{
                 			monthLabels = monthLabels + ",";
                 		}
                 		monthLabels = monthLabels + "'" + m.get("label") + "'";
                 	}
                 	colors = {"#e74c3c","#3498db","#2ecc71","#f39c12","#9b59b6","#1abc9c","#e67e22","#34495e","#16a085","#c0392b"};
                 	datasets = "";
                 	colorIndex = 0;
                 	for each  prodName in top10Products
                 	{
                 		prodData = productMonthData.get(prodName);
                 		dataPoints = "";
                 		for each  m in sortedMonths
                 		{
                 			if(dataPoints != "")
                 			{
                 				dataPoints = dataPoints + ",";
                 			}
                 			val = prodData.get(m.get("key"));
                 			if(val == null)
                 			{
                 				val = 0;
                 			}
                 			dataPoints = dataPoints + val.round(0);
                 		}
                 		color = colors.get(colorIndex);
                 		if(color == null)
                 		{
                 			color = "#95a5a6";
                 		}
                 		if(datasets != "")
                 		{
                 			datasets = datasets + ",";
                 		}
                 		shortName = prodName;
                 		if(shortName.length() > 20)
                 		{
                 			shortName = shortName.subString(0,18) + "..";
                 		}
                 		datasets = datasets + "{label:'" + shortName.replaceAll("'","") + "',data:[" + dataPoints + "],borderColor:'" + color + "',backgroundColor:'" + color + "',fill:false,tension:0.3}";
                 		colorIndex = colorIndex + 1;
                 	}
                 	chartConfig = "{type:'line',data:{labels:[" + monthLabels + "],datasets:[" + datasets + "]},options:{plugins:{legend:{position:'bottom',labels:{font:{size:9}}}},scales:{y:{beginAtZero:true}}}}";
                 	chartUrl = "https://quickchart.io/chart?w=700&h=350&c=" + encodeUrl(chartConfig);
                 	// --------------------------------------------
                 	// 6. BUILD TOP 10 TABLE
                 	// --------------------------------------------
                 	tableHtml = "";
                 	tableHtml = tableHtml + "<table style='width: 100%; border-collapse: collapse; margin-top: 20px;'>";
                 	tableHtml = tableHtml + "<tr style='border-bottom: 2px solid #ecf0f1;'>";
                 	tableHtml = tableHtml + "<th style='text-align: left; padding: 10px; font-size: 12px; color: #7f8c8d;'>Rank</th>";
                 	tableHtml = tableHtml + "<th style='text-align: left; padding: 10px; font-size: 12px; color: #7f8c8d;'>Product</th>";
                 	tableHtml = tableHtml + "<th style='text-align: right; padding: 10px; font-size: 12px; color: #7f8c8d;'>Total Value</th>";
                 	tableHtml = tableHtml + "</tr>";
                 	rank = 1;
                 	for each  prodName in top10Products
                 	{
                 		prodTotal = productTotals.get(prodName);
                 		badgeColor = "#95a5a6";
                 		if(rank == 1)
                 		{
                 			badgeColor = "#f1c40f";
                 		}
                 		else if(rank == 2)
                 		{
                 			badgeColor = "#bdc3c7";
                 		}
                 		else if(rank == 3)
                 		{
                 			badgeColor = "#cd6133";
                 		}
                 		tableHtml = tableHtml + "<tr style='border-bottom: 1px solid #ecf0f1;'>";
                 		tableHtml = tableHtml + "<td style='padding: 10px;'><span style='display: inline-block; width: 24px; height: 24px; border-radius: 50%; background: " + badgeColor + "; color: white; text-align: center; line-height: 24px; font-size: 12px; font-weight: bold;'>" + rank + "</span></td>";
                 		tableHtml = tableHtml + "<td style='padding: 10px; font-size: 14px;'>" + prodName + "</td>";
                 		tableHtml = tableHtml + "<td style='padding: 10px; text-align: right; font-size: 14px; font-weight: 600;'>" + prodTotal.round(2) + "</td>";
                 		tableHtml = tableHtml + "</tr>";
                 		rank = rank + 1;
                 	}
                 	tableHtml = tableHtml + "</table>";
                 	// --------------------------------------------
                 	// 7. BUILD FULL HTML
                 	// --------------------------------------------
                 	currentTime = zoho.currenttime.toString("dd MMM yyyy 'at' HH:mm");
                 	html = "";
                 	// Header
                 	html = html + "<div style='background: linear-gradient(135deg, #1abc9c, #16a085); border-radius: 12px; padding: 20px; margin-bottom: 20px; color: white;'>";
                 	html = html + "<h2 style='margin: 0 0 5px 0; font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif;'> Product Trends Report</h2>";
                 	html = html + "<p style='margin: 0; opacity: 0.9; font-size: 14px;'>Top 10 Products by Order Value Over Time | Generated: " + currentTime + "</p>";
                 	html = html + "</div>";
                 	// Chart Section
                 	html = html + "<div style='background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 20px;'>";
                 	html = html + "<h3 style='font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif; font-size: 18px; font-weight: 600; color: #2c3e50; margin: 0 0 20px 0; padding-bottom: 10px; border-bottom: 2px solid #ecf0f1;'> Monthly Order Value Trends</h3>";
                 	html = html + "<img src='" + chartUrl + "' style='width: 100%; max-width: 700px;' />";
                 	html = html + "</div>";
                 	// Table Section
                 	html = html + "<div style='background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);'>";
                 	html = html + "<h3 style='font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif; font-size: 18px; font-weight: 600; color: #2c3e50; margin: 0 0 10px 0; padding-bottom: 10px; border-bottom: 2px solid #ecf0f1;'> Top 10 Products by Total Order Value</h3>";
                 	html = html + tableHtml;
                 	html = html + "</div>";
                 	return html;
                 }
				 string fn_GenerateProposalVsOrderReport()
                 {
                 	// ---- STYLES ----
                 	tableStyle = "width:100%; border-collapse:collapse; font-family:Arial,sans-serif; font-size:14px;";
                 	headerRowStyle = "background-color:#1a365d; color:#ffffff;";
                 	headerCellStyle = "padding:12px 16px; text-align:left; font-weight:600; border:1px solid #2d4a6f;";
                 	headerCellRightStyle = "padding:12px 16px; text-align:right; font-weight:600; border:1px solid #2d4a6f;";
                 	rowStyle = "background-color:#ffffff;";
                 	altRowStyle = "background-color:#f7fafc;";
                 	cellStyle = "padding:10px 16px; border:1px solid #e2e8f0;";
                 	cellRightStyle = "padding:10px 16px; border:1px solid #e2e8f0; text-align:right;";
                 	totalRowStyle = "background-color:#2d3748; color:#ffffff; font-weight:600;";
                 	totalCellStyle = "padding:12px 16px; border:1px solid #1a202c;";
                 	totalCellRightStyle = "padding:12px 16px; border:1px solid #1a202c; text-align:right;";
                 	positiveColor = "#c53030";
                 	negativeColor = "#276749";
                 	neutralColor = "#2b6cb0";
                 	// ---- FETCH DATA ----
                 	proposals = Project_Proposals[Proposal_Status == "Approved" || Proposal_Status == "Won"];
                 	grandTotalProposed = 0.0;
                 	grandTotalOrdered = 0.0;
                 	projectCount = 0;
                 	overBudgetCount = 0;
                 	underBudgetCount = 0;
                 	dataList = List();
                 	for each  prop in proposals
                 	{
                 		projectData = Map();
                 		projectData.put("projectId",ifnull(prop.Proposal_Number,"N/A"));
                 		projectData.put("projectName",ifnull(prop.Project_Name,"Unnamed Project"));
                 		projectData.put("status",ifnull(prop.Proposal_Status,""));
                 		companyName = "N/A";
                 		if(prop.Companies != null)
                 		{
                 			compRec = Companies[ID == prop.Companies];
                 			for each  c in compRec
                 			{
                 				companyName = ifnull(c.Company_Name,"N/A");
                 			}
                 		}
                 		projectData.put("company",companyName);
                 		// ---- CALCULATE PROPOSED VALUE ----
                 		proposedValue = 0.0;
                 		workPackages = Proposal_Work_Packages[Proposal == prop.ID];
                 		for each  wp in workPackages
                 		{
                 			lineItems = Proposal_Line_Items[Work_Package == wp.ID];
                 			for each  li in lineItems
                 			{
                 				proposedValue = proposedValue + ifnull(li.Line_Total,0);
                 			}
                 		}
                 		if(proposedValue == 0 && prop.Agreed_Price != null)
                 		{
                 			proposedValue = prop.Agreed_Price;
                 		}
                 		projectData.put("proposedValue",proposedValue);
                 		grandTotalProposed = grandTotalProposed + proposedValue;
                 		// ---- CALCULATE ORDERED VALUE ----
                 		// Uses Site_Name_Stored - NO API CALLS
                 		orderedValue = 0.0;
                 		orderCount = 0;
                 		projectName = ifnull(prop.Project_Name,"");
                 		if(projectName != "")
                 		{
                 			collectedOrders = Stock_Ordering[Order_Status == "Collected"];
                 			for each  ord in collectedOrders
                 			{
                 				// Use stored site name - NO API CALL
                 				siteName = ifnull(ord.Site_Name_Stored,"");
                 				// Check if site matches project
                 				isMatch = false;
                 				if(siteName != "" && projectName != "")
                 				{
                 					if(siteName.toLowerCase().contains(projectName.toLowerCase()) || projectName.toLowerCase().contains(siteName.toLowerCase()))
                 					{
                 						isMatch = true;
                 					}
                 				}
                 				if(isMatch)
                 				{
                 					orderCount = orderCount + 1;
                 					orderLines = Order_Line_Items[Order == ord.ID];
                 					for each  line in orderLines
                 					{
                 						qty = ifnull(line.Quantity,0);
                 						rate = 0.0;
                 						if(line.Product != null)
                 						{
                 							prodRec = Product_Master[ID == line.Product];
                 							for each  p in prodRec
                 							{
                 								rate = ifnull(p.Base_Rate,0);
                 							}
                 						}
                 						orderedValue = orderedValue + qty * rate;
                 					}
                 				}
                 			}
                 		}
                 		projectData.put("orderedValue",orderedValue);
                 		projectData.put("orderCount",orderCount);
                 		grandTotalOrdered = grandTotalOrdered + orderedValue;
                 		// ---- CALCULATE VARIANCE ----
                 		variance = orderedValue - proposedValue;
                 		variancePercent = 0.0;
                 		if(proposedValue > 0)
                 		{
                 			variancePercent = variance / proposedValue * 100;
                 		}
                 		projectData.put("variance",variance);
                 		projectData.put("variancePercent",round(variancePercent,1));
                 		if(variancePercent > 5)
                 		{
                 			overBudgetCount = overBudgetCount + 1;
                 			projectData.put("status_color",positiveColor);
                 			projectData.put("status_label","OVER");
                 		}
                 		else if(variancePercent < -5)
                 		{
                 			underBudgetCount = underBudgetCount + 1;
                 			projectData.put("status_color",negativeColor);
                 			projectData.put("status_label","UNDER");
                 		}
                 		else
                 		{
                 			projectData.put("status_color",neutralColor);
                 			projectData.put("status_label","ON TARGET");
                 		}
                 		dataList.add(projectData);
                 		projectCount = projectCount + 1;
                 	}
                 	// ---- CALCULATE GRAND TOTALS ----
                 	grandVariance = grandTotalOrdered - grandTotalProposed;
                 	grandVariancePercent = 0.0;
                 	if(grandTotalProposed > 0)
                 	{
                 		grandVariancePercent = grandVariance / grandTotalProposed * 100;
                 	}
                 	// ---- BUILD HTML ----
                 	html = "";
                 	html = html + "<div style='font-family:Arial,sans-serif; max-width:1000px; margin:0 auto;'>";
                 	html = html + "<div style='margin-bottom: 15px;'><a href='#Page:Main_Dashboard' style='display: inline-block; padding: 10px 20px; background-color: #7030A0; color: white; text-decoration: none; border-radius: 5px;'> Back to Dashboard</a></div>";
                 	// Header
                 	html = html + "<div style='background:linear-gradient(135deg,#1a365d,#2c5282); color:#fff; padding:24px; border-radius:8px 8px 0 0;'>";
                 	html = html + "<h1 style='margin:0 0 8px 0; font-size:24px;'>Proposal vs Orders Analysis</h1>";
                 	html = html + "<p style='margin:0; opacity:0.9;'>Generated: " + zoho.currentdate.toString("dd MMM yyyy") + " at " + zoho.currenttime.toString("HH:mm") + "</p>";
                 	html = html + "</div>";
                 	// Summary Cards
                 	html = html + "<div style='display:flex; flex-wrap:wrap; gap:16px; padding:20px; background:#f7fafc; border-left:1px solid #e2e8f0; border-right:1px solid #e2e8f0;'>";
                 	html = html + "<div style='flex:1; min-width:150px; background:#fff; padding:16px; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,0.1);'>";
                 	html = html + "<div style='font-size:12px; color:#718096; text-transform:uppercase; letter-spacing:1px;'>Total Proposed</div>";
                 	html = html + "<div style='font-size:24px; font-weight:700; color:#1a365d;'>" + thisapp.formatNumber(grandTotalProposed) + "</div>";
                 	html = html + "<div style='font-size:12px; color:#718096;'>" + projectCount + " projects</div>";
                 	html = html + "</div>";
                 	html = html + "<div style='flex:1; min-width:150px; background:#fff; padding:16px; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,0.1);'>";
                 	html = html + "<div style='font-size:12px; color:#718096; text-transform:uppercase; letter-spacing:1px;'>Total Ordered</div>";
                 	html = html + "<div style='font-size:24px; font-weight:700; color:#276749;'>" + thisapp.formatNumber(grandTotalOrdered) + "</div>";
                 	html = html + "<div style='font-size:12px; color:#718096;'>" + round(grandVariancePercent,1) + "% of proposed</div>";
                 	html = html + "</div>";
                 	varianceColor = positiveColor;
                 	if(grandVariance < 0)
                 	{
                 		varianceColor = negativeColor;
                 	}
                 	html = html + "<div style='flex:1; min-width:150px; background:#fff; padding:16px; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,0.1);'>";
                 	html = html + "<div style='font-size:12px; color:#718096; text-transform:uppercase; letter-spacing:1px;'>Variance</div>";
                 	html = html + "<div style='font-size:24px; font-weight:700; color:" + varianceColor + ";'>";
                 	if(grandVariance >= 0)
                 	{
                 		html = html + "+";
                 	}
                 	html = html + "" + thisapp.formatNumber(grandVariance) + "</div>";
                 	html = html + "<div style='font-size:12px; color:#718096;'>";
                 	if(grandVariance >= 0)
                 	{
                 		html = html + "+";
                 	}
                 	html = html + round(grandVariancePercent,1) + "%</div>";
                 	html = html + "</div>";
                 	html = html + "<div style='flex:1; min-width:150px; background:#fff; padding:16px; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,0.1);'>";
                 	html = html + "<div style='font-size:12px; color:#718096; text-transform:uppercase; letter-spacing:1px;'>Budget Status</div>";
                 	html = html + "<div style='font-size:14px; margin-top:8px;'>";
                 	html = html + "<span style='color:" + positiveColor + ";'></span> " + overBudgetCount + " Over &nbsp;";
                 	html = html + "<span style='color:" + negativeColor + ";'></span> " + underBudgetCount + " Under &nbsp;";
                 	html = html + "<span style='color:" + neutralColor + ";'></span> " + (projectCount - overBudgetCount - underBudgetCount) + " On Target";
                 	html = html + "</div>";
                 	html = html + "</div>";
                 	html = html + "</div>";
                 	// ---- MAIN DATA TABLE ----
                 	html = html + "<table style='" + tableStyle + "'>";
                 	html = html + "<thead>";
                 	html = html + "<tr style='" + headerRowStyle + "'>";
                 	html = html + "<th style='" + headerCellStyle + "'>Project</th>";
                 	html = html + "<th style='" + headerCellStyle + "'>Company</th>";
                 	html = html + "<th style='" + headerCellRightStyle + "'>Proposed</th>";
                 	html = html + "<th style='" + headerCellRightStyle + "'>Ordered</th>";
                 	html = html + "<th style='" + headerCellRightStyle + "'>Variance</th>";
                 	html = html + "<th style='" + headerCellRightStyle + "'>%</th>";
                 	html = html + "<th style='" + headerCellStyle + "text-align:center;'>Status</th>";
                 	html = html + "</tr>";
                 	html = html + "</thead>";
                 	html = html + "<tbody>";
                 	rowNum = 0;
                 	for each  item in dataList
                 	{
                 		currentRowStyle = rowStyle;
                 		if(rowNum % 2 == 1)
                 		{
                 			currentRowStyle = altRowStyle;
                 		}
                 		html = html + "<tr style='" + currentRowStyle + "'>";
                 		html = html + "<td style='" + cellStyle + "'>";
                 		html = html + "<strong>" + item.get("projectName") + "</strong><br/>";
                 		html = html + "<span style='font-size:12px; color:#718096;'>" + item.get("projectId") + "</span>";
                 		html = html + "</td>";
                 		html = html + "<td style='" + cellStyle + "'>" + item.get("company") + "</td>";
                 		html = html + "<td style='" + cellRightStyle + "'>" + thisapp.formatNumber(item.get("proposedValue")) + "</td>";
                 		html = html + "<td style='" + cellRightStyle + "'>";
                 		html = html + "" + thisapp.formatNumber(item.get("orderedValue"));
                 		if(item.get("orderCount") > 0)
                 		{
                 			html = html + "<br/><span style='font-size:11px; color:#718096;'>(" + item.get("orderCount") + " orders)</span>";
                 		}
                 		html = html + "</td>";
                 		varValue = item.get("variance");
                 		varColor = item.get("status_color");
                 		html = html + "<td style='" + cellRightStyle + "color:" + varColor + "; font-weight:600;'>";
                 		if(varValue >= 0)
                 		{
                 			html = html + "+";
                 		}
                 		html = html + "" + thisapp.formatNumber(varValue);
                 		html = html + "</td>";
                 		varPct = item.get("variancePercent");
                 		html = html + "<td style='" + cellRightStyle + "color:" + varColor + ";'>";
                 		if(varPct >= 0)
                 		{
                 			html = html + "+";
                 		}
                 		html = html + varPct + "%";
                 		html = html + "</td>";
                 		html = html + "<td style='" + cellStyle + "text-align:center;'>";
                 		html = html + "<span style='display:inline-block; padding:4px 12px; border-radius:12px; font-size:11px; font-weight:600; ";
                 		html = html + "background-color:" + item.get("status_color") + "22; color:" + item.get("status_color") + ";'>";
                 		html = html + item.get("status_label");
                 		html = html + "</span>";
                 		html = html + "</td>";
                 		html = html + "</tr>";
                 		// ---- VISUAL BAR ----
                 		html = html + "<tr style='" + currentRowStyle + "'>";
                 		html = html + "<td colspan='7' style='padding:4px 16px 12px 16px; border:1px solid #e2e8f0; border-top:none;'>";
                 		maxVal = item.get("proposedValue");
                 		if(item.get("orderedValue") > maxVal)
                 		{
                 			maxVal = item.get("orderedValue");
                 		}
                 		if(maxVal == 0)
                 		{
                 			maxVal = 1;
                 		}
                 		proposedWidth = item.get("proposedValue") / maxVal * 100;
                 		orderedWidth = item.get("orderedValue") / maxVal * 100;
                 		html = html + "<div style='display:flex; align-items:center; margin-bottom:4px;'>";
                 		html = html + "<span style='width:60px; font-size:11px; color:#718096;'>Proposed</span>";
                 		html = html + "<div style='flex:1; background:#e2e8f0; height:8px; border-radius:4px; overflow:hidden;'>";
                 		html = html + "<div style='width:" + proposedWidth + "%; height:100%; background:#667eea; border-radius:4px;'></div>";
                 		html = html + "</div>";
                 		html = html + "</div>";
                 		html = html + "<div style='display:flex; align-items:center;'>";
                 		html = html + "<span style='width:60px; font-size:11px; color:#718096;'>Ordered</span>";
                 		html = html + "<div style='flex:1; background:#e2e8f0; height:8px; border-radius:4px; overflow:hidden;'>";
                 		html = html + "<div style='width:" + orderedWidth + "%; height:100%; background:#48bb78; border-radius:4px;'></div>";
                 		html = html + "</div>";
                 		html = html + "</div>";
                 		html = html + "</td>";
                 		html = html + "</tr>";
                 		rowNum = rowNum + 1;
                 	}
                 	html = html + "</tbody>";
                 	// ---- TOTALS ROW ----
                 	html = html + "<tfoot>";
                 	html = html + "<tr style='" + totalRowStyle + "'>";
                 	html = html + "<td style='" + totalCellStyle + "' colspan='2'><strong>GRAND TOTAL</strong></td>";
                 	html = html + "<td style='" + totalCellRightStyle + "'>" + thisapp.formatNumber(grandTotalProposed) + "</td>";
                 	html = html + "<td style='" + totalCellRightStyle + "'>" + thisapp.formatNumber(grandTotalOrdered) + "</td>";
                 	html = html + "<td style='" + totalCellRightStyle + "'>";
                 	if(grandVariance >= 0)
                 	{
                 		html = html + "+";
                 	}
                 	html = html + "" + thisapp.formatNumber(grandVariance) + "</td>";
                 	html = html + "<td style='" + totalCellRightStyle + "'>";
                 	if(grandVariancePercent >= 0)
                 	{
                 		html = html + "+";
                 	}
                 	html = html + round(grandVariancePercent,1) + "%</td>";
                 	html = html + "<td style='" + totalCellStyle + "'></td>";
                 	html = html + "</tr>";
                 	html = html + "</tfoot>";
                 	html = html + "</table>";
                 	// Footer
                 	html = html + "<div style='padding:16px; background:#f7fafc; border:1px solid #e2e8f0; border-top:none; border-radius:0 0 8px 8px;'>";
                 	html = html + "<p style='margin:0; font-size:12px; color:#718096;'>";
                 	html = html + " Over Budget = Ordered > Proposed by more than 5% &nbsp;&nbsp;";
                 	html = html + " Under Budget = Ordered < Proposed by more than 5% &nbsp;&nbsp;";
                 	html = html + " On Target = Within 5%";
                 	html = html + "</p>";
                 	html = html + "<p style='margin:8px 0 0 0; font-size:11px; color:#a0aec0;'>";
                 	html = html + "Report generated by RASCOR Stock Management System";
                 	html = html + "</p>";
                 	html = html + "</div>";
                 	html = html + "</div>";
                 	return html;
                 }
				 string fn_GenerateSimpleComparisonTable()
                 {
                 	html = "<table style='width:100%; border-collapse:collapse; font-family:Arial,sans-serif;'>";
                 	// Header
                 	html = html + "<tr style='background:#1a365d; color:#fff;'>";
                 	html = html + "<th style='padding:10px; text-align:left; border:1px solid #2d4a6f;'>Project</th>";
                 	html = html + "<th style='padding:10px; text-align:right; border:1px solid #2d4a6f;'>Proposed</th>";
                 	html = html + "<th style='padding:10px; text-align:right; border:1px solid #2d4a6f;'>Ordered</th>";
                 	html = html + "<th style='padding:10px; text-align:right; border:1px solid #2d4a6f;'>Variance</th>";
                 	html = html + "</tr>";
                 	// Data
                 	proposals = Project_Proposals[Proposal_Status == "Accepted" || Proposal_Status == "In Progress"];
                 	totalProposed = 0.0;
                 	totalOrdered = 0.0;
                 	rowNum = 0;
                 	for each  prop in proposals
                 	{
                 		// Get proposed value
                 		proposedValue = ifnull(prop.Agreed_Price,0);
                 		totalProposed = totalProposed + proposedValue;
                 		// Get ordered value (simplified - implement your matching)
                 		orderedValue = 0.0;
                 		// Add your order matching logic here
                 		totalOrdered = totalOrdered + orderedValue;
                 		// Variance
                 		variance = orderedValue - proposedValue;
                 		varColor = "#000";
                 		if(variance > 0)
                 		{
                 			varColor = "#c53030";
                 		}
                 		else if(variance < 0)
                 		{
                 			varColor = "#276749";
                 		}
                 		// Row color
                 		bgColor = "#fff";
                 		if(rowNum % 2 == 1)
                 		{
                 			bgColor = "#f7fafc";
                 		}
                 		html = html + "<tr style='background:" + bgColor + ";'>";
                 		html = html + "<td style='padding:8px; border:1px solid #e2e8f0;'>" + ifnull(prop.Project_Name,"N/A") + "</td>";
                 		html = html + "<td style='padding:8px; border:1px solid #e2e8f0; text-align:right;'>" + proposedValue + "</td>";
                 		html = html + "<td style='padding:8px; border:1px solid #e2e8f0; text-align:right;'>" + orderedValue + "</td>";
                 		html = html + "<td style='padding:8px; border:1px solid #e2e8f0; text-align:right; color:" + varColor + ";'>";
                 		if(variance >= 0)
                 		{
                 			html = html + "+";
                 		}
                 		html = html + "" + variance + "</td>";
                 		html = html + "</tr>";
                 		rowNum = rowNum + 1;
                 	}
                 	// Total row
                 	totalVariance = totalOrdered - totalProposed;
                 	html = html + "<tr style='background:#2d3748; color:#fff; font-weight:600;'>";
                 	html = html + "<td style='padding:10px; border:1px solid #1a202c;'>TOTAL</td>";
                 	html = html + "<td style='padding:10px; border:1px solid #1a202c; text-align:right;'>" + totalProposed + "</td>";
                 	html = html + "<td style='padding:10px; border:1px solid #1a202c; text-align:right;'>" + totalOrdered + "</td>";
                 	html = html + "<td style='padding:10px; border:1px solid #1a202c; text-align:right;'>";
                 	if(totalVariance >= 0)
                 	{
                 		html = html + "+";
                 	}
                 	html = html + "" + totalVariance + "</td>";
                 	html = html + "</tr>";
                 	html = html + "</table>";
                 	return html;
                 }
				 string fn_GenerateStockReport()
                 {
                 	// ============================================
                 	// STOCK REPORT GENERATOR - OPTIMIZED
                 	// ============================================
                 	// --------------------------------------------
                 	// 1. FETCH ALL DATA
                 	// --------------------------------------------
                 	stockLevels = Stock_Levels[ID != null];
                 	products = Product_Master[ID != null];
                 	locations = Stock_Locations[ID != null];
                 	// Build lookup maps
                 	productMap = Map();
                 	for each  prod in products
                 	{
                 		productMap.put(prod.ID.toString(),{"name":prod.Product_Name,"category":ifnull(prod.Category.Category_Name,"Uncategorized"),"base_rate":ifnull(prod.Base_Rate,0.00),"reorder_level":ifnull(prod.Reorder_Level,0)});
                 	}
                 	locationMap = Map();
                 	for each  loc in locations
                 	{
                 		locationMap.put(loc.ID.toString(),loc.Location_Name);
                 	}
                 	// --------------------------------------------
                 	// 2. PROCESS STOCK DATA
                 	// --------------------------------------------
                 	stockItems = List();
                 	totalValue = 0.00;
                 	totalItems = 0;
                 	lowStockCount = 0;
                 	outOfStockCount = 0;
                 	locationStats = Map();
                 	categoryStats = Map();
                 	for each  stock in stockLevels
                 	{
                 		productId = stock.Product.toString();
                 		locationId = ifnull(stock.Location,"").toString();
                 		prodData = productMap.get(productId);
                 		if(prodData != null)
                 		{
                 			productName = prodData.get("name");
                 			categoryName = prodData.get("category");
                 			baseRate = prodData.get("base_rate").toDecimal();
                 			reorderLevel = prodData.get("reorder_level").toLong();
                 		}
                 		else
                 		{
                 			productName = "Unknown Product";
                 			categoryName = "Uncategorized";
                 			baseRate = 0.00;
                 			reorderLevel = 0;
                 		}
                 		locationName = locationMap.get(locationId);
                 		if(locationName == null)
                 		{
                 			locationName = "Unassigned";
                 		}
                 		qtyOnHand = ifnull(stock.Quantity_On_Hand,0);
                 		qtyAvailable = ifnull(stock.Quantity_Available,0);
                 		itemValue = qtyOnHand * baseRate;
                 		if(qtyOnHand == 0)
                 		{
                 			status = "OUT";
                 			outOfStockCount = outOfStockCount + 1;
                 		}
                 		else if(qtyOnHand <= reorderLevel)
                 		{
                 			status = "LOW";
                 			lowStockCount = lowStockCount + 1;
                 		}
                 		else
                 		{
                 			status = "OK";
                 		}
                 		shortfall = 0;
                 		if(qtyOnHand < reorderLevel)
                 		{
                 			shortfall = reorderLevel - qtyOnHand;
                 		}
                 		stockItems.add({"product_name":productName,"category":categoryName,"location":locationName,"qty_on_hand":qtyOnHand,"qty_available":qtyAvailable,"value":itemValue,"reorder_level":reorderLevel,"shortfall":shortfall,"status":status});
                 		totalValue = totalValue + itemValue;
                 		totalItems = totalItems + 1;
                 		// Location stats
                 		if(locationStats.get(locationName) != null)
                 		{
                 			locData = locationStats.get(locationName);
                 			locData.put("items",locData.get("items") + 1);
                 			locData.put("value",locData.get("value") + itemValue);
                 		}
                 		else
                 		{
                 			locationStats.put(locationName,{"items":1,"value":itemValue});
                 		}
                 		// Category stats
                 		if(categoryStats.get(categoryName) != null)
                 		{
                 			catData = categoryStats.get(categoryName);
                 			catData.put("items",catData.get("items") + 1);
                 			catData.put("qty",catData.get("qty") + qtyOnHand);
                 			catData.put("value",catData.get("value") + itemValue);
                 			catData.put("low_stock",catData.get("low_stock") + if(status == "LOW" || status == "OUT",1,0));
                 		}
                 		else
                 		{
                 			categoryStats.put(categoryName,{"items":1,"qty":qtyOnHand,"value":itemValue,"low_stock":if(status == "LOW" || status == "OUT",1,0)});
                 		}
                 	}
                 	// --------------------------------------------
                 	// 3. ABC CLASSIFICATION - OPTIMIZED (no nested loops)
                 	// --------------------------------------------
                 	// Use value thresholds instead of ranking each item
                 	aThreshold = totalValue * 0.03;
                 	bThreshold = totalValue * 0.01;
                 	aCount = 0;
                 	bCount = 0;
                 	cCount = 0;
                 	abcList = List();
                 	for each  item in stockItems
                 	{
                 		itemValue = item.get("value").toDecimal();
                 		if(itemValue >= aThreshold)
                 		{
                 			abcList.add("A");
                 			aCount = aCount + 1;
                 		}
                 		else if(itemValue >= bThreshold)
                 		{
                 			abcList.add("B");
                 			bCount = bCount + 1;
                 		}
                 		else
                 		{
                 			abcList.add("C");
                 			cCount = cCount + 1;
                 		}
                 	}
                 	// --------------------------------------------
                 	// 4. BUILD HTML REPORT
                 	// --------------------------------------------
                 	html = "";
                 	// CSS Styles
                 	html = html + "<style>";
                 	html = html + "* { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; box-sizing: border-box; }";
                 	html = html + ".report-container { max-width: 1400px; margin: 0 auto; padding: 20px; background: #f5f7fa; }";
                 	html = html + ".report-header { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 25px 30px; border-radius: 12px; margin-bottom: 25px; }";
                 	html = html + ".report-title { font-size: 28px; font-weight: 700; margin: 0 0 5px 0; }";
                 	html = html + ".report-subtitle { font-size: 14px; opacity: 0.85; margin: 0; }";
                 	html = html + ".summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; margin-bottom: 25px; }";
                 	html = html + ".summary-card { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); text-align: center; }";
                 	html = html + ".summary-card.alert { border-left: 4px solid #e74c3c; }";
                 	html = html + ".summary-card.warning { border-left: 4px solid #f39c12; }";
                 	html = html + ".summary-card.success { border-left: 4px solid #27ae60; }";
                 	html = html + ".summary-card.info { border-left: 4px solid #3498db; }";
                 	html = html + ".summary-value { font-size: 32px; font-weight: 700; margin-bottom: 5px; }";
                 	html = html + ".summary-value.alert { color: #e74c3c; }";
                 	html = html + ".summary-value.warning { color: #f39c12; }";
                 	html = html + ".summary-value.success { color: #27ae60; }";
                 	html = html + ".summary-value.info { color: #3498db; }";
                 	html = html + ".summary-label { font-size: 13px; color: #7f8c8d; text-transform: uppercase; letter-spacing: 0.5px; }";
                 	html = html + ".section { background: white; border-radius: 12px; padding: 25px; margin-bottom: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }";
                 	html = html + ".section-title { font-size: 18px; font-weight: 600; color: #2c3e50; margin: 0 0 20px 0; padding-bottom: 10px; border-bottom: 2px solid #ecf0f1; }";
                 	html = html + "table { width: 100%; border-collapse: collapse; font-size: 14px; }";
                 	html = html + "th { background: #f8f9fa; padding: 12px 15px; text-align: left; font-weight: 600; color: #2c3e50; border-bottom: 2px solid #ecf0f1; }";
                 	html = html + "td { padding: 12px 15px; border-bottom: 1px solid #ecf0f1; color: #34495e; }";
                 	html = html + "tr:hover { background: #f8f9fa; }";
                 	html = html + ".text-right { text-align: right; }";
                 	html = html + ".text-center { text-align: center; }";
                 	html = html + ".status { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; }";
                 	html = html + ".status-ok { background: #d4edda; color: #155724; }";
                 	html = html + ".status-low { background: #fff3cd; color: #856404; }";
                 	html = html + ".status-out { background: #f8d7da; color: #721c24; }";
                 	html = html + ".abc { display: inline-block; width: 28px; height: 28px; line-height: 28px; border-radius: 50%; font-size: 12px; font-weight: 700; text-align: center; }";
                 	html = html + ".abc-a { background: #e74c3c; color: white; }";
                 	html = html + ".abc-b { background: #f39c12; color: white; }";
                 	html = html + ".abc-c { background: #95a5a6; color: white; }";
                 	html = html + ".progress-bar { background: #ecf0f1; border-radius: 10px; height: 20px; overflow: hidden; }";
                 	html = html + ".progress-fill { height: 100%; border-radius: 10px; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px; font-size: 11px; font-weight: 600; color: white; min-width: 40px; }";
                 	html = html + ".progress-fill.blue { background: linear-gradient(90deg, #3498db, #2980b9); }";
                 	html = html + ".abc-bar { display: flex; height: 30px; border-radius: 8px; overflow: hidden; margin: 15px 0; }";
                 	html = html + ".abc-segment { display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600; color: white; }";
                 	html = html + ".abc-segment.a { background: #e74c3c; }";
                 	html = html + ".abc-segment.b { background: #f39c12; }";
                 	html = html + ".abc-segment.c { background: #95a5a6; }";
                 	html = html + ".empty-state { text-align: center; padding: 30px; color: #95a5a6; }";
                 	html = html + "</style>";
                 	// Report Container
                 	html = html + "<div class='report-container'>";
                 	html = html + "<div style='margin-bottom: 15px;'><a href='#Page:Main_Dashboard' style='display: inline-block; padding: 10px 20px; background-color: #7030A0; color: white; text-decoration: none; border-radius: 5px;'> Back to Dashboard</a></div>";
                 	// Header
                 	html = html + "<div class='report-header'>";
                 	html = html + "<h1 class='report-title'> Stock Report</h1>";
                 	html = html + "<p class='report-subtitle'>Generated: " + zoho.currenttime.toString("dd MMM yyyy 'at' HH:mm") + "</p>";
                 	html = html + "</div>";
                 	// Summary Cards
                 	html = html + "<div class='summary-grid'>";
                 	html = html + "<div class='summary-card info'><div class='summary-value info'>" + totalItems + "</div><div class='summary-label'>Total Stock Items</div></div>";
                 	html = html + "<div class='summary-card success'><div class='summary-value success'>" + thisapp.formatNumber(totalValue.round(0)) + "</div><div class='summary-label'>Total Stock Value</div></div>";
                 	html = html + "<div class='summary-card warning'><div class='summary-value warning'>" + lowStockCount + "</div><div class='summary-label'>Low Stock Items</div></div>";
                 	html = html + "<div class='summary-card alert'><div class='summary-value alert'>" + outOfStockCount + "</div><div class='summary-label'>Out of Stock</div></div>";
                 	html = html + "</div>";
                 	// ABC Classification Summary
                 	html = html + "<div class='section'>";
                 	html = html + "<h3 class='section-title'> ABC Classification</h3>";
                 	if(totalItems > 0)
                 	{
                 		aPercent = (aCount * 100) / totalItems;
                 		bPercent = (bCount * 100) / totalItems;
                 		cPercent = (cCount * 100) / totalItems;
                 		html = html + "<div class='abc-bar'>";
                 		if(aPercent > 0)
                 		{
                 			html = html + "<div class='abc-segment a' style='width: " + aPercent + "%'>A: " + aCount + "</div>";
                 		}
                 		if(bPercent > 0)
                 		{
                 			html = html + "<div class='abc-segment b' style='width: " + bPercent + "%'>B: " + bCount + "</div>";
                 		}
                 		if(cPercent > 0)
                 		{
                 			html = html + "<div class='abc-segment c' style='width: " + cPercent + "%'>C: " + cCount + "</div>";
                 		}
                 		html = html + "</div>";
                 	}
                 	html = html + "</div>";
                 	// Out of Stock Section
                 	html = html + "<div class='section'>";
                 	html = html + "<h3 class='section-title'> Out of Stock (" + outOfStockCount + ")</h3>";
                 	if(outOfStockCount > 0)
                 	{
                 		html = html + "<table><tr><th>Product</th><th>Category</th><th>Location</th><th class='text-right'>Reorder Level</th></tr>";
                 		idx = 0;
                 		for each  item in stockItems
                 		{
                 			if(item.get("status") == "OUT")
                 			{
                 				html = html + "<tr><td><strong>" + item.get("product_name") + "</strong></td><td>" + item.get("category") + "</td><td>" + item.get("location") + "</td><td class='text-right'>" + item.get("reorder_level") + "</td></tr>";
                 			}
                 			idx = idx + 1;
                 		}
                 		html = html + "</table>";
                 	}
                 	else
                 	{
                 		html = html + "<div class='empty-state'> No items out of stock</div>";
                 	}
                 	html = html + "</div>";
                 	// Low Stock Section
                 	html = html + "<div class='section'>";
                 	html = html + "<h3 class='section-title'> Low Stock (" + lowStockCount + ")</h3>";
                 	if(lowStockCount > 0)
                 	{
                 		html = html + "<table><tr><th>Product</th><th>Category</th><th class='text-right'>On Hand</th><th class='text-right'>Reorder</th><th class='text-right'>Shortfall</th></tr>";
                 		for each  item in stockItems
                 		{
                 			if(item.get("status") == "LOW")
                 			{
                 				html = html + "<tr><td><strong>" + item.get("product_name") + "</strong></td><td>" + item.get("category") + "</td><td class='text-right'>" + item.get("qty_on_hand") + "</td><td class='text-right'>" + item.get("reorder_level") + "</td><td class='text-right' style='color:#e74c3c;font-weight:600;'>-" + item.get("shortfall") + "</td></tr>";
                 			}
                 		}
                 		html = html + "</table>";
                 	}
                 	else
                 	{
                 		html = html + "<div class='empty-state'> All items above reorder level</div>";
                 	}
                 	html = html + "</div>";
                 	// Stock by Category
                 	html = html + "<div class='section'>";
                 	html = html + "<h3 class='section-title'> Stock by Category</h3>";
                 	if(categoryStats.size() > 0)
                 	{
                 		html = html + "<table><tr><th>Category</th><th class='text-right'>Items</th><th class='text-right'>Qty</th><th class='text-right'>Value</th><th class='text-right'>Low/Out</th></tr>";
                 		for each  catName in categoryStats.keys()
                 		{
                 			catData = categoryStats.get(catName);
                 			lowCount = catData.get("low_stock");
                 			lowStyle = if(lowCount > 0,"status-low","status-ok");
                 			lowText = if(lowCount > 0,lowCount + " items","None");
                 			html = html + "<tr><td><strong>" + catName + "</strong></td><td class='text-right'>" + catData.get("items") + "</td><td class='text-right'>" + catData.get("qty") + "</td><td class='text-right'>" + thisapp.formatNumber(catData.get("value").round(0)) + "</td><td class='text-right'><span class='status " + lowStyle + "'>" + lowText + "</span></td></tr>";
                 		}
                 		html = html + "</table>";
                 	}
                 	html = html + "</div>";
                 	// Footer
                 	html = html + "<div style='text-align:center;padding:20px;color:#95a5a6;font-size:12px;'>RASCOR Stock Management System</div>";
                 	html = html + "</div>";
                 	return html;
                 }
				 void fn_GetLookupIds()
                 {
                 	// Get Stock Locations
                 	locations = Stock_Locations[ID != null];
                 	for each  loc in locations
                 	{
                 		info "Location ID: " + loc.ID + " - " + loc.Location_Name;
                 	}
                 }
				 void fn_GetProposalIds()
                 {
                 	proposals = Project_Proposals[ID != null];
                 	for each  p in proposals
                 	{
                 		info "ID: " + p.ID + " | Name: " + p.Project_Name + " | Status: " + p.Proposal_Status;
                 	}
                 }
				 void fn_PopulateBaseRates()
                 {
                 	// ============================================
                 	// POPULATE BASE_RATES BY CATEGORY
                 	// ============================================
                 	allProducts = Product_Master[ID != null];
                 	updatedCount = 0;
                 	for each  prod in allProducts
                 	{
                 		// Skip if Base_Rate already set
                 		currentRate = ifnull(prod.Base_Rate,0);
                 		if(currentRate > 0)
                 		{
                 			continue;
                 		}
                 		// Get category name
                 		categoryName = "";
                 		if(prod.Category != null)
                 		{
                 			categoryName = prod.Category.Category_Name.toLowerCase();
                 		}
                 		// Set price range based on category
                 		minPrice = 10;
                 		maxPrice = 50;
                 		if(categoryName.contains("waterproof") || categoryName.contains("damp"))
                 		{
                 			minPrice = 15;
                 			maxPrice = 75;
                 		}
                 		else if(categoryName.contains("fixing") || categoryName.contains("screw") || categoryName.contains("nail"))
                 		{
                 			minPrice = 2;
                 			maxPrice = 15;
                 		}
                 		else if(categoryName.contains("tool"))
                 		{
                 			minPrice = 20;
                 			maxPrice = 120;
                 		}
                 		else if(categoryName.contains("ppe") || categoryName.contains("safety"))
                 		{
                 			minPrice = 5;
                 			maxPrice = 35;
                 		}
                 		else if(categoryName.contains("aggregate") || categoryName.contains("sand") || categoryName.contains("gravel"))
                 		{
                 			minPrice = 30;
                 			maxPrice = 80;
                 		}
                 		else if(categoryName.contains("cement") || categoryName.contains("concrete"))
                 		{
                 			minPrice = 8;
                 			maxPrice = 25;
                 		}
                 		else if(categoryName.contains("timber") || categoryName.contains("wood"))
                 		{
                 			minPrice = 10;
                 			maxPrice = 60;
                 		}
                 		else if(categoryName.contains("pipe") || categoryName.contains("drainage"))
                 		{
                 			minPrice = 5;
                 			maxPrice = 45;
                 		}
                 		else if(categoryName.contains("electric") || categoryName.contains("cable"))
                 		{
                 			minPrice = 8;
                 			maxPrice = 50;
                 		}
                 		else if(categoryName.contains("paint") || categoryName.contains("finish"))
                 		{
                 			minPrice = 12;
                 			maxPrice = 55;
                 		}
                 		else if(categoryName.contains("adhesive") || categoryName.contains("sealant"))
                 		{
                 			minPrice = 6;
                 			maxPrice = 25;
                 		}
                 		else if(categoryName.contains("insulation"))
                 		{
                 			minPrice = 15;
                 			maxPrice = 65;
                 		}
                 		// Generate random price within range
                 		priceRange = maxPrice - minPrice;
                 		randomFactor = (prod.ID % 100) / 100.0;
                 		baseRate = minPrice + priceRange * randomFactor;
                 		// Round to 2 decimal places
                 		baseRate = baseRate.round(2);
                 		// Update the product
                 		prod.Base_Rate=baseRate;
                 		updatedCount = updatedCount + 1;
                 	}
                 	info "Updated " + updatedCount + " products with Base_Rates";
                 }
				 void fn_RunOrdersReport()
                 {
                 	// Generate the report HTML
                 	htmlContent = thisapp.fn_GenerateOrdersReport();
                 	// Store in Parameters form
                 	paramRec = Parameters[ID != null];
                 	for each  rec in paramRec
                 	{
                 		rec.Dynamic_Order_Report=htmlContent;
                 	}
                 	// Open the report page
                 	openUrl("#Page:Orders_Report_Page","same window");
                 }
				 void fn_RunProductsByMonthChart()
                 {
                 	// Generate the chart HTML
                 	htmlContent = thisapp.fn_GenerateProductsByMonthChart();
                 	// Store in Parameters form
                 	paramRec = Parameters[ID != null];
                 	for each  rec in paramRec
                 	{
                 		rec.Products_By_Month_Chart=htmlContent;
                 	}
                 }
				 void fn_RunProductsBySiteChart()
                 {
                 	// Generate the chart HTML
                 	htmlContent = thisapp.fn_GenerateProductsBySiteChart();
                 	// Store in Parameters form
                 	paramRec = Parameters[ID != null];
                 	for each  rec in paramRec
                 	{
                 		rec.Products_By_Site_Chart=htmlContent;
                 	}
                 }
				 void fn_RunProductsByWeekChart()
                 {
                 	// Generate the chart HTML
                 	htmlContent = thisapp.fn_GenerateProductsByWeekChart();
                 	// Store in Parameters form
                 	paramRec = Parameters[ID != null];
                 	for each  rec in paramRec
                 	{
                 		rec.Products_By_Week_Chart=htmlContent;
                 	}
                 }
				 void fn_RunProductTrendsReport()
                 {
                 	// Generate the report HTML
                 	htmlContent = thisapp.fn_GenerateProductTrendsReport();
                 	// Store in Parameters form
                 	paramRec = Parameters[ID != null];
                 	for each  rec in paramRec
                 	{
                 		rec.Product_Trends_Report=htmlContent;
                 	}
                 }
				 void fn_RunProposalReport()
                 {
                 	// Generate the report HTML
                 	htmlContent = thisapp.fn_GenerateProposalVsOrderReport();
                 	// Store in Parameters form
                 	paramRec = Parameters[ID != null];
                 	for each  rec in paramRec
                 	{
                 		rec.Proposal_Order_Comparison_Report=htmlContent;
                 	}
                 	// Open the report page
                 	openUrl("#Page:Proposal_VS_Order","same window");
                 }
				 void fn_RunStockReport()
                 {
                 	// Generate the report HTML
                 	htmlContent = thisapp.fn_GenerateStockReport();
                 	// Store in Parameters form
                 	paramRec = Parameters[ID != null];
                 	for each  rec in paramRec
                 	{
                 		rec.Dynamic_Stock_Report=htmlContent;
                 	}
                 	// Open the report page
                 	openUrl("#Page:Stock_Report_Page","same window");
                 }
				 void fn_TestProcoreConnection()
                 {
                 	// Procore Sandbox Credentials
                 	clientId = "OPHyj3ra-RXVD_Lf460db7WqwDWB1i9A0dSNa48fzZs";
                 	clientSecret = "_oNoWlczzHoyX8AcijbBa3JEUUGsh1Z6q8YhFaSJSUA";
                 	companyId = "4279460";
                 	// Step 1: Get Access Token
                 	tokenUrl = "https://login-sandbox.procore.com/oauth/token";
                 	tokenParams = Map();
                 	tokenParams.put("grant_type","client_credentials");
                 	tokenParams.put("client_id",clientId);
                 	tokenParams.put("client_secret",clientSecret);
                 	tokenResponse = invokeurl
                 	[
                 		url :tokenUrl
                 		type :POST
                 		parameters:tokenParams
                 	];
                 	accessToken = tokenResponse.get("access_token");
                 	info " Access Token Retrieved!";
                 	// Step 2: Create a New Project
                 	createUrl = "https://sandbox.procore.com/rest/v1.0/projects?company_id=" + companyId;
                 	// Build project data
                 	projectData = Map();
                 	projectData.put("name","RASCOR Test Project");
                 	projectData.put("project_number","RASCOR-001");
                 	projectData.put("address","123 Test Street");
                 	projectData.put("city","Dublin");
                 	projectData.put("country_code","IE");
                 	// Wrap in "project" object as Procore expects
                 	requestBody = Map();
                 	requestBody.put("project",projectData);
                 	headerMap = Map();
                 	headerMap.put("Authorization","Bearer " + accessToken);
                 	headerMap.put("Procore-Company-Id",companyId);
                 	headerMap.put("Content-Type","application/json");
                 	createResponse = invokeurl
                 	[
                 		url :createUrl
                 		type :POST
                 		parameters:requestBody.toString()
                 		headers:headerMap
                 	];
                 	info "Create Project Response: " + createResponse;
                 }
				 void fn_UpdateAllLineTotals()
                 {
                 	// Build a map of Product ID to Base_Rate
                 	allProducts = Product_Master[ID != null];
                 	productRates = Map();
                 	for each  prod in allProducts
                 	{
                 		productRates.put(prod.ID.toString(),ifnull(prod.Base_Rate,0));
                 	}
                 	// Update all line items
                 	allLines = Order_Line_Items[ID != null];
                 	for each  line in allLines
                 	{
                 		qty = ifnull(line.Quantity,0);
                 		// Get Base_Rate from our map
                 		productId = line.Product.ID.toString();
                 		baseRate = ifnull(productRates.get(productId),0);
                 		lineTotal = qty * baseRate;
                 		line.Line_Total_Stored=lineTotal;
                 	}
                 	info "Updated " + allLines.count() + " line items";
                 }
				 void fn_UpdateAllOrderTotals()
                 {
                 	allOrders = Stock_Ordering[ID != null];
                 	allLines = Order_Line_Items[ID != null];
                 	for each  order in allOrders
                 	{
                 		orderId = order.ID;
                 		orderTotal = 0.00;
                 		for each  line in allLines
                 		{
                 			if(line.Order != null && line.Order.ID == orderId)
                 			{
                 				qty = ifnull(line.Quantity,0);
                 				baseRate = ifnull(line.Product.Base_Rate,0);
                 				lineTotal = qty * baseRate;
                 				orderTotal = orderTotal + lineTotal;
                 			}
                 		}
                 		order.Order_Total_Stored=orderTotal;
                 	}
                 }
				 void fn_UpdateAllOrderTotals_Batch()
                 {
                 	// Get orders where total is null or zero
                 	orders = Stock_Ordering[Order_Total_Stored == null || Order_Total_Stored == 0];
                 	updated = 0;
                 	for each  ord in orders
                 	{
                 		orderTotal = 0.0;
                 		lines = Order_Line_Items[Order == ord.ID];
                 		for each  line in lines
                 		{
                 			orderTotal = orderTotal + ifnull(line.Line_Total_Stored,0);
                 		}
                 		ord.Order_Total_Stored=orderTotal;
                 		updated = updated + 1;
                 		// Limit to 20 per batch to avoid timeout
                 		if(updated >= 20)
                 		{
                 			break;
                 		}
                 	}
                 	remaining = Stock_Ordering[Order_Total_Stored == null || Order_Total_Stored == 0].count();
                 	info "Updated " + updated + " orders | Remaining: " + remaining;
                 }
				 void fn_UpdateAllPOTotals()
                 {
                 	// Pre-calculate totals per PO from line items
                 	poTotals = Map();
                 	allPOLines = PO_Line_Items[ID != null];
                 	for each  line in allPOLines
                 	{
                 		if(line.Purchase_Order != null)
                 		{
                 			poId = line.Purchase_Order.ID.toString();
                 			qtyOrdered = ifnull(line.Quantity_Ordered,0);
                 			unitPrice = ifnull(line.Unit_Price,0.00).toDecimal();
                 			lineTotal = qtyOrdered * unitPrice;
                 			currentTotal = poTotals.get(poId);
                 			if(currentTotal == null)
                 			{
                 				currentTotal = 0.00;
                 			}
                 			poTotals.put(poId,currentTotal + lineTotal);
                 		}
                 	}
                 	info "Calculated totals for " + poTotals.size() + " POs";
                 	// Update each PO
                 	allPOs = Purchase_Orders[ID != null];
                 	updated = 0;
                 	for each  po in allPOs
                 	{
                 		poId = po.ID.toString();
                 		poTotal = poTotals.get(poId);
                 		if(poTotal == null)
                 		{
                 			poTotal = 0.00;
                 		}
                 		po.Total_Value=poTotal;
                 		updated = updated + 1;
                 	}
                 	info "Updated " + updated + " Purchase Orders";
                 }
				 void fn_UpdateAllStockValues()
                 {
                 	allStock = Stock_Levels[ID != null];
                 	for each  stock in allStock
                 	{
                 		qty = ifnull(stock.Quantity_On_Hand,0);
                 		baseRate = ifnull(stock.Product.Base_Rate,0);
                 		stockValue = qty * baseRate;
                 		stock.Stock_Value_Stored=stockValue;
                 	}
                 }
				 string formatNumber(Decimal num)
                 {
                 	if(num == null)
                 	{
                 		return "0.00";
                 	}
                 	return round(num,2).toString("#,##0.00");
                 }
				 string formatNumberShort(Decimal num)
                 {
                 	if(num == null || num == 0)
                 	{
                 		return "0";
                 	}
                 	if(num >= 1000000)
                 	{
                 		return round(num / 1000000,1) + "M";
                 	}
                 	else if(num >= 1000)
                 	{
                 		return round(num / 1000,1) + "k";
                 	}
                 	else
                 	{
                 		return round(num,0).toString();
                 	}
                 }
				 map Get_Dashboard_Stats()
                 {
                 	// Total Stock Value
                 	allStock = Stock_Levels[ID != null];
                 	totalValue = 0;
                 	lowStockCount = 0;
                 	for each  s in allStock
                 	{
                 		stockVal = ifnull(s.Quantity_On_Hand,0) * ifnull(s.Product.Base_Rate,0);
                 		totalValue = totalValue + stockVal;
                 		// Check low stock
                 		available = ifnull(s.Quantity_On_Hand,0) - ifnull(s.Quantity_Reserved,0);
                 		reorderLevel = ifnull(s.Product.Reorder_Level,0);
                 		if(available < reorderLevel)
                 		{
                 			lowStockCount = lowStockCount + 1;
                 		}
                 	}
                 	// Pending POs
                 	pendingPOs = Purchase_Orders[PO_Status == "Submitted" || PO_Status == "Confirmed" || PO_Status == "Partially Received"];
                 	pendingPOCount = pendingPOs.count();
                 	// Orders awaiting approval
                 	pendingApproval = Stock_Ordering[Order_Status == "Pending Approval"];
                 	pendingApprovalCount = pendingApproval.count();
                 	// Return as map
                 	result = Map();
                 	result.put("totalValue",totalValue);
                 	result.put("lowStockCount",lowStockCount);
                 	result.put("pendingPOCount",pendingPOCount);
                 	result.put("pendingApprovalCount",pendingApprovalCount);
                 	return result;
                 }
			 }
		 }
		workflow
		{
		form
		{
			HideFields as "HideFields"
			{
				type =  form
				form = Stock_Ordering
				record event = on add or edit

				on load
				{
					actions 
					{
						custom deluge script
						(
											hide Collection_Date;
										hide Collection_Status;
										hide Order_Date;
										hide Submitted_Date;
										hide Approved_By;
										hide Approved_Date;
										hide Edit_Mode;
										hide Docket_Generated;
										hide Docket_PDF;
										hide Excel_Synced;
										hide Order.Line_Status;
										hide Order.Line_Notes;
										hide Order.Is_Ancillary;
						)
					}
				}

			}
			Prevent_Duplicate_Product as "Prevent_Duplicate_Product_Assignment"
			{
				type =  form
				form = Site_Product_Catalog
				record event = on add

				on validate
				{
					actions 
					{
						custom deluge script
						(
											// Check if this Site + Product combination already exists
										if(input.Site != null && input.Product != null)
										{
											existing = Site_Product_Catalog[Site == input.Site && Product == input.Product && ID != input.ID];
											if(existing.count() > 0)
											{
												// Set fields to null to trigger required field error
												input.Site = null;
												input.Product = null;
											}
										}
						)
					}
				}

			}
			HideFields1 as "HideFields"
			{
				type =  form
				form = Order_Line_Items
				record event = on add or edit

				on load
				{
					actions 
					{
						custom deluge script
						(
											hide Order;
										hide Line_Notes;
										hide Is_Ancillary;
										hide Line_Status;
						)
					}
				}

			}
			Load_Products_On_Site_Sel as "Load_Products_On_Site_Selection"
			{
				type =  form
				form = Stock_Ordering
				record event = on add or edit

				on user input of Sites_Reference
				{
					actions 
					{
						custom deluge script
						(
											if(input.Sites_Reference != null)
										{
											siteId = input.Sites_Reference;
											// Get all products assigned to this site
											siteProducts = Site_Product_Catalog[Site == siteId && Active == "Active"];
											// Clear existing products first (in case user changes site)
											input.Order.clear();
											// Insert each product into the subform
											for each  catalogEntry in siteProducts
											{
												// Create a new subform row
												productRow = Stock_Ordering.Order();
												// Set the product
												productRow.Product=catalogEntry.Product;
												// Set quantity to 0
												productRow.Quantity=0;
												// Set status
												productRow.Line_Status="Pending";
												// Insert the row into the subform
												input.Order.insert(productRow);
												info "Added product: " + catalogEntry.Product;
											}
											info "Loaded " + siteProducts.count() + " products into subform";
										}
						)
					}
				}

			}
			Validate_Stock_Order as "Validate_Stock_Order"
			{
				type =  form
				form = Stock_Ordering
				record event = on add or edit

				on validate
				{
					actions 
					{
						custom deluge script
						(
											hasValidItem = false;
										// Loop through subform rows in memory
										for each  row in input.Order
										{
											if(row.Quantity != null && row.Quantity > 0)
											{
												hasValidItem = true;
												break;
											}
										}
										if(hasValidItem == false)
										{
											alert "Please enter a quantity for at least one product.";
											cancel submit;
										}
						)
					}
				}

			}
			Cleanup_Order_Line_Items as "Cleanup_Order_Line_Items"
			{
				type =  form
				form = Stock_Ordering
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											if(input.ID != null)
										{
											// input.ID is Zoho's internal ID for this Stock_Ordering record
											orderId = input.ID;
											// info "Processing Order - Internal ID: " + orderId;
											// info "Order Number: " + input.Order_Number;
											// Get all line items from the subform (subform field name is "Order")
											subformItems = input.Order;
											// info "Found " + subformItems.count() + " items in subform";
											deletedCount = 0;
											keptCount = 0;
											for each  item in subformItems
											{
												itemId = item.ID;
												qty = item.Quantity;
												// info "Line Item ID: " + itemId + ", Qty: " + qty;
												if(qty == null || qty == 0 || qty <= 0)
												{
													// Delete zero quantity items
													delete from Order_Line_Items[ID == itemId];
													deletedCount = deletedCount + 1;
													// info "Deleted item with zero quantity";
												}
												else
												{
													lineItem = Order_Line_Items[ID == itemId];
													lineItem.Order=orderId;
													keptCount = keptCount + 1;
													// info "Kept item with Qty: " + qty;
												}
											}
											// info "Summary: Kept " + keptCount + " items, Deleted " + deletedCount + " zero-qty items";
										}
						)
					}
				}

			}
			Send_PDF_Order_Docket as "Send_PDF_Order_Docket"
			{
				type =  form
				form = Stock_Ordering
				record event = on add or edit

				on success
				{
					actions 
					{
						sendmail
						(
							from : "zoho.adminuserid"
							to : "eddie_heff@yahoo.com","donal@quantumbuild.ai"
							subject : "New Stock Order"
							message : "<div><span><span>A new stock order has been submitted. </span></span><br></div><div><br></div><div><span>Order Number: ${Order_Number} </span><br></div><div><span>Date: ${Order_Date} </span><br></div><div><span>Project: ${Sites_Reference.Site_Name} </span><br></div><div><span>Ordered By: ${Ordered_by_Employee.Employee_Display_Name} </span><br></div><div><span>Collection: ${Collection_Status} </span><br></div><div><br></div><div><span>Please see the attached Order Docket (PDF) for full details.</span><br></div><div><br></div><div><span><span>--------------------------------------------------------------------------------------</span></span><br></div><div><span><span>This is an automated notification from RASCOR Stock Management.</span></span> <br></div>"
							attachments : template : Order_Docket as pdf
						)
					}
				}

			}
			Generate_Proposal_Number as "Generate_Proposal_Number"
			{
				type =  form
				form = Project_Proposals
				record event = on add

				on validate
				{
					actions 
					{
						custom deluge script
						(
											// Get current date components
										today = zoho.currentdate;
										year = today.toString("yy");
										month = today.toString("MM");
										day = today.toString("dd");
										// Get start and end of today for counting existing proposals
										todayStart = today.toString("dd-MMM-yyyy") + " 00:00:00";
										todayEnd = today.toString("dd-MMM-yyyy") + " 23:59:59";
										existingToday = Project_Proposals[Added_Time >= todayStart && Added_Time <= todayEnd];
										sequence = existingToday.count();
										if(sequence < 10)
										{
											seqStr = "0" + sequence.toString();
										}
										else
										{
											seqStr = sequence.toString();
										}
										proposalNum = "IR" + year + month + day + seqStr;
										// Update the record
										input.Proposal_Number = proposalNum;
						)
					}
				}

			}
			Calculate_Line_Total_OnAd as "Calculate_Line_Total_OnAdd"
			{
				type =  form
				form = Proposal_Line_Items
				record event = on add

				on success
				{
					actions 
					{
						custom deluge script
						(
											// Calculate line total
										qty = ifnull(input.Quantity,0);
										rate = ifnull(input.Rate,0);
										input.Line_Total = qty * rate;
						)
					}
				}

			}
			Calculate_Line_Total_OnEd as "Calculate_Line_Total_OnEdit"
			{
				type =  form
				form = Proposal_Line_Items
				record event = on edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											// Calculate line total
										qty = ifnull(input.Quantity,0);
										rate = ifnull(input.Rate,0);
										input.Line_Total = qty * rate;
						)
					}
				}

			}
			Autofill_Product_Details as "Autofill_Product_Details"
			{
				type =  form
				form = Proposal_Line_Items
				record event = on add

				on user input of Product
				{
					actions 
					{
						custom deluge script
						(
											if(input.Product != null)
										{
											prod = Product_Master[ID == input.Product];
											for each  p in prod
											{
												input.Description = p.Product_Name;
												input.Unit = p.Unit_Type;
												input.Rate = ifnull(p.Base_Rate,0);
												break;
											}
										}
						)
					}
				}

			}
			Update_Package_Total_OnAd as "Update_Package_Total_OnAdd"
			{
				type =  form
				form = Proposal_Line_Items
				record event = on add

				on success
				{
					actions 
					{
						custom deluge script
						(
											wpID = input.Work_Package;
										if(wpID != null)
										{
											lineItems = Proposal_Line_Items[Work_Package == wpID];
											total = 0.0;
											for each  item in lineItems
											{
												total = total + ifnull(item.Line_Total,0);
											}
											wp = Proposal_Work_Packages[ID == wpID];
											for each  w in wp
											{
												w.Package_Total=total;
												proposalID = w.Proposal;
											}
											if(proposalID != null)
											{
												packages = Proposal_Work_Packages[Proposal == proposalID];
												proposalTotal = 0.0;
												for each  pkg in packages
												{
													proposalTotal = proposalTotal + ifnull(pkg.Package_Total,0);
												}
												prop = Project_Proposals[ID == proposalID];
												for each  pr in prop
												{
													pr.Agreed_Price=proposalTotal;
												}
											}
										}
						)
					}
				}

			}
			Update_Package_Total_OnEd as "Update_Package_Total_OnEdit"
			{
				type =  form
				form = Proposal_Line_Items
				record event = on edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											wpID = input.Work_Package;
										if(wpID != null)
										{
											lineItems = Proposal_Line_Items[Work_Package == wpID];
											total = 0.0;
											for each  item in lineItems
											{
												total = total + ifnull(item.Line_Total,0);
											}
											wp = Proposal_Work_Packages[ID == wpID];
											for each  w in wp
											{
												w.Package_Total=total;
												proposalID = w.Proposal;
											}
											if(proposalID != null)
											{
												packages = Proposal_Work_Packages[Proposal == proposalID];
												proposalTotal = 0.0;
												for each  pkg in packages
												{
													proposalTotal = proposalTotal + ifnull(pkg.Package_Total,0);
												}
												prop = Project_Proposals[ID == proposalID];
												for each  pr in prop
												{
													pr.Agreed_Price=proposalTotal;
												}
											}
										}
						)
					}
				}

			}
			Update_Package_Total_OnDe as "Update_Package_Total_OnDelete"
			{
				type =  form
				form = Proposal_Line_Items
				record event = on delete

				on success
				{
					actions 
					{
						custom deluge script
						(
											wpID = input.Work_Package;
										if(wpID != null)
										{
											lineItems = Proposal_Line_Items[Work_Package == wpID];
											total = 0.0;
											for each  item in lineItems
											{
												total = total + ifnull(item.Line_Total,0);
											}
											wp = Proposal_Work_Packages[ID == wpID];
											for each  w in wp
											{
												w.Package_Total=total;
												proposalID = w.Proposal;
											}
											if(proposalID != null)
											{
												packages = Proposal_Work_Packages[Proposal == proposalID];
												proposalTotal = 0.0;
												for each  pkg in packages
												{
													proposalTotal = proposalTotal + ifnull(pkg.Package_Total,0);
												}
												prop = Project_Proposals[ID == proposalID];
												for each  pr in prop
												{
													pr.Agreed_Price=proposalTotal;
												}
											}
										}
						)
					}
				}

			}
			Update_Proposal_Total_OnA as "Update_Proposal_Total_OnAdd"
			{
				type =  form
				form = Proposal_Work_Packages
				record event = on add

				on success
				{
					actions 
					{
						custom deluge script
						(
											proposalID = input.Proposal;
										if(proposalID != null)
										{
											packages = Proposal_Work_Packages[Proposal == proposalID];
											total = 0.0;
											for each  pkg in packages
											{
												total = total + ifnull(pkg.Package_Total,0);
											}
											prop = Project_Proposals[ID == proposalID];
											for each  p in prop
											{
												p.Agreed_Price=total;
											}
										}
						)
					}
				}

			}
			Update_Proposal_Total_OnE as "Update_Proposal_Total_OnEdit"
			{
				type =  form
				form = Proposal_Work_Packages
				record event = on edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											proposalID = input.Proposal;
										if(proposalID != null)
										{
											packages = Proposal_Work_Packages[Proposal == proposalID];
											total = 0.0;
											for each  pkg in packages
											{
												total = total + ifnull(pkg.Package_Total,0);
											}
											prop = Project_Proposals[ID == proposalID];
											for each  p in prop
											{
												p.Agreed_Price=total;
											}
										}
						)
					}
				}

			}
			Expand_Kit_Products as "Expand_Kit_Products"
			{
				type =  form
				form = Proposal_Work_Packages
				record event = on add or edit

				on user input of Source_Kit
				{
					actions 
					{
						custom deluge script
						(
											kitID = input.Source_Kit;
										if(kitID != null)
										{
											// Set Package Name
											kit = Product_Kits[ID == kitID];
											for each  k in kit
											{
												input.Package_Name = k.Kit_Name;
											}
											// Calculate Package Total from Kit Items
											kitProducts = Kit_Products[Kit == kitID];
											packageTotal = 0.0;
											for each  kp in kitProducts
											{
												productID = kp.Product;
												defQty = ifnull(kp.Default_Quantity,0);
												// Get Base_Rate from Product Master
												prodRate = 0.0;
												prod = Product_Master[ID == productID];
												for each  p in prod
												{
													prodRate = ifnull(p.Base_Rate,0);
												}
												lineTotal = defQty * prodRate;
												packageTotal = packageTotal + lineTotal;
											}
											input.Package_Total = packageTotal;
										}
						)
					}
				}

			}
			Create_Kit_Line_Items as "Create_Kit_Line_Items"
			{
				type =  form
				form = Proposal_Work_Packages
				record event = on add

				on success
				{
					actions 
					{
						custom deluge script
						(
											kitID = input.Source_Kit;
										debugLog = "Start: " + zoho.currenttime + "\n";
										debugLog = debugLog + "Source Kit ID: " + kitID + "\n";
										if(kitID != null)
										{
											kitProducts = Kit_Products[Kit == kitID];
											debugLog = debugLog + "Kit Products found: " + kitProducts.count() + "\n";
											for each  kp in kitProducts
											{
												productID = kp.Product;
												debugLog = debugLog + "Processing Product ID: " + productID + "\n";
												prodName = "";
												prodUnit = "";
												prodRate = 0.0;
												prod = Product_Master[ID == productID];
												for each  p in prod
												{
													prodName = p.Product_Name;
													prodUnit = p.Unit_Type;
													prodRate = ifnull(p.Base_Rate,0);
												}
												defQty = ifnull(kp.Default_Quantity,0);
												lineTotal = defQty * prodRate;
												sortOrd = ifnull(kp.Sort_Order,100);
												debugLog = debugLog + "Inserting: " + prodName + " Qty: " + defQty + "\n";
												insert into Proposal_Line_Items
												[
													Added_User=zoho.loginuser
													Work_Package=input.ID
													Product=productID
													Description=prodName
													Quantity=defQty
													Unit=prodUnit
													Rate=prodRate
													Line_Total=lineTotal
													Sort_Order=sortOrd
												]
												debugLog = debugLog + "Insert done\n";
											}
											lineItems = Proposal_Line_Items[Work_Package == input.ID];
											packageTotal = 0.0;
											for each  item in lineItems
											{
												packageTotal = packageTotal + ifnull(item.Line_Total,0);
											}
											input.Package_Total = packageTotal;
											debugLog = debugLog + "Package Total: " + packageTotal + "\n";
											proposalID = input.Proposal;
											if(proposalID != null)
											{
												packages = Proposal_Work_Packages[Proposal == proposalID];
												proposalTotal = 0.0;
												for each  pkg in packages
												{
													proposalTotal = proposalTotal + ifnull(pkg.Package_Total,0);
												}
												prop = Project_Proposals[ID == proposalID];
												for each  pr in prop
												{
													pr.Agreed_Price=proposalTotal;
												}
												debugLog = debugLog + "Proposal Total: " + proposalTotal + "\n";
											}
										}
										else
										{
											debugLog = debugLog + "No Source Kit selected\n";
										}
										// Save debug log to Parameters
										params = Parameters[ID != 0];
										params.Workflow_Debug=debugLog;
						)
					}
				}

			}
			Autofill_Pricing_Product_ as "Autofill_Pricing_Product_Details"
			{
				type =  form
				form = Proposal_Pricing
				record event = on add or edit

				on user input of Product
				{
					actions 
					{
						custom deluge script
						(
											if(input.Product != null)
										{
											prod = Product_Master[ID == input.Product];
											for each  p in prod
											{
												input.Description = p.Product_Name;
												input.Unit = p.Unit_Type;
												input.Rate = ifnull(p.Base_Rate,0);
											}
										}
						)
					}
				}

			}
			Recalc_Line_Total_OnQuant as "Recalc_Line_Total_OnQuantity"
			{
				type =  form
				form = Proposal_Line_Items
				record event = on add or edit

				on user input of Quantity
				{
					actions 
					{
						custom deluge script
						(
											qty = ifnull(input.Quantity,0);
										rate = ifnull(input.Rate,0);
										input.Line_Total = qty * rate;
						)
					}
				}

			}
			Recalc_Line_Total_OnRate as "Recalc_Line_Total_OnRate"
			{
				type =  form
				form = Proposal_Line_Items
				record event = on add or edit

				on user input of Rate
				{
					actions 
					{
						custom deluge script
						(
											qty = ifnull(input.Quantity,0);
										rate = ifnull(input.Rate,0);
										input.Line_Total = qty * rate;
						)
					}
				}

			}
			Process_Work_Packages as "Process_Work_Packages"
			{
				type =  form
				form = Project_Proposals
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											// First, link all subform line items to this Proposal
										for each  item in input.Proposal_Line_Items
										{
											if(item.Proposal == null)
											{
												item.Proposal=input.ID;
											}
										}
										// Calculate Proposal Agreed Price from ALL line items
										allLineItems = Proposal_Line_Items[Proposal == input.ID];
										proposalTotal = 0.0;
										for each  item in allLineItems
										{
											proposalTotal = proposalTotal + ifnull(item.Line_Total,0);
										}
										input.Agreed_Price = proposalTotal;
						)
					}
				}

			}
			HideFields2 as "HideFields"
			{
				type =  form
				form = Project_Proposals
				record event = on add or edit

				on load
				{
					actions 
					{
						custom deluge script
						(
											hide Proposal_Number;
										hide Procore_Project_ID;
										hide Work_Packages;
										hide Work_Packages.Sort_Order;
										hide Work_Packages.Package_Total;
										hide Proposal_Line_Items.Work_Package;
										hide Proposal_Line_Items.Proposal;
						)
					}
				}

			}
			Update_Kit_Total1 as "Update_Kit_Total"
			{
				type =  form
				form = Kit_Products
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											thisKit = input.Kit;
										if(thisKit != null)
										{
											// Get all products in this kit
											allKitProducts = Kit_Products[Kit == thisKit];
											kitTotal = 0.0;
											for each  kp in allKitProducts
											{
												defQty = ifnull(kp.Default_Quantity,0);
												// Get Base_Rate from Product Master
												productID = kp.Product;
												prodRate = 0.0;
												prod = Product_Master[ID == productID];
												for each  p in prod
												{
													prodRate = ifnull(p.Base_Rate,0);
												}
												lineTotal = defQty * prodRate;
												kitTotal = kitTotal + lineTotal;
											}
											// Update the Kit record
											kitRec = Product_Kits[ID == thisKit];
											for each  k in kitRec
											{
												k.Kit_Total=kitTotal;
											}
										}
						)
					}
				}

			}
			Generate_Google_Maps_Link as "Generate_Google_Maps_Link"
			{
				type =  form
				form = Project_Proposals
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											lat = input.Address.latitude;
										lng = input.Address.longitude;
										postalCode = input.Address.postal_Code;
										if(lat != null && lng != null && lat != "" && lng != "")
										{
											// Use coordinates for precise location
											mapsUrl = "https://www.google.com/maps?q=" + lat + "," + lng;
											input.Google_Maps_Link = mapsUrl;
										}
										else if(postalCode != null && postalCode != "")
										{
											// Fallback to postal code
											encodedPostal = postalCode.replaceAll(" ","+",true);
											mapsUrl = "https://www.google.com/maps/search/?api=1&query=" + encodedPostal;
											input.Google_Maps_Link = mapsUrl;
										}
										else
										{
											// Fallback to full address
											fullAddress = ifnull(input.Address.address_line_1,"") + " " + ifnull(input.Address.district_city,"") + " " + ifnull(input.Address.country,"");
											encodedAddress = fullAddress.replaceAll(" ","+",true);
											mapsUrl = "https://www.google.com/maps/search/?api=1&query=" + encodedAddress;
											input.Google_Maps_Link = mapsUrl;
										}
						)
					}
				}

			}
			Prevent_Duplicate_Stock_L as "Prevent_Duplicate_Stock_Level"
			{
				type =  form
				form = Stock_Levels
				record event = on add or edit

				on validate
				{
					actions 
					{
						custom deluge script
						(
											// Check for existing Stock_Levels record with same Product + Location
										existingRecords = Stock_Levels[Product == input.Product && Location == input.Location && ID != input.ID];
										if(existingRecords.count() > 0)
										{
											cancel submit;
										}
						)
					}
				}

			}
			Update_Product_Stock_Tota as "Update_Product_Stock_Totals"
			{
				type =  form
				form = Stock_Levels
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											// Get the Product ID from this Stock_Levels record
										productID = input.Product;
										// Calculate totals across all locations for this product
										allStockRecords = Stock_Levels[Product == productID];
										totalOnHand = 0;
										totalAvailable = 0;
										for each  rec in allStockRecords
										{
											totalOnHand = totalOnHand + ifnull(rec.Quantity_On_Hand,0);
											totalAvailable = totalAvailable + ifnull(rec.Quantity_Available,0);
										}
										// Update the Product_Master record
										productRec = Product_Master[ID == productID];
										for each  p in productRec
										{
											p.Total_Stock_On_Hand=totalOnHand;
											p.Total_Available=totalAvailable;
										}
						)
					}
				}

			}
			Update_Product_Stock_Tota1 as "Update_Product_Stock_Totals_On_Delete"
			{
				type =  form
				form = Stock_Levels
				record event = on delete

				on success
				{
					actions 
					{
						custom deluge script
						(
											// Get the Product ID from the deleted record
										productID = input.Product;
										// Recalculate totals
										allStockRecords = Stock_Levels[Product == productID];
										totalOnHand = 0;
										totalAvailable = 0;
										for each  rec in allStockRecords
										{
											totalOnHand = totalOnHand + ifnull(rec.Quantity_On_Hand,0);
											totalAvailable = totalAvailable + ifnull(rec.Quantity_Available,0);
										}
										// Update the Product_Master record
										productRec = Product_Master[ID == productID];
										for each  p in productRec
										{
											p.Total_Stock_On_Hand=totalOnHand;
											p.Total_Available=totalAvailable;
										}
						)
					}
				}

			}
			Generate_PO_Number as "Generate_PO_Number"
			{
				type =  form
				form = Purchase_Orders
				record event = on add

				on success
				{
					actions 
					{
						custom deluge script
						(
											// Get current date components
										today = zoho.currentdate;
										year = today.toString("yy");
										month = today.toString("MM");
										day = today.toString("dd");
										// Get start and end of today for counting existing POs
										todayStart = today.toString("dd-MMM-yyyy") + " 00:00:00";
										todayEnd = today.toString("dd-MMM-yyyy") + " 23:59:59";
										existingToday = Purchase_Orders[Added_Time >= todayStart && Added_Time <= todayEnd];
										sequence = existingToday.count();
										if(sequence < 10)
										{
											seqStr = "0" + sequence.toString();
										}
										else
										{
											seqStr = sequence.toString();
										}
										poNum = "PO" + year + month + day + seqStr;
										// Update the record
										input.PO_Number = poNum;
						)
					}
				}

			}
			Set_Raised_By as "Set_Raised_By"
			{
				type =  form
				form = Purchase_Orders
				record event = on add

				on success
				{
					actions 
					{
						custom deluge script
						(
											input.Raised_By = zoho.loginuser;
						)
					}
				}

			}
			Auto_Fill_PO_Line_Unit_Pr as "Auto_Fill_PO_Line_Unit_Price"
			{
				type =  form
				form = Purchase_Orders
				record event = on add or edit

				on user input of PO_Lines.Product
				{
					actions 
					{
						custom deluge script
						(
											if(row.Product != null)
										{
											productRec = Product_Master[ID == row.Product];
											for each  p in productRec
											{
												row.Unit_Price=ifnull(p.Base_Rate,0);
											}
										}
						)
					}
				}

			}
			Calculate_PO_Total as "Calculate_PO_Total"
			{
				type =  form
				form = Purchase_Orders
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											// Calculate Total_Value from all line items
										totalValue = 0;
										for each  line in input.PO_Lines
										{
											lineTotal = ifnull(line.Quantity_Ordered,0) * ifnull(line.Unit_Price,0);
											totalValue = totalValue + lineTotal;
										}
										input.Total_Value = totalValue;
						)
					}
				}

			}
			Set_Received_By as "Set_Received_By"
			{
				type =  form
				form = Goods_Receipt
				record event = on add

				on success
				{
					actions 
					{
						custom deluge script
						(
											input.Received_By = zoho.loginuser;
						)
					}
				}

			}
			Auto_Fill_Supplier_From_P as "Auto_Fill_Supplier_From_PO"
			{
				type =  form
				form = Goods_Receipt
				record event = on add or edit

				on user input of Purchase_Order
				{
					actions 
					{
						custom deluge script
						(
											if(input.Purchase_Order != null)
										{
											poRec = Purchase_Orders[ID == input.Purchase_Order];
											for each  po in poRec
											{
												input.Suppliers = po.Supplier;
												input.Receiving_Location = po.Delivery_Location;
											}
										}
						)
					}
				}

			}
			Auto_Fill_GRN_Line_From_P as "Auto_Fill_GRN_Line_From_PO"
			{
				type =  form
				form = Goods_Receipt
				record event = on add or edit

				on user input of GRN_Lines.PO_Line
				{
					actions 
					{
						custom deluge script
						(
											if(row.PO_Line != null)
										{
											poLineRec = PO_Line_Items[ID == row.PO_Line];
											for each  line in poLineRec
											{
												row.Product=line.Product;
												row.Quantity_Expected=ifnull(line.Quantity_Outstanding,0);
												row.Quantity_Received=ifnull(line.Quantity_Outstanding,0);
											}
										}
						)
					}
				}

			}
			GRN_Confirm_Update_Stock as "GRN_Confirm_Update_Stock"
			{
				type =  form
				form = Goods_Receipt
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											// Debug logging to Parameters
										paramRec = Parameters[ID != null];
										for each  p in paramRec
										{
											p.Workflow_Debug="Fired at " + now + " | Status=" + input.GRN_Status + " | Stock_Updated=" + input.Stock_Updated;
										}
										if(input.GRN_Status == "Confirmed" && input.Stock_Updated != true)
										{
											// Update debug
											for each  p in paramRec
											{
												p.Workflow_Debug=p.Workflow_Debug + " | INSIDE CONDITION";
											}
											locationID = input.Receiving_Location;
											for each  line in input.GRN_Lines
											{
												qtyReceived = ifnull(line.Quantity_Received,0);
												productID = line.Product;
												stockRec = Stock_Levels[Product == productID && Location == locationID];
												if(stockRec.count() == 0)
												{
													newStock = insert into Stock_Levels
													[
														Product=productID
														Location=locationID
														Quantity_On_Hand=qtyReceived
														Quantity_Reserved=0
														Quantity_On_Order=0
														Added_User=zoho.loginuser
													];
													newBalance = qtyReceived;
												}
												else
												{
													for each  s in stockRec
													{
														s.Quantity_On_Hand=s.Quantity_On_Hand + qtyReceived;
														newBalance = s.Quantity_On_Hand;
													}
												}
												newTxn = insert into Stock_Transactions
												[
													Transaction_Type="GRN_Receipt"
													Product=productID
													Location=locationID
													Quantity=qtyReceived
													Balance_After=newBalance
													Reference_Type="GRN"
													Reference_ID=input.ID
													Added_User=zoho.loginuser
												];
												if(line.PO_Line != null)
												{
													poLineRec = PO_Line_Items[ID == line.PO_Line];
													for each  poLine in poLineRec
													{
														poLine.Quantity_Received=poLine.Quantity_Received + qtyReceived;
														if(poLine.Quantity_Received >= poLine.Quantity_Ordered)
														{
															poLine.Line_Status="Complete";
														}
														else if(poLine.Quantity_Received > 0)
														{
															poLine.Line_Status="Partial";
														}
													}
												}
											}
											if(input.Purchase_Order != null)
											{
												poID = input.Purchase_Order;
												allPOLines = PO_Line_Items[Purchase_Order == poID];
												allComplete = true;
												anyReceived = false;
												for each  poLine in allPOLines
												{
													if(poLine.Line_Status != "Complete" && poLine.Line_Status != "Cancelled")
													{
														allComplete = false;
													}
													if(poLine.Quantity_Received > 0)
													{
														anyReceived = true;
													}
												}
												poRec = Purchase_Orders[ID == poID];
												for each  po in poRec
												{
													if(allComplete)
													{
														po.PO_Status="Fully Received";
													}
													else if(anyReceived)
													{
														po.PO_Status="Partially Received";
													}
												}
											}
											input.Stock_Updated = true;
										}
						)
					}
				}

			}
			Link_PO_Line_Items as "Link_PO_Line_Items"
			{
				type =  form
				form = Purchase_Orders
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											for each  line in input.PO_Lines
										{
											line.Purchase_Order=input.ID;
										}
						)
					}
				}

			}
			Link_GRN_Line_Items as "Link_GRN_Line_Items"
			{
				type =  form
				form = Goods_Receipt
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											for each  line in input.GRN_Lines
										{
											line.Goods_Receipt=input.ID;
										}
						)
					}
				}

			}
			Issue_Stock_On_Collection as "Issue_Stock_On_Collection"
			{
				type =  form
				form = Stock_Ordering
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											if(input.Order_Status == "Collected" && input.Stock_Issued != true)
										{
											locationID = input.Source_Location;
											for each  line in input.Order
											{
												qtyOrdered = ifnull(line.Quantity,0);
												qtyIssued = ifnull(line.Quantity_Issued,0);
												if(qtyIssued == 0)
												{
													qtyIssued = qtyOrdered;
												}
												productID = line.Product;
												if(qtyIssued > 0)
												{
													stockRec = Stock_Levels[Product == productID && Location == locationID];
													for each  s in stockRec
													{
														s.Quantity_On_Hand=s.Quantity_On_Hand - qtyIssued;
														s.Quantity_Reserved=s.Quantity_Reserved - qtyOrdered;
														s.Last_Movement_Date=now;
														newBalance = s.Quantity_On_Hand;
													}
													newTxn = insert into Stock_Transactions
													[
														Transaction_Type="Order_Issue"
														Product=productID
														Location=locationID
														Quantity=0 - qtyIssued
														Balance_After=newBalance
														Reference_Type="Stock_Order"
														Reference_ID=input.ID
														Added_User=zoho.loginuser
													];
													line.Quantity_Issued=qtyIssued;
												}
											}
											input.Stock_Issued = true;
										}
						)
					}
				}

			}
			Release_Stock_On_Cancel as "Release_Stock_On_Cancel"
			{
				type =  form
				form = Stock_Ordering
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											if(input.Order_Status == "Cancelled" && input.Stock_Reserved == true && input.Stock_Issued != true)
										{
											locationID = input.Source_Location;
											for each  line in input.Order
											{
												qtyOrdered = ifnull(line.Quantity,0);
												productID = line.Product;
												if(qtyOrdered > 0)
												{
													stockRec = Stock_Levels[Product == productID && Location == locationID];
													for each  s in stockRec
													{
														s.Quantity_Reserved=s.Quantity_Reserved - qtyOrdered;
													}
												}
											}
											input.Stock_Reserved = false;
										}
						)
					}
				}

			}
			Show_Available_Stock as "Show_Available_Stock"
			{
				type =  form
				form = Stock_Ordering
				record event = on add or edit

				on user input of Order.Product
				{
					actions 
					{
						custom deluge script
						(
											if(row.Product != null && input.Source_Location != null)
										{
											productID = row.Product;
											locationID = input.Source_Location;
											stockRec = Stock_Levels[Product == productID && Location == locationID];
											if(stockRec.count() > 0)
											{
												for each  s in stockRec
												{
													row.Quantity_Available=ifnull(s.Quantity_Available,0);
												}
											}
											else
											{
												row.Quantity_Available=0;
											}
										}
						)
					}
				}

			}
			Check_For_Non_Site_Produc as "Check_For_Non_Site_Products"
			{
				type =  form
				form = Stock_Ordering
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											// Automatically process new orders (status is Draft by default)
										if(input.Order_Status == "Draft" || input.Order_Status == "Submitted")
										{
											siteID = input.Sites_Reference;
											hasNonSiteProduct = false;
											for each  line in input.Order
											{
												productID = line.Product;
												lineQty = ifnull(line.Quantity,0);
												// Only check lines with quantity > 0
												if(lineQty > 0)
												{
													// Check if this product exists in Site_Product_Catalog for this site
													catalogMatch = Site_Product_Catalog[Site == siteID && Product == productID && Active == "Active"];
													if(catalogMatch.count() > 0)
													{
														line.Is_Site_Product=true;
													}
													else
													{
														line.Is_Site_Product=false;
														hasNonSiteProduct = true;
													}
												}
											}
											// Determine if approval is needed
											if(hasNonSiteProduct == true)
											{
												input.Needs_Approval = true;
												input.Order_Status = "Pending Approval";
											}
											else
											{
												input.Needs_Approval = false;
												input.Order_Status = "Awaiting Pick";
												input.Picking_Stage = "Awaiting Pick";
												locationID = input.Source_Location;
												for each  line in input.Order
												{
													qtyOrdered = ifnull(line.Quantity,0);
													productID = line.Product;
													if(qtyOrdered > 0)
													{
														stockRec = Stock_Levels[Product == productID && Location == locationID];
														for each  s in stockRec
														{
															s.Quantity_Reserved=s.Quantity_Reserved + qtyOrdered;
														}
													}
												}
												input.Stock_Reserved = true;
											}
										}
						)
					}
				}

			}
			Hide_Approval_Fields as "Hide_Approval_Fields"
			{
				type =  form
				form = Stock_Ordering
				record event = on add or edit

				on load
				{
					actions 
					{
						custom deluge script
						(
											userRole = thisapp.permissions.roleForUser(zoho.loginuserid);
										// Debug - log to Parameters
										paramRec = Parameters[ID != null];
										for each  p in paramRec
										{
											p.Workflow_Debug="User Role: " + userRole;
										}
										if(userRole != "Admin" && userRole != "Approver" && userRole != "Administrator" && userRole != "CEO")
										{
											hide Order_Status;
											hide Needs_Approval;
											hide Approval_Notes;
											hide Stock_Reserved;
											hide Stock_Issued;
										}
						)
					}
				}

			}
			Reserve_Stock_On_Manual_A as "Reserve_Stock_On_Manual_Approval"
			{
				type =  form
				form = Stock_Ordering
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											if(input.Order_Status == "Approved" && input.Stock_Reserved != true)
										{
											locationID = input.Source_Location;
											for each  line in input.Order
											{
												qtyOrdered = ifnull(line.Quantity,0);
												productID = line.Product;
												if(qtyOrdered > 0)
												{
													stockRec = Stock_Levels[Product == productID && Location == locationID];
													for each  s in stockRec
													{
														s.Quantity_Reserved=s.Quantity_Reserved + qtyOrdered;
													}
												}
											}
											input.Stock_Reserved = true;
										}
						)
					}
				}

			}
			Validate_Stock_Before_App as "Validate_Stock_Before_Approval"
			{
				type =  form
				form = Stock_Ordering
				record event = on add or edit

				on validate
				{
					actions 
					{
						custom deluge script
						(
											if(input.Order_Status == "Approved")
										{
											locationID = input.Source_Location;
											insufficientStock = "";
											for each  line in input.Order
											{
												qtyOrdered = ifnull(line.Quantity,0);
												productID = line.Product;
												if(qtyOrdered > 0)
												{
													stockRec = Stock_Levels[Product == productID && Location == locationID];
													if(stockRec.count() == 0)
													{
														productRec = Product_Master[ID == productID];
														for each  p in productRec
														{
															insufficientStock = insufficientStock + p.Product_Name + " (no stock record), ";
														}
													}
													else
													{
														for each  s in stockRec
														{
															availableQty = ifnull(s.Quantity_Available,0);
															if(availableQty < qtyOrdered)
															{
																productRec = Product_Master[ID == productID];
																for each  p in productRec
																{
																	insufficientStock = insufficientStock + p.Product_Name + " (available: " + availableQty + ", ordered: " + qtyOrdered + "), ";
																}
															}
														}
													}
												}
											}
											if(insufficientStock != "")
											{
												alert "Cannot approve - insufficient stock for: " + insufficientStock;
												cancel submit;
											}
										}
						)
					}
				}

			}
			Sync_Stage_Fields as "Sync_Stage_Fields"
			{
				type =  form
				form = Stock_Ordering
				record event = on add or edit
					status = inactive

				on success
				{
					actions 
					{
						custom deluge script
						(
											// Sync Picking_Stage field
										if(input.Order_Status == "Pending Approval" || input.Order_Status == "Awaiting Pick" || input.Order_Status == "Awaiting Collection")
										{
											input.Picking_Stage = input.Order_Status;
										}
										// Sync Collection_Stage field
										if(input.Order_Status == "Awaiting Collection" || input.Order_Status == "Collected")
										{
											input.Collection_Stage = input.Order_Status;
										}
						)
					}
				}

			}
			Sync_Order_Status_From_Pi as "Sync_Order_Status_From_Picking"
			{
				type =  form
				form = Stock_Ordering
				record event = on edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											if(input.Picking_Stage != null && input.Picking_Stage != "")
										{
											// Don't overwrite if Collection_Stage is already Collected
											if(input.Collection_Stage != "Collected")
											{
												input.Order_Status = input.Picking_Stage;
												if(input.Picking_Stage == "Awaiting Collection")
												{
													input.Collection_Stage = "Awaiting Collection";
												}
												else
												{
													input.Collection_Stage = "";
												}
											}
										}
						)
					}
				}

			}
			Sync_Order_Status_From_Co as "Sync_Order_Status_From_Collection"
			{
				type =  form
				form = Stock_Ordering
				record event = on edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											if(input.Collection_Stage != null && input.Collection_Stage != "")
										{
											input.Order_Status = input.Collection_Stage;
											if(input.Collection_Stage == "Collected")
											{
												input.Collected_DateTime = zoho.currenttime;
												input.Collected_By = zoho.loginuserid;
												input.Picking_Stage = "";
											}
											else if(input.Collection_Stage == "Awaiting Collection")
											{
												input.Picking_Stage = "Awaiting Collection";
												input.Collected_DateTime = null;
												input.Collected_By = "";
											}
										}
						)
					}
				}

			}
			Require_Bay_For_Collectio as "Require_Bay_For_Collection"
			{
				type =  form
				form = Stock_Ordering
				record event = on add or edit

				on validate
				{
					actions 
					{
						custom deluge script
						(
											if(input.Order_Status == "Awaiting Collection" || input.Picking_Stage == "Awaiting Collection" || input.Collection_Stage == "Awaiting Collection")
										{
											if(input.Collection_Bay == null)
											{
												alert "Please select a Collection Bay before moving to Awaiting Collection";
												cancel submit;
											}
										}
						)
					}
				}

			}
			Notify_Ready_For_Collecti as "Notify_Ready_For_Collection"
			{
				type =  form
				form = Stock_Ordering
				record event = on edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											// to :employeeEmail
										if(input.Order_Status == "Awaiting Collection")
										{
											orderNumber = input.Order_Number_Auto;
											bayName = ifnull(input.Collection_Bay.Bay_Name,"TBC");
											siteName = input.Sites_Reference.Site_Name;
											employeeID = input.Ordered_by_Employee;
											if(employeeID != null)
											{
												// Fetch employee from the other application
												response = zoho.creator.getRecords("quantumbuild1","rascor-site-attendance","Employees_Reference_Report","ID == " + employeeID,1,1,"creator_connection");
												// info "API Response: " + response;
												if(response.get("code") == 3000 && response.get("data").size() > 0)
												{
													empData = response.get("data").get(0);
													employeeEmail = empData.get("System_Email_Address");
													employeeName = empData.get("Employee_Display_Name");
													if(employeeEmail != null && employeeEmail != "")
													{
														sendmail
														[
															from :zoho.adminuserid
															to :"eddie_heff@yahoo.com"
															cc:"donal@quantumbuild.ai"
															subject :"Order " + orderNumber + " Ready for Collection"
															message :"<div style='font-family: Arial, sans-serif;'>" + "<p>Hi " + employeeName + ",</p>" + "<p>Your order <strong>" + orderNumber + "</strong> for site <strong>" + siteName + "</strong> is ready for collection.</p>" + "<p><strong>Collection Bay:</strong> " + bayName + "</p>" + "<p>Please collect at your earliest convenience.</p>" + "<p>Regards,<br>RASCOR Stock Management</p>" + "</div>"
														]
													}
												}
											}
										}
						)
					}
				}

			}
			Notify_Order_Collected as "Notify_Order_Collected"
			{
				type =  form
				form = Stock_Ordering
				record event = on edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											// to : employeeEmail
										if(input.Order_Status == "Collected")
										{
											orderNumber = input.Order_Number_Auto;
											siteName = input.Sites_Reference.Site_Name;
											collectedTime = input.Collected_DateTime.toString("dd-MMM-yyyy HH:mm");
											employeeID = input.Ordered_by_Employee;
											if(employeeID != null)
											{
												response = zoho.creator.getRecords("quantumbuild1","rascor-site-attendance","Employees_Reference_Report","ID == " + employeeID,1,1,"creator_connection");
												if(response.get("code") == 3000 && response.get("data").size() > 0)
												{
													empData = response.get("data").get(0);
													employeeEmail = empData.get("System_Email_Address");
													employeeName = empData.get("Employee_Display_Name");
													if(employeeEmail != null && employeeEmail != "")
													{
														sendmail
														[
															from :zoho.adminuserid
															to :"eddie_heff@yahoo.com"
															cc:"donal@quantumbuild.ai"
															subject :"Order " + orderNumber + " Collected"
															message :"<div style='font-family: Arial, sans-serif;'>" + "<p>Hi " + employeeName + ",</p>" + "<p>Your order <strong>" + orderNumber + "</strong> for site <strong>" + siteName + "</strong> has been collected.</p>" + "<p><strong>Collected:</strong> " + collectedTime + "</p>" + "<p>Regards,<br>RASCOR Stock Management</p>" + "</div>"
														]
													}
												}
											}
										}
						)
					}
				}

			}
			Page_Setup as "Page_Setup"
			{
				type =  form
				form = Purchase_Orders
				record event = on add or edit

				on load
				{
					actions 
					{
						custom deluge script
						(
											clear PO_Lines;
										// HIDE FIELDS
										hide PO_Number;
										hide Order_Date;
										hide PO_Status;
										hide Total_Value;
										hide PO_Lines.Purchase_Order;
										hide PO_Lines.Quantity_Received;
										// hide PO_Lines.Quantity_Outstanding;
										// hide PO_Lines.Line_Total;
										hide PO_Lines.Line_Status;
										// Set default Delivery Location
										if(input.Delivery_Location == null)
										{
											defaultLocation = Stock_Locations[Location_Name == "Main Warehouse"];
											for each  loc in defaultLocation
											{
												input.Delivery_Location = loc.ID;
											}
										}
						)
					}
				}

			}
			Populate_Products_From_Su as "Populate_Products_From_Supplier"
			{
				type =  form
				form = Purchase_Orders
				record event = on add or edit

				on user input of Supplier
				{
					actions 
					{
						custom deluge script
						(
											if(input.Supplier != null)
										{
											// Clear existing lines first
											clear PO_Lines;
											// Get all products for this supplier
											supplierProducts = Product_Master[Supplier == input.Supplier];
											// Create collection to hold rows
											rowsCollection = Collection();
											for each  product in supplierProducts
											{
												row = Purchase_Orders.PO_Lines();
												row.Product=product.ID;
												row.Unit_Price=ifnull(product.Base_Rate,0);
												row.Quantity_Ordered=0;
												rowsCollection.insert(row);
											}
											// Insert all rows into the subform
											input.PO_Lines.insert(rowsCollection);
										}
						)
					}
				}

			}
			Page_Setup1 as "Page_Setup"
			{
				type =  form
				form = Product_Kits
				record event = on add or edit

				on load
				{
					actions 
					{
						custom deluge script
						(
											// HIDE FIELDS
										hide Kit_Total;
										hide Kit_Items.Kit;
										hide Kit_Items.Sort_Order;
						)
					}
				}

			}
			Page_Setup2 as "Page_Setup"
			{
				type =  form
				form = Kit_Products
				record event = on add or edit

				on load
				{
				}

			}
			Link_Kit_Line_Items as "Link_Kit_Line_Items"
			{
				type =  form
				form = Product_Kits
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											for each  line in input.Kit_Items
										{
											line.Kit=input.ID;
										}
						)
					}
				}

			}
			Update_Stock_Value as "Update_Stock_Value"
			{
				type =  form
				form = Stock_Levels
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											input.Stock_Value_Stored = ifnull(input.Quantity_On_Hand,0) * ifnull(input.Product.Base_Rate,0);
						)
					}
				}

			}
			Update_Order_Total as "Update_Order_Total"
			{
				type =  form
				form = Order_Line_Items
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											// Calculate and store this line's total
										qty = ifnull(input.Quantity,0);
										baseRate = ifnull(input.Product.Base_Rate,0);
										lineTotal = qty * baseRate;
										input.Line_Total_Stored = lineTotal;
										// Sum all line items for this order
										allLines = Order_Line_Items[Order == input.Order];
										orderTotal = 0.00;
										for each  orderLine in allLines
										{
											orderTotal = orderTotal + ifnull(orderLine.Line_Total_Stored,0);
										}
										// Update the parent order
										input.Order.Order_Total_Stored = orderTotal;
						)
					}
				}

			}
			Store_Site_Name as "Store_Site_Name"
			{
				type =  form
				form = Stock_Ordering
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											if(input.Sites_Reference != null)
										{
											try 
											{
												siteRecord = zoho.creator.getRecordById("quantumbuild1","rascor-site-attendance","Sites_Reference_Report",input.Sites_Reference.toLong(),"creator_connection");
												if(siteRecord != null)
												{
													dataObj = siteRecord.get("data");
													if(dataObj != null)
													{
														siteName = dataObj.get("Site_Name");
														if(siteName != null)
														{
															input.Site_Name_Stored = siteName.toString();
														}
													}
												}
											}
											catch (e)
											{
												// Keep empty if lookup fails
											}
										}
						)
					}
				}

			}
			Create_ProcoreProjectOnWo as "Create_ProcoreProjectOnWon"
			{
				type =  form
				form = Project_Proposals
				record event = on edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											// Only trigger when status changes to "Won" and not already synced
										if(Proposal_Status == "Won")
										{
											// Check if not already synced to Procore
											existingId = ifnull(input.Procore_Project_ID,"");
											if(existingId == "")
											{
												// Call the function to create Procore project
												thisapp.fn_CreateProcoreProject(input.ID);
											}
										}
						)
					}
				}

			}
			Set_Default_Line_Item_Val as "Set_Default_Line_Item_Values"
			{
				type =  form
				form = Proposal_Line_Items
				record event = on add or edit

				on user input of Product
				{
					actions 
					{
						custom deluge script
						(
											if(Product != null)
										{
											// Default Description from Product
											if(Description == null || Description == "")
											{
												input.Description = input.Product.Product_Name;
											}
											// Default Unit from Product
											if(Unit == null || Unit == "")
											{
												input.Unit = input.Product.Unit_Type;
											}
											// Default Rate from Sell_Price (fallback to Base_Rate)
											if(Rate == null || Rate == 0)
											{
												sellPrice = ifnull(input.Product.Sell_Price,0);
												baseRate = ifnull(input.Product.Base_Rate,0);
												if(sellPrice > 0)
												{
													input.Rate = sellPrice;
												}
												else if(baseRate > 0)
												{
													input.Rate = baseRate;
												}
											}
										}
						)
					}
				}

			}
			Populate_From_Source_Kit as "Populate_From_Source_Kit"
			{
				type =  form
				form = Project_Proposals
				record event = on add or edit

				on user input of Source_Kits
				{
					actions 
					{
						custom deluge script
						(
											kitId = input.Source_Kits;
										if(kitId != null)
										{
											kitItems = Kit_Products[Kit == kitId];
											for each  kp in kitItems
											{
												productId = kp.Product;
												prod = Product_Master[ID == productId];
												prodName = "";
												prodUnit = "";
												prodRate = 0.0;
												for each  p in prod
												{
													prodName = p.Product_Name;
													prodUnit = p.Unit_Type;
													sellPrice = ifnull(p.Sell_Price,0);
													baseRate = ifnull(p.Base_Rate,0);
													if(sellPrice > 0)
													{
														prodRate = sellPrice;
													}
													else
													{
														prodRate = baseRate;
													}
												}
												defQty = ifnull(kp.Default_Quantity,0);
												lineTotal = defQty * prodRate;
												sortOrd = ifnull(kp.Sort_Order,100);
												newRow = Project_Proposals.Proposal_Line_Items();
												newRow.Product=productId;
												newRow.Description=prodName;
												newRow.Unit=prodUnit;
												newRow.Rate=prodRate;
												newRow.Quantity=defQty;
												newRow.Line_Total=lineTotal;
												newRow.Sort_Order=sortOrd;
												input.Proposal_Line_Items.insert(newRow);
											}
											// Clear the Source_Kit field after adding items
											Source_Kit = null;
										}
						)
					}
				}

			}
			Clear_All_Line_Items as "Clear_All_Line_Items"
			{
				type =  form
				form = Project_Proposals
				record event = on add or edit

				on user input of Clear_All_Items
				{
					actions 
					{
						custom deluge script
						(
											if(Clear_All_Items == true)
										{
											input.Proposal_Line_Items.clear();
											input.Clear_All_Items = false;
										}
						)
					}
				}

			}
			HideFields3 as "HideFields"
			{
				type =  form
				form = Stock_Takes
				record event = on add or edit

				on load
				{
					actions 
					{
						custom deluge script
						(
											hide Stock_Take_Number;
										hide Created_By;
										hide Previous_Status;
										hide Stock_Take_Lines.Stock_Take;
						)
					}
				}

			}
			Set_Created_By as "Set_Created_By"
			{
				type =  form
				form = Stock_Takes
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											input.Created_By = zoho.loginuser;
						)
					}
				}

			}
			Generate_Stock_Take_Numbe as "Generate_Stock_Take_Number"
			{
				type =  form
				form = Stock_Takes
				record event = on add

				on success
				{
					actions 
					{
						custom deluge script
						(
											// Generate Stock Take Number: ST-YYMMDD-XXX
										dateCode = zoho.currentdate.toString("yyMMdd");
										todayStart = zoho.currentdate.toString("dd-MMM-yyyy") + " 00:00:00";
										todayCount = Stock_Takes[Added_Time >= todayStart].count();
										seqNum = (todayCount + 1).leftpad(3).replaceAll(" ","0");
										input.Stock_Take_Number = "ST-" + dateCode + "-" + seqNum;
										input.Previous_Status = "Draft";
						)
					}
				}

			}
			Populate_Stock_Take_Lines as "Populate_Stock_Take_Lines"
			{
				type =  form
				form = Stock_Takes
				record event = on add or edit

				on user input of Location
				{
					actions 
					{
						custom deluge script
						(
											// Only populate if Status is Draft and Location is selected
										if(input.Status == "Draft" && input.Location != null)
										{
											// Clear existing lines first
											input.Stock_Take_Lines.clear();
											// Get all stock levels for this location
											stockLevels = Stock_Levels[Location == input.Location];
											for each  sl in stockLevels
											{
												row = Stock_Takes.Stock_Take_Lines();
												row.Product=sl.Product;
												row.Expected_Quantity=sl.Quantity_On_Hand;
												row.Counted_Quantity=0;
												row.Bay_Location=sl.Bay_Location;
												row.Stock_Take=input.ID;
												input.Stock_Take_Lines.insert(row);
											}
										}
						)
					}
				}

			}
			Track_Status_Change as "Track_Status_Change"
			{
				type =  form
				form = Stock_Takes
				record event = on edit

				on load
				{
					actions 
					{
						custom deluge script
						(
											input.Previous_Status = input.Status;
						)
					}
				}

			}
			Apply_Stock_Adjustments as "Apply_Stock_Adjustments"
			{
				type =  form
				form = Stock_Takes
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											// Only run when status changes TO Approved
										if(input.Status == "Approved" && input.Previous_Status != "Approved")
										{
											// Set approval details
											input.Approved_By = zoho.loginuser;
											input.Approved_Date = zoho.currenttime;
											// Update Stock_Levels for each line item
											for each  line in input.Stock_Take_Lines
											{
												// Find the Stock_Level record
												stockRec = Stock_Levels[Product == line.Product && Location == input.Location];
												if(stockRec.count() > 0)
												{
													for each  sl in stockRec
													{
														sl.Quantity_On_Hand=line.Counted_Quantity;
													}
												}
											}
										}
						)
					}
				}

			}
			Update_Line_Count as "Update_Line_Count"
			{
				type =  form
				form = Update_Stock_Count
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											// Find and update the stock take line
										lineID = input.Line_ID.toLong();
										lineRecords = Stock_Take_Lines[ID == lineID];
										for each  line in lineRecords
										{
											line.Counted_Quantity=input.Counted;
											break;
										}
										// Redirect back with success message
										openUrl("#Page:Quick_Count","same window");
						)
					}
				}

			}
			Set_Line_And_Redirect as "Set_Line_And_Redirect"
			{
				type =  form
				form = Quick_Count_Redirect
				record event = on add or edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											// Update Parameters with the line ID
										paramRecords = Parameters[ID != 0];
										for each  p in paramRecords
										{
											p.Current_Stock_Take_Line_ID=input.Line_ID;
											break;
										}
										// Redirect to Quick Count page
										openUrl("#Page:Quick_Count","same window");
						)
					}
				}

			}
			Sync_Picking_Stage_From_O as "Sync_Picking_Stage_From_Order_Status"
			{
				type =  form
				form = Stock_Ordering
				record event = on edit

				on success
				{
					actions 
					{
						custom deluge script
						(
											// When Order_Status changes to a warehouse stage, update Picking_Stage
										warehouseStatuses = {"Pending Approval","Awaiting Pick","Awaiting Collection"};
										if(warehouseStatuses.contains(input.Order_Status))
										{
											input.Picking_Stage = input.Order_Status;
										}
										else if(input.Order_Status == "Collected" || input.Order_Status == "Rejected" || input.Order_Status == "Cancelled" || input.Order_Status == "Draft")
										{
											input.Picking_Stage = "";
										}
						)
					}
				}

			}
			Hide_Fields_On_Create as "Hide_Fields_On_Create"
			{
				type =  form
				form = Goods_Receipt
				record event = on add

				on load
				{
					actions 
					{
						custom deluge script
						(
											hide GRN_Lines.Goods_Receipt;
						)
					}
				}

			}
		}

		schedule
		{
			Daily_Refresh_Product_Tre as "Daily_Refresh_Product_Trends"
			{
				type =  schedule
				start = "2025-12-15 09:30:00"
				frequency = daily
				time zone = "Europe/Dublin"
				on start
				{
					actions 
					{
					on load
					(
						// Generate the report HTML
										htmlContent = thisapp.fn_GenerateProductTrendsReport();
										// Store in Parameters form
										paramRec = Parameters[ID != null];
										for each  rec in paramRec
										{
											rec.Product_Trends_Report=htmlContent;
										}
					)
					}
				}
			}
		}




		functions
		{
			Open_Proposal_Preview as "Open_Proposal_Preview"
			{
				type =  functions
				form = Project_Proposals
				execution type = for each record	
				on start
				{
					actions 
					{
					on click
					(
						// Update Parameters with selected proposal ID
										params = Parameters[ID != 0];
										params.Current_Proposal_ID=input.ID;
										// Open the View Proposal page
										openUrl("#Page:View_Proposal","same window");
					)
					}
				}
			}
			Print_Count_Sheet as "Print_Count_Sheet"
			{
				type =  functions
				form = Stock_Takes
				execution type = for each record	
				on start
				{
					actions 
					{
					on click
					(
						params = Parameters[ID != 0];
										params.Current_Stock_Take_ID=input.ID;
										openUrl("#Page:Print_Count","same window");
					)
					}
				}
			}
		}
	}
	share_settings
	{
			"Read"
			{
				name = "Read"
				type = Users_Permissions
				permissions = {Chat:true, Predefined:true, ApiAccess:true, PIIAccess:true, ePHIAccess:true}
				description = "This profile will have read permission for all components\n"
			}
			"Write"
			{
				name = "Write"
				type = Users_Permissions
				permissions = {Chat:true, Predefined:true, ApiAccess:true, PIIAccess:true, ePHIAccess:true}
				description = "This profile will have write permission for all components\n"
			}
			"Developer"
			{
				name = "Developer"
				type = Developer
				permissions = {Chat:false, Predefined:true, ApiAccess:true, PIIAccess:true, ePHIAccess:true}
				description = "Developer Profile\n"
			}
			"Administrator"
			{
				name = "Administrator"
				type = Users_Permissions
				permissions = {Chat:true, Predefined:true, ApiAccess:true, PIIAccess:true, ePHIAccess:true}
				description = "This profile will have all the permissions.\n"
			}
			"Customer"
			{
				name = "Customer"
				type = Customer_Portal
				permissions = {Chat:true, Predefined:true, ApiAccess:true, PIIAccess:true, ePHIAccess:true}
				description = "This is the default profile having only add and view permission.\n"
			}
			roles
			{
				"CEO"
				{
					description = "User belonging to this role can access data of all other users."
					"Admin"
					{
						description = ""
					}
					"Warehouse Manager"
					{
						description = ""
						share data with peers = true
					}
					"Approver"
					{
						description = ""
						share data with peers = true
					}
				}
			}
			role Hierarchy = {Product_Categories,Product_Master,Suppliers,Stock_Ordering}
	}

	customize
	{
		icon
		{
			icon = "zc-ab-sales-and-supp20"
			background color = "#ffffff"
			foreground color = "#1f2024"
		}
	}

	connections
	{
		creator_connection
		(
			displayname = "creator_connection"
			user access = true
			auth per env = true
			connector = zoho_oauth
			permissions = {"ZohoCreator.form.CREATE","ZohoCreator.report.CREATE","ZohoCreator.report.READ","ZohoCreator.report.UPDATE"}
		)
	}
	web
	{
		forms
		{
			form Assign_Bay_Form
			{
				label placement = left
			}
			form Assign_Bay_Form1
			{
				label placement = left
			}
			form Bay_Locations
			{
				label placement = left
			}
			form Companies
			{
				label placement = left
			}
			form Company_Contacts
			{
				label placement = left
			}
			form Goods_Receipt
			{
				label placement = left
			}
			form GRN_Line_Items
			{
				label placement = left
			}
			form Kit_Products
			{
				label placement = left
			}
			form Order_Line_Items
			{
				label placement = left
			}
			form Parameters
			{
				label placement = left
			}
			form PO_Line_Items
			{
				label placement = left
			}
			form Procore_Settings
			{
				label placement = left
			}
			form Product_Categories
			{
				label placement = left
			}
			form Product_Kits
			{
				label placement = left
			}
			form Product_Master
			{
				label placement = left
			}
			form Suppliers
			{
				label placement = left
			}
			form Project_Proposals
			{
				label placement = left
			}
			form Proposal_Contacts
			{
				label placement = left
			}
			form Proposal_Line_Items
			{
				label placement = left
			}
			form Proposal_Pricing
			{
				label placement = left
			}
			form Proposal_Work_Packages
			{
				label placement = left
			}
			form Purchase_Orders
			{
				label placement = left
			}
			form Quick_Count_Redirect
			{
				label placement = left
			}
			form Site_Product_Catalog
			{
				label placement = left
			}
			form Stock_Levels
			{
				label placement = left
			}
			form Stock_Locations
			{
				label placement = left
			}
			form Stock_Ordering
			{
				label placement = left
			}
			form Stock_Takes
			{
				label placement = left
			}
			form Stock_Take_Lines
			{
				label placement = left
			}
			form Stock_Transactions
			{
				label placement = left
			}
			form Stock_Adjustments
			{
				label placement = left
			}
			form Update_Stock_Count
			{
				label placement = left
			}
		}
		reports
		{
			report All_Suppliers
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Supplier_Number as "Supplier Number"
								Supplier_Name as "Supplier Name"
								Contact_Person as "Contact Person"
								Email
								Phone_Number as "Phone"
								Address
								Payment_Terms as "Payment Terms"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Supplier_Number as "Supplier Number"
								Supplier_Name as "Supplier Name"
								Contact_Person as "Contact Person"
								Email
								Phone_Number as "Phone"
								Address
								Payment_Terms as "Payment Terms"
								Is_Active as "Is Active"
								Supplier_Code as "Supplier Code"
								Lead_Time_Days as "Lead Time Days"
								Account_Number as "Account Number"
								Supplier_Type as "Supplier Type"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Product_Categories
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Category_Number as "Category Number"
								Category_Name as "Category Name"
								Parent_Category as "Parent Category"
								Is_Active as "Is Active"
								Sort_Order as "Sort Order"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Category_Number as "Category Number"
								Category_Name as "Category Name"
								Parent_Category as "Parent Category"
								Is_Active as "Is Active"
								Sort_Order as "Sort Order"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Product_Masters
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Product_Number as "Product Number"
								Product_Name as "Product Name"
								Supplier
								Category
								Product_Type as "Product Type"
								Unit_Type as "Unit Type"
								Base_Rate as "Base Rate"
								Cost_Price as "Cost Price"
								Sell_Price as "Sell Price"
								Margin_Amount as "Margin Amount"
								Margin_Percent as "Margin Percent"
								Description
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Product_Number as "Product Number"
								Product_Name as "Product Name"
								Supplier
								Category
								Product_Type as "Product Type"
								Unit_Type as "Unit Type"
								Description
								SKU
								Is_Stocked as "Is Stocked"
								Reorder_Level as "Reorder Level"
								Associated_Products as "Associated Products"
								Product_Image as "Product Image"
								Notes
								External_Barcode as "External Barcode"
								QR_Code as "QR Code"
								Is_Active as "Is Active"
								Base_Rate as "Base Rate"
								Reorder_Quantity as "Reorder Quantity"
								Max_Stock_Level as "Max Stock Level"
								Lead_Time_Days as "Lead Time Days"
								Total_Stock_On_Hand as "Total Stock On Hand"
								Total_Available as "Total Available"
								Cost_Price as "Cost Price"
								Sell_Price as "Sell Price"
								Margin_Amount as "Margin Amount"
								Margin_Percent as "Margin Percent"
								Bay_Location as "Bay Location"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Stock_Orders
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Order_Number as "Order Number"
								Sites_Reference as "Site / Project"
								Order_Date as "Order Date"
								Ordered_by_Employee as "Ordered By (Employee)"
								Ordered_by_Other as "Non Employee Name"
								Stock_Reserved as "Stock Reserved"
								Source_Location as "Source Location"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Order_Number_Auto as "Order Number Auto"
								Order_Number as "Order Number"
								Order_Date as "Order Date"
								Sites_Reference as "Site / Project"
								Ordered_by_Employee as "Ordered By (Employee)"
								Ordered_by_Other as "Non Employee Name"
								Ordered_by_Display as "Ordered by Display"
								Collection_Date as "Collection Date"
								Collection_Status as "Collection Status"
								Additional_Notes as "Additional Notes"
								Order_Status as "Order Status"
								Submitted_Date as "Submitted Date"
								Approved_By as "Approved By"
								Approved_Date as "Approved Date"
								Docket_Generated as "Docket Generated"
								Docket_PDF
								Excel_Synced as "Excel Synced"
								Source_Location as "Source Location"
								Stock_Reserved as "Stock Reserved"
								Stock_Issued as "Stock Issued"
								Needs_Approval as "Needs Approval"
								Approval_Notes as "Approval Notes"
								Collection_Bay as "Collection Bay"
								Collected_DateTime as "Collected DateTime"
								Collected_By as "Collected By"
								Picking_Stage as "Picking Stage"
								Collection_Stage as "Collection Stage"
								Edit_Mode as "Edit Mode"
								Order_Month as "Order Month"
								Order_Total_Stored as "Order Total Stored"
								Site_Name_Stored as "Site Name Stored"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Order_Line_Items_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Order
								Product
								Unit_Type as "Unit Type"
								Quantity as "Qty"
								Quantity_Issued as "Quantity Issued"
								Quantity_Available as "Quantity Available"
								Stock_Warning as "Stock Warning"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Product
								Product_Number as "Product Number"
								Unit_Type as "Unit Type"
								Line_Notes as "Line Notes"
								Is_Ancillary as "Is Ancillary"
								Line_Status as "Line Status"
								Quantity as "Qty"
								Order
								Quantity_Issued as "Quantity Issued"
								Quantity_Available as "Quantity Available"
								Stock_Warning as "Stock Warning"
								Is_Site_Product as "Is Site Product"
								Line_Total_Stored as "Line Total Stored"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Site_Product_Catalog_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Catalog_Number as "Catalog Number"
								Site
								Product
								Is_Standard as "Is Standard"
								Active
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Catalog_Number as "Catalog Number"
								Site
								Product
								Is_Standard as "Is Standard"
								Active
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Companies
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Company_Name as "Company Name"
								Company_Type as "Company Type"
								Address
								Google_Maps_Link as "Google Maps Link"
								Phone_Number as "Phone"
								Email
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Company_Name as "Company Name"
								Company_Type as "Company Type"
								Address
								Google_Maps_Link as "Google Maps Link"
								Phone_Number as "Phone"
								Email
								Website
								Active
								Notes
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Company_Contacts
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Companies
								First_Name as "First Name"
								Last_Name as "Last Name"
								Full_Name as "Full Name"
								Job_Title as "Job Title"
								Phone_Number as "Phone"
								Mobile_Number as "Mobile Number"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Companies
								First_Name as "First Name"
								Last_Name as "Last Name"
								Full_Name as "Full Name"
								Job_Title as "Job Title"
								Phone_Number as "Phone"
								Mobile_Number as "Mobile Number"
								Email
								Is_Primary_Contact as "Is Primary Contact"
								Active
								Notes
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Product_Kits
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Kit_Name as "Kit Name"
								Kit_Description as "Kit Description"
								Product_Categories as "Product Categories"
								Active
								Notes
								Kit_Total as "Kit Total"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Kit_Name as "Kit Name"
								Kit_Description as "Kit Description"
								Product_Categories as "Product Categories"
								Active
								Notes
								Kit_Total as "Kit Total"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Kit_Products
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Kit
								Product
								Default_Quantity as "Default Quantity"
								Sort_Order as "Sort Order"
								Notes
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Kit
								Product
								Default_Quantity as "Default Quantity"
								Sort_Order as "Sort Order"
								Notes
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Project_Proposals
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Proposal_Number as "Proposal Number"
								Project_Name as "Project Name"
								Proposal_Status as "Proposal Status"
								Address
								Google_Maps_Link as "Google Maps Link"
								Estimated_Start_Date as "Estimated Start Date"
								Agreed_Price as "Agreed Price"
								Companies
								Company_Contacts as "Company Contacts"
								"View Proposal"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Project_Name as "Project Name"
								Address
								Google_Maps_Link as "Google Maps Link"
								Estimated_Start_Date as "Estimated Start Date"
								Companies
								Company_Contacts as "Company Contacts"
								Proposal_Status as "Proposal Status"
								Auto_Number as "Auto Number"
								Estimated_Start as "Estimated Start"
								Procore_Project_ID as "Procore Project ID"
								Source_Kits as "Source Kits"
								Clear_All_Items as "Clear All Items"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Proposal_Contacts
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Role
								Contact_Name as "Contact Name"
								Phone_Number as "Phone"
								Email
								Proposal
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Role
								Contact_Name as "Contact Name"
								Phone_Number as "Phone"
								Email
								Proposal
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Proposal_Work_Packages
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Package_Name as "Package Name"
								Source_Kit as "Source Kit"
								Sort_Order as "Sort Order"
								Package_Total as "Package Total"
								Proposal
								Estimated_Total as "Estimated Total"
								Formula
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Source_Kit as "Source Kit"
								Package_Name as "Package Name"
								Sort_Order as "Sort Order"
								Package_Total as "Package Total"
								Proposal
								Estimated_Total as "Estimated Total"
								Formula
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Proposal_Line_Items
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Product
								Description
								Quantity
								Unit
								Rate
								Line_Total as "Line Total"
								Comment
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Product
								Description
								Quantity
								Unit
								Rate
								Comment
								Sort_Order as "Sort Order"
								Line_Total as "Line Total"
								Work_Package as "Work Package"
								Proposal
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Proposal_Pricing_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Product
								Description
								Quantity
								Unit
								Rate
								Package
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Product
								Description
								Quantity
								Unit
								Rate
								Line_Total as "Line Total"
								Comment
								Sort_Order as "Sort Order"
								Package
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Parameters
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Parameter_Name as "Parameter Name"
								Current_Proposal_ID as "Current Proposal ID"
								Debug_Log as "Debug Log"
								Workflow_Debug as "Workflow Debug"
								Proposal_Order_Comparison_Report as "Proposal Order Comparison Report"
								Dynamic_Order_Report as "Dynamic Order Report"
								Dynamic_Stock_Report as "Dynamic Stock Report"
								Products_By_Month_Chart as "Products By Month Chart"
								Products_By_Site_Chart as "Products By Site Chart"
								Products_By_Week_Chart as "Products By Week Chart"
								Product_Trends_Report as "Product Trends Report"
								Bay_Assignment_Mode as "Bay Assignment Mode "
								Bay_Assignment_Order_ID as "Bay Assignment Order ID "
								Current_Stock_Take_ID as "Current Stock Take ID"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Parameter_Name as "Parameter Name"
								Current_Proposal_ID as "Current Proposal ID"
								Debug_Log as "Debug Log"
								Workflow_Debug as "Workflow Debug"
								Bay_Assignment_Order_ID as "Bay Assignment Order ID "
								Bay_Assignment_Mode as "Bay Assignment Mode "
								Proposal_Order_Comparison_Report as "Proposal Order Comparison Report"
								Dynamic_Stock_Report as "Dynamic Stock Report"
								Dynamic_Order_Report as "Dynamic Order Report"
								Product_Trends_Report as "Product Trends Report"
								Products_By_Month_Chart as "Products By Month Chart"
								Products_By_Site_Chart as "Products By Site Chart"
								Products_By_Week_Chart as "Products By Week Chart"
								Current_Stock_Take_ID as "Current Stock Take ID"
								Current_Stock_Take_Line_ID as "Current Stock Take Line ID"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Stock_Locations
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Location_Code as "Location Code"
								Location_Name as "Location Name"
								Location_Type as "Location Type"
								Sites_Reference as "Sites Reference"
								Address
								Is_Default as " Is Default"
								Is_Active as "Is Active"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Location_Code as "Location Code"
								Location_Name as "Location Name"
								Location_Type as "Location Type"
								Sites_Reference as "Sites Reference"
								Address
								Is_Default as " Is Default"
								Is_Active as "Is Active"
								Notes
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Stock_Levels
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Product
								Location
								Quantity_On_Hand as "Quantity On Hand"
								Quantity_Reserved as "Quantity Reserved"
								Quantity_Available as "Quantity Available"
								Quantity_On_Order as "Quantity On Order"
								Last_Count_Date as "Last Count Date"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Product
								Location
								Quantity_On_Hand as "Quantity On Hand"
								Quantity_Reserved as "Quantity Reserved"
								Quantity_Available as "Quantity Available"
								Quantity_On_Order as "Quantity On Order"
								Last_Count_Date as "Last Count Date"
								Last_Movement_Date as "Last Movement Date"
								Is_Low_Stock as "Is Low Stock"
								Stock_Value as "Stock Value"
								Stock_Value_Stored as "Stock Value Stored"
								Bay_Location as "Bay Location"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Stock_Transactions
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Transaction_ID as "Transaction ID"
								Transaction_Number as "Transaction Number "
								Transaction_Date as "Transaction Date"
								Transaction_Type as "Transaction Type"
								Product
								Location
								Quantity
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Transaction_ID as "Transaction ID"
								Transaction_Number as "Transaction Number "
								Transaction_Date as "Transaction Date"
								Transaction_Type as "Transaction Type"
								Product
								Location
								Quantity
								Balance_After as "Balance After"
								Reference_Type as "Reference Type"
								Reference_ID as "Reference ID"
								Notes
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Purchase_Orders
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								PO_Number as "PO Number"
								Supplier
								Order_Date as "Order Date"
								Expected_Delivery as "Expected Delivery"
								Delivery_Location as "Delivery Location"
								PO_Status as "PO Status"
								Total_Value as "Total Value"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								PO_ID as "PO ID"
								PO_Number as "PO Number"
								Supplier
								Order_Date as "Order Date"
								Expected_Delivery as "Expected Delivery"
								Delivery_Location as "Delivery Location"
								PO_Status as "PO Status"
								Total_Value as "Total Value"
								Raised_By as "Raised By"
								Notes
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report PO_Line_Items_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Purchase_Order as "Purchase Order"
								Product
								Quantity_Ordered as "Quantity Ordered"
								Quantity_Received as "Quantity Received"
								Quantity_Outstanding as "Quantity Outstanding"
								Unit_Price as "Unit Price"
								Line_Total as "Line Total"
								Line_Status as "Line Status"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Purchase_Order as "Purchase Order"
								Product
								Quantity_Ordered as "Quantity Ordered"
								Quantity_Received as "Quantity Received"
								Quantity_Outstanding as "Quantity Outstanding"
								Unit_Price as "Unit Price"
								Line_Total as "Line Total"
								Line_Status as "Line Status"
								Line_Description as "Line Description"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Goods_Receipt_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Purchase_Order as "Purchase Order"
								Suppliers as "Product Supplier"
								Receipt_Date as "Receipt Date"
								Receiving_Location as "Receiving Location"
								Delivery_Note_Ref as "Delivery Note Ref"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Purchase_Order as "Purchase Order"
								Suppliers as "Product Supplier"
								Receipt_Date as "Receipt Date"
								Receiving_Location as "Receiving Location"
								Delivery_Note_Ref as "Delivery Note Ref"
								GRN_Status as "GRN Status"
								Received_By as "Received By"
								Notes
								Stock_Updated as "Stock Updated"
								GRN_Number as "GRN Number"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report GRN_Line_Items_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Goods_Receipt as "Goods Receipt"
								PO_Line
								Product
								Quantity_Expected as "Quantity Expected"
								Quantity_Received as "Quantity Received"
								Quantity_Rejected as "Quantity Rejected"
								Rejection_Reason as "Rejection Reason"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Goods_Receipt as "Goods Receipt"
								PO_Line
								Product
								Quantity_Expected as "Quantity Expected"
								Quantity_Received as "Quantity Received"
								Quantity_Rejected as "Quantity Rejected"
								Rejection_Reason as "Rejection Reason"
								Batch_Number as "Batch Number"
								Expiry_Date as "Expiry Date"
								Bay_Locations as "Bay Locations"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Orders_Pending_Approval
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Order_Number_Auto as "Order Number Auto"
								Order_Number as "Order Number"
								Ordered_by_Employee as "Ordered By (Employee)"
								Sites_Reference as "Site / Project"
								Source_Location as "Source Location"
								Needs_Approval as "Needs Approval"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Order_Number_Auto as "Order Number Auto"
								Order_Number as "Order Number"
								Sites_Reference as "Site / Project"
								Ordered_by_Employee as "Ordered By (Employee)"
								Ordered_by_Other as "Or Enter Name"
								Additional_Notes as "Additional Notes"
								Source_Location as "Source Location"
								Collection_Date as "Collection Date"
								Collection_Status as "Collection Status"
								Order_Date as "Order Date"
								Ordered_by_Display as "Ordered by Display"
								Order_Status as "Order Status"
								Stock_Reserved as "Stock Reserved"
								Stock_Issued as "Stock Issued"
								Submitted_Date as "Submitted Date"
								Needs_Approval as "Needs Approval"
								Approved_By as "Approved By"
								Approved_Date as "Approved Date"
								Approval_Notes as "Approval Notes"
								Docket_Generated as "Docket Generated"
								Docket_PDF
								Excel_Synced as "Excel Synced"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Stock_Levels_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Product
								Location
								Quantity_On_Hand as "Quantity On Hand"
								Quantity_Reserved as "Quantity Reserved"
								Quantity_Available as "Quantity Available"
								Quantity_On_Order as "Quantity On Order"
								Last_Movement_Date as "Last Movement Date"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Product
								Location
								Quantity_On_Hand as "Quantity On Hand"
								Quantity_Reserved as "Quantity Reserved"
								Quantity_Available as "Quantity Available"
								Quantity_On_Order as "Quantity On Order"
								Last_Count_Date as "Last Count Date"
								Last_Movement_Date as "Last Movement Date"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Low_Stock_Alert
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Product
								Location
								Quantity_Available as "Quantity Available"
								Product.Reorder_Level as "Reorder Level"
								Quantity_On_Order as "Quantity On Order"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Product
								Location
								Quantity_On_Hand as "Quantity On Hand"
								Quantity_Reserved as "Quantity Reserved"
								Quantity_Available as "Quantity Available"
								Quantity_On_Order as "Quantity On Order"
								Last_Count_Date as "Last Count Date"
								Last_Movement_Date as "Last Movement Date"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Stock_Transactions_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Transaction_Number as "Transaction Number "
								Transaction_Date as "Transaction Date"
								Transaction_Type as "Transaction Type"
								Product
								Location
								Quantity
								Balance_After as "Balance After"
								Reference_Type as "Reference Type"
								Reference_ID as "Reference ID"
								Notes
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Transaction_ID as "Transaction ID"
								Transaction_Number as "Transaction Number "
								Transaction_Date as "Transaction Date"
								Transaction_Type as "Transaction Type"
								Product
								Location
								Quantity
								Balance_After as "Balance After"
								Reference_Type as "Reference Type"
								Reference_ID as "Reference ID"
								Notes
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report PO_Outstanding_Items
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Purchase_Order as "Purchase Order"
								Product
								Quantity_Ordered as "Quantity Ordered"
								Quantity_Received as "Quantity Received"
								Quantity_Outstanding as "Quantity Outstanding"
								Line_Status as "Line Status"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Purchase_Order as "Purchase Order"
								Product
								Quantity_Ordered as "Quantity Ordered"
								Quantity_Received as "Quantity Received"
								Quantity_Outstanding as "Quantity Outstanding"
								Unit_Price as "Unit Price"
								Line_Total as "Line Total"
								Line_Status as "Line Status"
								Line_Description as "Line Description"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Purchase_Orders1
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								PO_Number as "PO Number"
								Supplier
								Order_Date as "Order Date"
								Expected_Delivery as "Expected Delivery"
								Delivery_Location as "Delivery Location"
								PO_Status as "PO Status"
								Total_Value as "Total Value"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								PO_ID as "PO ID"
								PO_Number as "PO Number"
								Supplier
								Order_Date as "Order Date"
								Expected_Delivery as "Expected Delivery"
								Delivery_Location as "Delivery Location"
								PO_Status as "PO Status"
								Total_Value as "Total Value"
								Raised_By as "Raised By"
								Notes
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Goods_Receipts
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								GRN_Number as "GRN Number"
								Purchase_Order as "Purchase Order"
								Suppliers as "Product Supplier"
								Receipt_Date as "Receipt Date"
								Receiving_Location as "Receiving Location"
								GRN_Status as "GRN Status"
								Received_By as "Received By"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								GRN_Number as "GRN Number"
								Purchase_Order as "Purchase Order"
								Suppliers as "Product Supplier"
								Receipt_Date as "Receipt Date"
								Receiving_Location as "Receiving Location"
								Delivery_Note_Ref as "Delivery Note Ref"
								GRN_Status as "GRN Status"
								Received_By as "Received By"
								Notes
								Stock_Updated as "Stock Updated"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Stock_Valuation
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Product
								Location
								Quantity_On_Hand as "Quantity On Hand"
								Stock_Value as "Stock Value"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Product
								Location
								Quantity_On_Hand as "Quantity On Hand"
								Quantity_Reserved as "Quantity Reserved"
								Quantity_Available as "Quantity Available"
								Quantity_On_Order as "Quantity On Order"
								Last_Count_Date as "Last Count Date"
								Last_Movement_Date as "Last Movement Date"
								Is_Low_Stock as "Is Low Stock"
								Stock_Value as "Stock Value"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Orders_Pending_Approval1
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Order_Number as "Order Number"
								Sites_Reference as "Site / Project"
								Source_Location as "Source Location"
								Needs_Approval as "Needs Approval"
								Order_Status as "Order Status"
								Submitted_Date as "Submitted Date"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Order_Number_Auto as "Order Number Auto"
								Order_Number as "Order Number"
								Sites_Reference as "Site / Project"
								Ordered_by_Employee as "Ordered By (Employee)"
								Ordered_by_Other as "Or Enter Name"
								Additional_Notes as "Additional Notes"
								Source_Location as "Source Location"
								Collection_Date as "Collection Date"
								Collection_Status as "Collection Status"
								Order_Date as "Order Date"
								Order_Status as "Order Status"
								Ordered_by_Display as "Ordered by Display"
								Stock_Reserved as "Stock Reserved"
								Stock_Issued as "Stock Issued"
								Submitted_Date as "Submitted Date"
								Needs_Approval as "Needs Approval"
								Approved_By as "Approved By"
								Approved_Date as "Approved Date"
								Approval_Notes as "Approval Notes"
								Docket_Generated as "Docket Generated"
								Docket_PDF
								Excel_Synced as "Excel Synced"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Kanban
			{
				quickview
				(
					layout
					(
		 				type = 2
						datablock1
						(
							layout type = 4
							fields
							(
								Order_Number_Auto as "Order Number Auto"
								Order_Number as "Order Number"
								Ordered_by_Employee.Phone_Number as "Phone_Number"
								Ordered_by_Employee.System_Email_Address as "System Email Address"
								Ordered_by_Employee.G_Mail as "G-Mail"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Order_Number_Auto as "Order Number Auto"
								Order_Number as "Order Number"
								Sites_Reference as "Site / Project"
								Ordered_by_Employee as "Ordered By (Employee)"
								Ordered_by_Other as "Or Enter Name"
								Additional_Notes as "Additional Notes"
								Source_Location as "Source Location"
								Collection_Date as "Collection Date"
								Collection_Status as "Collection Status"
								Order_Date as "Order Date"
								Order_Status as "Order Status"
								Ordered_by_Display as "Ordered by Display"
								Stock_Reserved as "Stock Reserved"
								Stock_Issued as "Stock Issued"
								Submitted_Date as "Submitted Date"
								Needs_Approval as "Needs Approval"
								Approved_By as "Approved By"
								Approved_Date as "Approved Date"
								Approval_Notes as "Approval Notes"
								Docket_Generated as "Docket Generated"
								Docket_PDF
								Excel_Synced as "Excel Synced"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report All_Bay_Locations
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Bay_Name as "Bay Name"
								Stock_Locations as "Stock Locations"
								Capacity
								Active
								Notes
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Bay_Name as "Bay Name"
								Stock_Locations as "Stock Locations"
								Capacity
								Active
								Notes
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Warehouse_Picking_Board
			{
				quickview
				(
					layout
					(
		 				type = 2
						datablock1
						(
							layout type = 4
							fields
							(
								Order_Number_Auto as "Order Number Auto"
								Order_Number as "Order Number"
								Sites_Reference.Site_Name as "Site_Name"
								Source_Location as "Source Location"
								Ordered_by_Employee.Added_Time as "Added Time"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    	 				)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Order_Number_Auto as "Order Number Auto"
								Order_Number as "Order Number"
								Sites_Reference as "Site / Project"
								Ordered_by_Employee as "Ordered By (Employee)"
								Ordered_by_Other as "Or Enter Name"
								Additional_Notes as "Additional Notes"
								Source_Location as "Source Location"
								Collection_Date as "Collection Date"
								Collection_Status as "Collection Status"
								Order_Date as "Order Date"
								Order_Status as "Order Status"
								Picking_Stage as "Picking Stage"
								Collection_Stage as "Collection Stage"
								Ordered_by_Display as "Ordered by Display"
								Stock_Reserved as "Stock Reserved"
								Stock_Issued as "Stock Issued"
								Submitted_Date as "Submitted Date"
								Needs_Approval as "Needs Approval"
								Approved_By as "Approved By"
								Approved_Date as "Approved Date"
								Approval_Notes as "Approval Notes"
								Collection_Bay as "Collection Bay"
								Collected_DateTime as "Collected DateTime"
								Collected_By as "Collected By"
								Docket_Generated as "Docket Generated"
								Docket_PDF
								Excel_Synced as "Excel Synced"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Order_Collection_Board
			{
				quickview
				(
					layout
					(
		 				type = 2
						datablock1
						(
							layout type = 4
							fields
							(
								Order_Number_Auto as "Order Number Auto"
								Order_Number as "Order Number"
								Sites_Reference.Site_Name as "Site_Name"
								Source_Location as "Source Location"
								Collection_Bay.Bay_Name as "Bay Name"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Order_Number_Auto as "Order Number Auto"
								Order_Number as "Order Number"
								Sites_Reference as "Site / Project"
								Ordered_by_Employee as "Ordered By (Employee)"
								Ordered_by_Other as "Or Enter Name"
								Additional_Notes as "Additional Notes"
								Source_Location as "Source Location"
								Collection_Date as "Collection Date"
								Collection_Status as "Collection Status"
								Order_Date as "Order Date"
								Order_Status as "Order Status"
								Picking_Stage as "Picking Stage"
								Collection_Stage as "Collection Stage"
								Ordered_by_Display as "Ordered by Display"
								Stock_Reserved as "Stock Reserved"
								Stock_Issued as "Stock Issued"
								Submitted_Date as "Submitted Date"
								Needs_Approval as "Needs Approval"
								Approved_By as "Approved By"
								Approved_Date as "Approved Date"
								Approval_Notes as "Approval Notes"
								Collection_Bay as "Collection Bay"
								Collected_DateTime as "Collected DateTime"
								Collected_By as "Collected By"
								Docket_Generated as "Docket Generated"
								Docket_PDF
								Excel_Synced as "Excel Synced"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Assign_Bay_Form_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Order_ID as "Order ID"
								Bay_Locations as "Bay Locations"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Order_ID as "Order ID"
								Bay_Locations as "Bay Locations"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Assign_Bay_Form1_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Stock_Adjustments_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Adjustment_Number as "Adjustment Number"
								Adjustment_Date as "Adjustment Date"
								Stock_Locations as "Stock Locations"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Adjustment_Number as "Adjustment Number"
								Adjustment_Date as "Adjustment Date"
								Stock_Locations as "Stock Locations"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Procore_Settings_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Environment
								Client_ID as "Client ID"
								Client_Secret as "Client Secret"
								Company_ID as "Company ID"
								API_Base_URL as "API Base URL"
								Auth_URL as "Auth URL"
								Is_Active as "Is Active"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Environment
								Client_ID as "Client ID"
								Client_Secret as "Client Secret"
								Company_ID as "Company ID"
								API_Base_URL as "API Base URL"
								Auth_URL as "Auth URL"
								Is_Active as "Is Active"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Stock_Takes_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Stock_Take_Number as "Stock Take Number"
								Stock_Take_Date as "Stock Take Date"
								Location
								Status
								Created_By as "Created By"
								Approved_By as "Approved By"
								Approved_Date as "Approved Date"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Stock_Take_Number as "Stock Take Number"
								Stock_Take_Date as "Stock Take Date"
								Location
								Status
								Created_By as "Created By"
								Approved_By as "Approved By"
								Approved_Date as "Approved Date"
								Notes
								Previous_Status as "Previous Status"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
			 				"Print Count Sheet"
    	 				)
    				)
				)
			}
			report Stock_Take_Lines_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Stock_Take
								Product
								Expected_Quantity as "Expected Quantity"
								Counted_Quantity as "Counted Quantity"
								Variance
								Variance_Reason as "Variance Reason"
								Notes
								ID
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Product
								Expected_Quantity as "Expected Quantity"
								Counted_Quantity as "Counted Quantity"
								Variance
								Variance_Reason as "Variance Reason"
								Notes
								Stock_Take
								Bay_Location as "Bay Location"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Stock_Takes_List
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Stock_Take_Number as "Stock Take Number"
								Stock_Take_Date as "Stock Take Date"
								Location
								Status
								Created_By as "Created By"
								Approved_By as "Approved By"
								Approved_Date as "Approved Date"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Stock_Take_Number as "Stock Take Number"
								Stock_Take_Date as "Stock Take Date"
								Location
								Status
								Created_By as "Created By"
								Approved_By as "Approved By"
								Approved_Date as "Approved Date"
								Notes
								Previous_Status as "Previous Status"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Update_Stock_Count_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Line_ID as "Line ID"
								Counted
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Line_ID as "Line ID"
								Counted
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Quick_Count_Redirect_Report
			{
				quickview
				(
					layout
					(
		 				type = -1
						datablock1
						(
							layout type = -1
							fields
							(
								Line_ID as "Line ID"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Line_ID as "Line ID"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
			report Proposal_Status
			{
				quickview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = 1
							fields
							(
								Auto_Number as "Auto Number"
								Proposal_Number as "Proposal Number"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
						record
						(
							Edit   	   
							Duplicate   	   
							Delete   	   
    					)
    				)
    				action
    				(
						on click
						(
							View Record   	   
    					)
						on right click
						(
							Edit   	   
							Delete   	   
							Duplicate   	   
							View Record   	   
    					)
     				)
				)

				detailview
				(
					layout
					(
		 				type = 1
						datablock1
						(
							layout type = -2
							fields
							(
								Auto_Number as "Auto Number"
								Proposal_Number as "Proposal Number"
								Procore_Project_ID as "Procore Project ID"
								Project_Name as "Project Name"
								Address
								Google_Maps_Link as "Google Maps Link"
								Estimated_Start as "Estimated Start"
								Estimated_Start_Date as "Estimated Start Date"
								Companies
								Company_Contacts as "Company Contacts"
								Proposal_Currency as "Proposal Currency"
								Agreed_Price as "Agreed Price"
								Proposal_Status as "Proposal Status"
								Category
								Sub_Category as "Sub Category"
								Drawing_Attachment as "Drawing Attachment"
								Submitted_Date as "Submitted Date"
								Approved_By as "Approved By"
								Approved_Date as "Approved Date"
								Notes
								Proposal_Date as "Proposal Date"
								Source_Kits as "Source Kits"
								Clear_All_Items as "Clear All Items"
							)
						)
					)
					menu
    				(
    	 				header
    	 				(
    		 				Edit 
    		 				Duplicate 
    		 				Delete 
    	 				)
    				)
				)
			}
		}
		menu
		{
			unused
			{
				report Proposal_Pricing_Report
				{
					icon = "tech-desktop"
				}
				form  Proposal_Pricing
				{
					icon = "sport-tactic"
				}
				report Kanban
				{
					icon = "shopping-stock"
				}
				form  Assign_Bay_Form
				{
					icon = "tech-desktop"
				}
				report Assign_Bay_Form_Report
				{
					icon = "tech-desktop"
				}
				form  Assign_Bay_Form1
				{
					icon = "tech-desktop"
				}
				report Assign_Bay_Form1_Report
				{
					icon = "tech-desktop"
				}
				page Assign_Bay_Page
				{
					icon = "tech-desktop"
				}
				form  Stock_Adjustments
				{
					icon = "tech-desktop"
				}
				report Stock_Adjustments_Report
				{
					icon = "tech-desktop"
				}
				page TEST
				{
					icon = "education-flask"
				}
				report Stock_Takes_List
				{
					icon = "tech-desktop"
				}
				page Print_Count_Sheet
				{
					icon = "tech-desktop"
				}
				report Quick_Count_Redirect_Report
				{
					icon = "tech-desktop"
				}
				report Update_Stock_Count_Report
				{
					icon = "tech-desktop"
				}
			}
			space Dashboard
			{
				displayname = "Dashboard"
				icon = "objects-spaceship"

					page Main_Dashboard
					{
						icon = "ui-1-dashboard-half"
					}
					page Proposals_Dashboard
					{
						icon = "ui-1-dashboard-half"
					}
			}
			space Ops
			{
				displayname = "Ops"
				icon = "objects-spaceship"

				section Ordering_Dashboard1
				{
					displayname = "Ordering Dashboard"
					icon = "tech-desktop"
					page Ordering_Dashboard
					{
						icon = "tech-desktop"
					}
				}
				section Stock_Dashboard
				{
					displayname = "Stock Dashboard"
					icon = "users-2-child"
					page Inventory_Dashboard
					{
						icon = "tech-desktop"
					}
				}
				section Stock_Taking
				{
					displayname = "Stock Taking"
					icon = "users-2-child"
					form  Stock_Takes
					{
						icon = "tech-desktop"
					}
					report Stock_Takes_Report
					{
						icon = "tech-desktop"
					}
					designcomponent designcomponent15
					{
						type = separator
						separator = "line"
					}
					form  Stock_Take_Lines
					{
						icon = "tech-desktop"
					}
					report Stock_Take_Lines_Report
					{
						icon = "tech-desktop"
					}
				}
			}
			space Warehouse
			{
				displayname = "Warehouse"
				icon = "objects-spaceship"

				section Warehouse
				{
					displayname = "Warehouse"
					icon = "users-2-child"
					report Warehouse_Picking_Board
					{
						icon = "shopping-stock"
					}
					report Order_Collection_Board
					{
						icon = "shopping-stock"
					}
				}
			}
			space Admin
			{
				displayname = "Admin"
				icon = "objects-spaceship"

				section Product_Catalogue
				{
					displayname = "Product Catalogue"
					icon = "users-2-child"
					form  Product_Master
					{
						icon = "sport-crown"
					}
					report All_Product_Masters
					{
						icon = "tech-desktop"
					}
					designcomponent designcomponent3
					{
						type = separator
						separator = "line"
					}
					form  Product_Categories
					{
						icon = "tech-2-pci-card"
					}
					report All_Product_Categories
					{
						icon = "tech-desktop"
					}
					designcomponent designcomponent4
					{
						type = separator
						separator = "line"
					}
					form  Suppliers
					{
						icon = "tech-2-pci-card"
					}
					report All_Suppliers
					{
						icon = "tech-desktop"
					}
				}
				section Kits
				{
					displayname = "Kits"
					icon = "shopping-gift"
					form  Product_Kits
					{
						icon = "shopping-gift"
					}
					report All_Product_Kits
					{
						icon = "tech-desktop"
					}
					designcomponent designcomponent5
					{
						type = separator
						separator = "line"
					}
					form  Kit_Products
					{
						icon = "shopping-gift"
					}
					report All_Kit_Products
					{
						icon = "tech-desktop"
					}
				}
				section Site_Setup
				{
					displayname = "Site Setup"
					icon = "tech-desktop"
					form  Site_Product_Catalog
					{
						icon = "tech-desktop"
					}
					report Site_Product_Catalog_Report
					{
						icon = "tech-desktop"
					}
				}
				section Customer1
				{
					displayname = "Customer"
					icon = "tech-desktop"
					form  Companies
					{
						icon = "business-factory"
					}
					report All_Companies
					{
						icon = "tech-desktop"
					}
					designcomponent designcomponent6
					{
						type = separator
						separator = "line"
					}
					form  Company_Contacts
					{
						icon = "business-tie-02"
					}
					report All_Company_Contacts
					{
						icon = "tech-desktop"
					}
				}
				section Inventory_Setup
				{
					displayname = "Inventory Setup"
					icon = "users-2-child"
					form  Stock_Locations
					{
						icon = "shopping-stock"
					}
					report All_Stock_Locations
					{
						icon = "tech-desktop"
					}
					designcomponent designcomponent8
					{
						type = separator
						separator = "line"
					}
					form  Stock_Levels
					{
						icon = "shopping-stock"
					}
					report All_Stock_Levels
					{
						icon = "tech-desktop"
					}
					designcomponent designcomponent9
					{
						type = separator
						separator = "line"
					}
					form  Stock_Transactions
					{
						icon = "business-stock"
					}
					report All_Stock_Transactions
					{
						icon = "tech-desktop"
					}
				}
				section Procurement
				{
					displayname = "Procurement"
					icon = "users-2-child"
					form  Purchase_Orders
					{
						icon = "shopping-list"
					}
					report All_Purchase_Orders
					{
						icon = "tech-desktop"
					}
					designcomponent designcomponent10
					{
						type = separator
						separator = "line"
					}
					form  PO_Line_Items
					{
						icon = "tech-desktop"
					}
					report PO_Line_Items_Report
					{
						icon = "tech-desktop"
					}
				}
				section Goods_Receiving
				{
					displayname = "Goods Receiving"
					icon = "users-2-child"
					form  Goods_Receipt
					{
						icon = "shopping-receipt"
					}
					report Goods_Receipt_Report
					{
						icon = "tech-desktop"
					}
					designcomponent designcomponent11
					{
						type = separator
						separator = "line"
					}
					form  GRN_Line_Items
					{
						icon = "tech-desktop"
					}
					report GRN_Line_Items_Report
					{
						icon = "tech-desktop"
					}
				}
				section Operations_Data1
				{
					displayname = "Operations Data"
					icon = "tech-desktop"
					report All_Stock_Orders
					{
						icon = "tech-desktop"
					}
					report Order_Line_Items_Report
					{
						icon = "tech-desktop"
					}
					designcomponent designcomponent2
					{
						type = separator
						separator = "line"
					}
					report All_Project_Proposals
					{
						icon = "tech-desktop"
					}
					report All_Proposal_Work_Packages
					{
						icon = "tech-desktop"
					}
					report All_Proposal_Line_Items
					{
						icon = "tech-desktop"
					}
					report All_Proposal_Contacts
					{
						icon = "tech-desktop"
					}
					designcomponent designcomponent14
					{
						type = separator
						separator = "line"
					}
					report All_Bay_Locations
					{
						icon = "tech-desktop"
					}
				}
				section Data_Entry
				{
					displayname = "Data Entry"
					icon = "shopping-stock"
					form  Stock_Ordering
					{
						icon = "shopping-stock"
					}
					form  Order_Line_Items
					{
						icon = "tech-desktop"
					}
					designcomponent designcomponent1
					{
						type = separator
						separator = "line"
					}
					form  Project_Proposals
					{
						icon = "sport-tactic"
					}
					form  Proposal_Work_Packages
					{
						icon = "shopping-delivery-track"
					}
					form  Proposal_Line_Items
					{
						icon = "shopping-cart-simple"
					}
					form  Proposal_Contacts
					{
						icon = "users-2-b-check"
					}
					designcomponent designcomponent12
					{
						type = separator
						separator = "line"
					}
					report Orders_Pending_Approval
					{
						icon = "shopping-stock"
					}
					designcomponent designcomponent13
					{
						type = separator
						separator = "line"
					}
					form  Bay_Locations
					{
						icon = "location-pin-copy"
					}
					report Proposal_Status
					{
						icon = "sport-tactic"
					}
				}
				section Approvals
				{
					displayname = "Approvals"
					icon = "ui-2-hourglass"
					systemcomponent
					{
						type = approval
						approval status = pending
						displayname = "Pending Tasks"
						icon = "ui-2-hourglass"
					}
					systemcomponent
					{
						type = approval
						approval status = completed
						displayname = "Completed Tasks"
						icon = "design-todo"
					}
				}
				section Reporting
				{
					displayname = "Reporting"
					icon = "users-2-child"
					report Orders_Pending_Approval1
					{
						icon = "shopping-stock"
					}
					report Low_Stock_Alert
					{
						icon = "shopping-stock"
					}
					report Stock_Levels_Report
					{
						icon = "shopping-stock"
					}
					report Stock_Transactions_Report
					{
						icon = "business-stock"
					}
					report PO_Outstanding_Items
					{
						icon = "tech-desktop"
					}
					report All_Purchase_Orders1
					{
						icon = "shopping-list"
					}
					report All_Goods_Receipts
					{
						icon = "shopping-receipt"
					}
					report Stock_Valuation
					{
						icon = "shopping-stock"
					}
				}
				section Parameters_Internal_Use_Only
				{
					displayname = "Parameters - Internal Use Only"
					icon = "travel-swiss-knife"
					form  Parameters
					{
						icon = "travel-swiss-knife"
					}
					report All_Parameters
					{
						icon = "tech-desktop"
					}
				}
				section Procore_Settings1
				{
					displayname = "Procore Settings"
					icon = "users-2-child"
					form  Procore_Settings
					{
						icon = "tech-desktop"
					}
					report Procore_Settings_Report
					{
						icon = "tech-desktop"
					}
				}
				section App_Preferences
				{
					displayname = "App Preferences"
					icon = "design-app"
					systemcomponent
					{
						type = localization
						displayname = "Language Selection"
						icon = "education-language"
					}
					systemcomponent
					{
						type = connection
						displayname = "Integrations"
						icon = "tech-2-connection"
					}
				}
				section Internals
				{
					displayname = "Internals"
					icon = "users-2-child"
					page Stock_Report_Page
					{
						icon = "business-laptop-71"
					}
					page Orders_Report_Page
					{
						icon = "tech-desktop"
					}
					page Proposal_VS_Order
					{
						icon = "shopping-box"
					}
					page View_Proposal
					{
						icon = "tech-desktop"
					}
					page Print_Count
					{
						icon = "tech-desktop"
					}
					page Quick_Count
					{
						icon = "tech-desktop"
					}
					designcomponent designcomponent16
					{
						type = separator
						separator = "line"
					}
					form  Update_Stock_Count
					{
						icon = "tech-desktop"
					}
					designcomponent designcomponent17
					{
						type = separator
						separator = "line"
					}
					form  Quick_Count_Redirect
					{
						icon = "tech-desktop"
					}
				}
				section SharedAnalytics_Section
				{
					type = shared_user_report_section
					displayname = "Reports"
					icon = "business-chart-bar-33"
				}
			}
			preference
			{
				icon
				{
					style = outline
				}
			}
		}
		customize
		{
			new theme = 6
			font = "lato"
			color options
			{
				color = "6"
			}
			logo
			{
				preference = "none"
				placement = "left"
			}
		}
	}
	phone
	{
		forms
		{
			form Assign_Bay_Form
			{
				label placement = auto
			}
			form Assign_Bay_Form1
			{
				label placement = auto
			}
			form Bay_Locations
			{
				label placement = auto
			}
			form Companies
			{
				label placement = auto
			}
			form Company_Contacts
			{
				label placement = auto
			}
			form Goods_Receipt
			{
				label placement = auto
			}
			form GRN_Line_Items
			{
				label placement = auto
			}
			form Kit_Products
			{
				label placement = auto
			}
			form Order_Line_Items
			{
				label placement = auto
			}
			form Parameters
			{
				label placement = auto
			}
			form PO_Line_Items
			{
				label placement = auto
			}
			form Procore_Settings
			{
				label placement = auto
			}
			form Product_Categories
			{
				label placement = auto
			}
			form Product_Kits
			{
				label placement = auto
			}
			form Product_Master
			{
				label placement = auto
			}
			form Suppliers
			{
				label placement = auto
			}
			form Project_Proposals
			{
				label placement = auto
			}
			form Proposal_Contacts
			{
				label placement = auto
			}
			form Proposal_Line_Items
			{
				label placement = auto
			}
			form Proposal_Pricing
			{
				label placement = auto
			}
			form Proposal_Work_Packages
			{
				label placement = auto
			}
			form Purchase_Orders
			{
				label placement = auto
			}
			form Quick_Count_Redirect
			{
				label placement = auto
			}
			form Site_Product_Catalog
			{
				label placement = auto
			}
			form Stock_Levels
			{
				label placement = auto
			}
			form Stock_Locations
			{
				label placement = auto
			}
			form Stock_Ordering
			{
				label placement = auto
			}
			form Stock_Takes
			{
				label placement = auto
			}
			form Stock_Take_Lines
			{
				label placement = auto
			}
			form Stock_Transactions
			{
				label placement = auto
			}
			form Stock_Adjustments
			{
				label placement = auto
			}
			form Update_Stock_Count
			{
				label placement = auto
			}
		}
		customize
		{
			layout = slidingpane
			font = "default"
			style = "3"
			color options
			{
				color = lightred
			}
			logo
			{
				preference = "none"
			}
		}
	}
	tablet
	{
		forms
		{
			form Assign_Bay_Form
			{
				label placement = auto
			}
			form Assign_Bay_Form1
			{
				label placement = auto
			}
			form Bay_Locations
			{
				label placement = auto
			}
			form Companies
			{
				label placement = auto
			}
			form Company_Contacts
			{
				label placement = auto
			}
			form Goods_Receipt
			{
				label placement = auto
			}
			form GRN_Line_Items
			{
				label placement = auto
			}
			form Kit_Products
			{
				label placement = auto
			}
			form Order_Line_Items
			{
				label placement = auto
			}
			form Parameters
			{
				label placement = auto
			}
			form PO_Line_Items
			{
				label placement = auto
			}
			form Procore_Settings
			{
				label placement = auto
			}
			form Product_Categories
			{
				label placement = auto
			}
			form Product_Kits
			{
				label placement = auto
			}
			form Product_Master
			{
				label placement = auto
			}
			form Suppliers
			{
				label placement = auto
			}
			form Project_Proposals
			{
				label placement = auto
			}
			form Proposal_Contacts
			{
				label placement = auto
			}
			form Proposal_Line_Items
			{
				label placement = auto
			}
			form Proposal_Pricing
			{
				label placement = auto
			}
			form Proposal_Work_Packages
			{
				label placement = auto
			}
			form Purchase_Orders
			{
				label placement = auto
			}
			form Quick_Count_Redirect
			{
				label placement = auto
			}
			form Site_Product_Catalog
			{
				label placement = auto
			}
			form Stock_Levels
			{
				label placement = auto
			}
			form Stock_Locations
			{
				label placement = auto
			}
			form Stock_Ordering
			{
				label placement = auto
			}
			form Stock_Takes
			{
				label placement = auto
			}
			form Stock_Take_Lines
			{
				label placement = auto
			}
			form Stock_Transactions
			{
				label placement = auto
			}
			form Stock_Adjustments
			{
				label placement = auto
			}
			form Update_Stock_Count
			{
				label placement = auto
			}
		}
		customize
		{
			layout = slidingpane
			font = "default"
			style = "3"
			color options
			{
				color = lightred
			}
			logo
			{
				preference = "none"
			}
		}
	}
	translation
{
{"Language_Settings":{"LANGAGUE_WITH_LOGIN":"browser"}}
}
}
